{"content":"<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：</p>\n<p>接下来，可以 <a href=\"https://redis.io/docs/latest/get-started/\" target=\"_blank\" rel=\"noopener noreferrer\">根据 Redis 官方的快速学习手册进行学习</a>：</p>\n<ul>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/data-store/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为内存中数据类型存储快速入门</a>，并且还需要 <a href=\"https://redis.io/docs/latest/develop/data-types/\" target=\"_blank\" rel=\"noopener noreferrer\">阅读 Redis 中的数据类型</a>，每一个数据类型都可以有对应的文档</li>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/document-database/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为文档数据库快速入门</a>（但是必须额外下载 <code v-pre>Redis Stack</code>）</li>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/vector-database/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为矢量数据库快速入门</a>（但是必须额外下载 <code v-pre>Redis Stack</code>，并且您必须学习过机器学习）</li>\n</ul>\n<p>这几个文档还是非常简单易读的，非常推荐（和本系列一起阅读更佳）。</p>\n<p>如果觉得文档太难看懂，可以看看 <a href=\"https://www.bilibili.com/video/BV1UnY5ehE4b?vd_source=c92c89dbfcf9cc30c48086469621f35b&amp;spm_id_from=333.788.videopod.episodes\" target=\"_blank\" rel=\"noopener noreferrer\">别人搬运的尚硅谷 Redis 教程(非正版...)</a>。</p>\n</div>\n<h2 id=\"_1-组件简介\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-组件简介\"><span>1.组件简介</span></a></h2>\n<p><code v-pre>Redis</code> 是一种开源的内存数据库，用于存储数据结构，例如字符串、哈希表、列表、集合、有序集合等。它被设计为快速、灵活，并支持多种数据结构的操作。<code v-pre>Redis</code> 通常用作缓存、消息代理、会话存储等用途。它支持多种编程语言，并有许多客户端库可供开发者使用。Redis 也有持久化选项，可以将数据保存到磁盘上，以便在重启时恢复数据。</p>\n<p><code v-pre>Redis</code> 所有数据都是存放在内存中的，把数据放在内存中是 <code v-pre>Redis</code> 速度快的最主要原因。另外 <code v-pre>Redis</code> 是 ⽤ <code v-pre>C</code> 语 ⾔ 实现的，⼀ 般来说 <code v-pre>C</code> 语 ⾔ 实现的最终程序会更快。另外 <code v-pre>Redis</code> 一开始采用的是单线程，预防了多线程可能产 ⽣ 的竞争问题。不够后面的 <code v-pre>Redis</code> 在 <code v-pre>6.0</code> 版本引 ⼊ 了多线程机制，但主要也是在处理 ⽹ 络和 <code v-pre>IO</code>，不涉及到数据命令，即命令的执行仍然采 ⽤ 了单线程模式。</p>\n<p>从网络角度上，<code v-pre>Redis</code> 还使用了 <code v-pre>IO</code> 多路复用的方式，实际上就是 <code v-pre>ET</code> 模式的 <code v-pre>epoll</code>（<code v-pre>Redis</code> 的核心任务主要是操作内存的数据结构，不会吃很多的 <code v-pre>CPU</code> 资源）。</p>\n<p>另外，<code v-pre>Redis</code> 的很多核心功能都是比较简单的逻辑，简单逻辑就代表简单执行，就会非常快速。</p>\n<p><code v-pre>Redis</code> 相对于传统的关系型数据库（如 <code v-pre>MySQL</code>）或自定义内存中的变量有一些优势，这些优势可能导致选择 <code v-pre>Redis</code>：</p>\n<ol>\n<li>\n<p><strong>性能快速</strong>：这里的性能快速是和 <code v-pre>MySQL</code> 进行对比。</p>\n<p>(1)<code v-pre>Redis</code> 是一个基于内存的数据库，因此读写速度非常快，适合需要快速响应的应用场景，如缓存系统或计数器（因此常常是 <code v-pre>MySQL</code> 的一个替代方案，但是存储容量没有 <code v-pre>MySQL</code> 多，不过有一种方案就是两者同时结合使用，热点数据使用 <code v-pre>Redis</code>，其余数据使用 <code v-pre>MySQL</code>）。</p>\n</li>\n<li>\n<p><strong>数据结构</strong>：<code v-pre>Redis</code> 支持丰富的数据结构，如字符串、哈希表、列表、集合、有序集合、<code v-pre>GEO(地理信息定位)</code>...，这使得它可以更灵活地存储和操作数据，而不仅仅局限于关系型数据库的表结构（和 <code v-pre>MySQL</code> 关系数据库不同，<code v-pre>Redis</code> 是基于键值对来组织数据的，是一种典型的非关系型数据库）。</p>\n</li>\n<li>\n<p><strong>可编程的</strong>：可以使用命令行操作 <code v-pre>Redis</code>，也可以使用编程语言脚本的方式批量执行一些操作（主要使用 <code v-pre>Lua</code>，也是一种较火的语言）。</p>\n</li>\n<li>\n<p><strong>可拓展性</strong>：可以使用 <code v-pre>C/C++、Rust</code> 来为 <code v-pre>Redis</code> 功能做拓展（本质是安装动态链接库，类似 <code v-pre>.so/.dll</code> 等），例如支持更多数据结构和更多交互命令。</p>\n</li>\n<li>\n<p><strong>持久化数据</strong>：虽然 <code v-pre>Redis</code> 是基于内存的，但它提供了持久化选项，可以将数据定期写入磁盘，确保数据不会因为系统崩溃而丢失。并且也有两种持久化方案，<code v-pre>RDB</code> 和 <code v-pre>AOF</code>，前者是基于快照数据的持久化，后者是基于日志数据的持久化。</p>\n</li>\n<li>\n<p><strong>水平拓展</strong>：<code v-pre>Redis</code> 支持主从复制和集群模式，可以在多个主机部署多个节点。</p>\n</li>\n<li>\n<p><strong>高可用性</strong>：多个节点上可以复制数据（备份/冗余），提高系统的可用性和容错能力，从节点就相当于主节点的备份。</p>\n</li>\n<li>\n<p><strong>原子操作</strong>：<code v-pre>Redis</code> 支持原子操作，能够保证多个操作的原子性，避免了多线程或多进程并发操作数据时可能出现的竞态条件。</p>\n</li>\n<li>\n<p><strong>客户端语言多</strong>：客户端可以支持的语言非常多，包括但不限于 <code v-pre>Cpp, Java, Python, Node.js...</code>，使用起来非常简单。</p>\n</li>\n<li>\n<p><strong>主从复制功能</strong>：提供了复制功能，实现了多个相同数据的 <code v-pre>Redis</code> 副本。</p>\n</li>\n<li>\n<p><strong>高可用</strong>：提供了哨兵机制，保证 <code v-pre>Redis</code> 的故障发现和故障自动转移。</p>\n</li>\n</ol>\n<p>总的来说，<code v-pre>Redis</code> 适用于需要高性能、低延迟、丰富数据结构和高可用性的应用场景，如缓存、实时数据分析、会话存储等。虽然在某些情况下使用传统的关系型数据库或自定义内存变量也可以实现类似的功能，但 <code v-pre>Redis</code> 提供了更好的性能和更丰富的功能。</p>\n<p>进程间通信，如果是单机，就需要通过管道或者共享内存等机制来传递数据。而如果涉及到多台主机，就会涉及到网络通信。而 <code v-pre>Redis</code> 就是基于网络把内存中数据交给别的进程甚至是其他主机中进程来使用，并且一般是基于分布式系统的。</p>\n<p><code v-pre>Redis</code> 经常会被作为：</p>\n<ul>\n<li>\n<p>存储数据的非关系实时数据库（具有更低的存储和更高的效率）</p>\n</li>\n<li>\n<p>使用 <code v-pre>session</code> 配合 <code v-pre>cookie</code> 实现会话管理...</p>\n</li>\n<li>\n<p>消息队列消息中间件（这里不是进程通信中的消息队列），是网络中的生产者消费者模型（知名的消息队列就有 <code v-pre>RabbitMQ、Kafka、RocketMQ</code> 等，不过 <code v-pre>Redis</code> 的不常使用，多是顺带方便才使用）</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 一开始是作为消息中间件（消息队列）的一个生产者-消费者模型解决方案，但是这种类似的解决方案已经有更优的方案了。</p>\n</div>\n</li>\n</ul>\n<p>但是也不是没有缺点的，比如在数据量大的场景中无法使用，受限于内存空间存储空间不大等。</p>\n<h2 id=\"_2-组件部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-组件部署\"><span>2.组件部署</span></a></h2>\n<p><a href=\"https://redis.io/docs/latest/operate/oss_and_stack/install/install-stack/apt/\" target=\"_blank\" rel=\"noopener noreferrer\">依照 Redis 官方文档即可下载 Redis</a>。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> lsb-release</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 以下指令可能过时, 推荐您看官方文档</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -fsSL</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/gpg</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --dearmor</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 644</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> echo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">$(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lsb_release</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -cs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tee</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/apt/sources.list.d/redis.list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>Redis</code> 也有经典的 <code v-pre>CS</code> 模式，因此需要启动服务。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 启动 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> enable</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-server</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> start</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-server</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>测试是否安装成功。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 测试 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>6379</code> 是 <code v-pre>Redis</code> 默认的服务端程序运行端口号。</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 官方其实是不推荐在 <code v-pre>Windows</code> 下使用 <code v-pre>Redis</code> 的，但是我们有些时候会在 <code v-pre>Windows</code> 下进行测试，因此就可以尝试在 <a href=\"https://github.com/MicrosoftArchive/redis/releases\" target=\"_blank\" rel=\"noopener noreferrer\">这个页面下安装 Redis</a>，对于简单的测试已经足够了。</p>\n</div>\n<h2 id=\"_3-组件基础\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-组件基础\"><span>3.组件基础</span></a></h2>\n<h3 id=\"_3-1-登录退出\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-1-登录退出\"><span>3.1.登录退出</span></a></h3>\n<p>登录方式和 <code v-pre>MySQL</code> 是一样的，可以在命令行使用客户端登录的方式，也可以只执行单条的命令，我们可以简单试试启动 <code v-pre>Redis</code> 的客户端。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Redis 的登录和退出</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 直接使用客户端登录并且使用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -h</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6379</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # WebSocket 协议中, PING 和 PONG 是一种心跳机制, 服务器或客户端可以发送 PING, 而接收方会响应 PONG, 以确保连接存活</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hello</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exit</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 退出 Redis</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在命令行中只执行一次 Redis 的指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -h</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6379</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>注意：<code v-pre>Redis</code> 其实在实际开发中是不会暴露给外界访问的，我们这里只不过是为了方便把配置文件改为 <code v-pre>0.0.0.0</code>，如果您只在本机操作 <code v-pre>redis</code> 则默认使用的是 <code v-pre>127.0.0.1</code> 地址，并且默认 <code v-pre>6379</code> 端口，此时可以直接省略 <code v-pre>-h</code> 和 <code v-pre>-p</code> 直接登录。</p>\n</div>\n<h3 id=\"_3-2-指令教程\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-指令教程\"><span>3.2.指令教程</span></a></h3>\n<p>我们先再来学几个指令尝尝鲜，这些指令在后面用到的概率也非常高，另外 <code v-pre>Redis</code> 的指令也可以无视对大小写。</p>\n<h4 id=\"_3-2-1-基础指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-基础指令\"><span>3.2.1.基础指令</span></a></h4>\n<h5 id=\"_3-2-1-1-set-get-del\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-1-set-get-del\"><span>3.2.1.1.SET, GET, DEL</span></a></h5>\n<p><code v-pre>set, get, del</code> 这三个指令非常简单，就是设置（修改）、获取、删除键值对。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 set, get, del</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">del</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：实际上还有更加方便可用的变种指令</p>\n<ul>\n<li><code v-pre>setex &lt;key_name&gt; &lt;seconds&gt; &lt;key_value&gt;</code> 可以直接使用秒作为单位设置 <code v-pre>key</code> 的过期时间</li>\n<li><code v-pre>setpx &lt;key_name&gt; &lt;milliseconds&gt; &lt;key_value&gt;</code> 可以直接使用毫秒作为单位设置 <code v-pre>key</code> 的过期时间</li>\n<li><code v-pre>setnx &lt;key_name&gt; &lt;key_value&gt;</code> 只在 <code v-pre>key</code> 不存在时才进行设置，即如果 <code v-pre>key</code> 之前已经存在，不执行设置</li>\n<li><code v-pre>setxx &lt;key_name&gt; &lt;key_value&gt;</code> 只在 <code v-pre>key</code> 存在时才进行设置，即如果 <code v-pre>key</code> 之前不存在，不执行设置</li>\n<li><code v-pre>mset &lt;key_name_1&gt; &lt;key_value_1&gt; &lt;key_name_2&gt; &lt;key_value_2&gt; ...</code> 一次设置多个键值对</li>\n<li><code v-pre>mget key_name_1 key_name_2</code> 一次获取多个键值</li>\n<li>另外 <code v-pre>del</code> 本身就支持删除多个键值对...</li>\n</ul>\n<p>这种一次性设置的指令通常会更受欢迎，因为可以减缓一些网络 <code v-pre>IO</code> 的代价。</p>\n</div>\n<h5 id=\"_3-2-1-2-keys-exists-scan\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-2-keys-exists-scan\"><span>3.2.1.2.KEYS, EXISTS, SCAN</span></a></h5>\n<p><code v-pre>keys</code> 指令可以根据一定的样式，或者匹配模式来查询对应的 <code v-pre>key</code> 值，查询的复杂度是 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>，而 <code v-pre>exists</code> 则可以查询 <code v-pre>key</code> 存在的个数，时间复杂度是 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 keys, exists</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 这个是 set 的升级版, 可以一次设置多个 key-value 对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询所有 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_?</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_2 key_y 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 k2ey key_2 kkkkey key_1 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[13]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_3 这两个 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[^1]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询除了 key_1 以外的所有 key_2 key_w key_0 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[0-3]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_2 key_3 这三个 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找符合 key_1 的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_2</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找符合 key_1, key_2 的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>keys</code> 的时间复杂度比较大，一般在实际工程中会直接禁用这个命令，否者一旦 <code v-pre>Redis</code> 在有大量的指令时，就会出现“卡住”的情况，这和 <code v-pre>Redis</code> 的架构设计本身是有关系的，后面再说...</p>\n</div>\n<p>还有一个比较高效的增量扫描 <code v-pre>scan</code> 指令，放回的数据是分批量的，即便是在单线程的情况下，也可以非阻塞返回大规模数据集，不会对 <code v-pre>Redis</code> 有很大的性能影响。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 scan</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> match</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> ## 0 代表游标, 是扫描的起始位置, 表示从当前 Redis 键空间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> ## 这里是因为数据量不大, 直接返回新的游标为 0 表示扫描完成, 如果数据量大会得到新的游标</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>可以看到 <code v-pre>keys</code> 是扫描整个键值空间，但是 <code v-pre>scan</code> 可以由用户指定游标进行增量扫描。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 也是有关于数据库的概念的，也就是 <code v-pre>Redis</code> 键空间。</p>\n</div>\n<h5 id=\"_3-2-1-3-expire-ttl\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-3-expire-ttl\"><span>3.2.1.3.EXPIRE, TTL</span></a></h5>\n<p><code v-pre>expire</code> 为指定的 <code v-pre>key</code> 值添加秒级的过期时间，返回 <code v-pre>1</code> 表示设置成功，返回 <code v-pre>0</code> 表示设置失败，并且可以对同一个 <code v-pre>key</code> 值反复使用达到修改过期时间的目的。而 <code v-pre> TTL</code> 则可以获取指定 <code v-pre>key</code> 值的过去时间，单位也是秒级，其返回值为 <code v-pre>任意数字</code> 表示距离过期时间所剩的秒数，<code v-pre>-1</code> 表示没有关联过期时间，<code v-pre>-2</code> 表示 <code v-pre>key</code> 不存在。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 expire, ttl</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置 key 的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 每一秒获取一次</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看已经不存在的 key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 重新设置一个 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> other_key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 再设置另外一个 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 为第一个 key 设置过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第一个 key 剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 7</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第一个 key 剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 4</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> other_key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 试图查看另外一个没有设置过期时间的 key 的剩余过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 再次重新设置 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 正常获取</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100000</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置比较大的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 99994</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 重新设置过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 检查现在的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 9</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：实际上 <code v-pre>expire, ttl</code> 都有支持毫秒版本的 <code v-pre>pexpire, pttl</code>，使用方法类似。</p>\n</div>\n<h5 id=\"_3-2-1-4-type\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-4-type\"><span>3.2.1.4.TYPE</span></a></h5>\n<p><code v-pre>type</code> 也很简单，可以返回 <code v-pre>key</code> 值的数据类型，返回值有 <code v-pre>none, string, list, set, zset, hash, stream...</code> 其实就对应后面数据类型。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 type</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">string</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-2-1-5-incr-incrby-decr-decrby-incrbyfloar\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-5-incr-incrby-decr-decrby-incrbyfloar\"><span>3.2.1.5.INCR, INCRBY, DECR, DECRBY, INCRBYFLOAR</span></a></h5>\n<p><code v-pre>incr</code> 可以用来给一个字符串类型的实数进行 <code v-pre>+1</code> 操作，哪怕这个 <code v-pre>key</code> 值之前不存在，也会从 <code v-pre>0</code> 开始加起。<code v-pre>incrby</code> 也是类似，但是加上用户指定的整数值（注意只能是整数），不存在时，该 <code v-pre>key</code> 也是从 <code v-pre>0</code> 开始加起。而 <code v-pre>decr</code> 和 <code v-pre>decrby</code> 和前面两者类似，只不过是变成减而已。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：顺口一提上述关于 <code v-pre>...by</code> 的指令都可以使用负数作为操作数。</p>\n</div>\n<p>对于浮点数来说，只使用一个指令 <code v-pre>incrbyfloat</code> 就够了，功能也是类似的，加减使用正负实数调控就行。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 incr, incrby, decr, decrby, incrbyfloat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incr</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 4</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"4\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incrby</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrby</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 9</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># decr</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">decr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 8</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># decrby</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">decrby</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incrbyfloat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrbyfloat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5.6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"9.6\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrbyfloat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -3.10.33</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"-0.73\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-2-1-6-append-getrange-setrange-strlen\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-6-append-getrange-setrange-strlen\"><span>3.2.1.6.APPEND, GETRANGE, SETRANGE, STRLEN</span></a></h5>\n<p>还可以对字符串进行操作，这些也比较简单...</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 append, getrange, setrange, strlen</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置初始字符串值到键 mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ok</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取键 mykey 的值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">append</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> world</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 向 mykey 键追加字符串 \" world\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取追加后的 mykey 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello world\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 值中从索引 0 到 4 的子串</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 值中从索引 6 到 10 的子串</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"world\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">redis</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置 mykey 中从索引 6 开始的新值为 \"redis\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 setrange 操作后的 mykey 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello redis\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">strlen</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 字符串的长度</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：这些指令都很简单，如果您需要了解更多，可以 <a href=\"https://redis.io/docs/latest/develop/get-started/\" target=\"_blank\" rel=\"noopener noreferrer\">前往 Redis 的官网中查看</a>，不过由于我们使用 <code v-pre>Redis</code> 的大部分场景都是在代码中直接进行编程（除了一些运维人员、测试人员可能需要非常了解进行必要的检查以外），因此没有必要了解得特别细（除非需要使用）...</p>\n</div>\n<h4 id=\"_3-2-2-模块指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-模块指令\"><span>3.2.2.模块指令</span></a></h4>\n<p>除了基础的对于数据类型的操作指令，还有一些不同模块的指令，有需要再进行学习，不过这里先列出来：</p>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：模块默认不直接内嵌到 <code v-pre>redis service</code> 中，因此需要您下载 <code v-pre>Redis</code> 的拓展 <code v-pre>Redis Stack</code> 才能使用。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装 Redis Stack</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 停止传统的 Redis 服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> stop</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查是否停止 Redis 服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Could</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> not</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> to</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> at</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:6379:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Connection</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> refused</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">not</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> connecte</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">d</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> exit</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开始安装 Redis Stack</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> lsb-release</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -fsSL</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/gpg</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --dearmor</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 644</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> echo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">$(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lsb_release</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -cs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tee</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/apt/sources.list.d/redis.list</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 由于我使用的是 Ubuntu24.04(这个时候比较新), 因此我需要使用二进制进行下载, 而无法使用包管理安装...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在 https://redis.io/downloads/#redis-stack-downloads 底部获取你所需要的安装链接</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> wget</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/redis-stack/redis-stack-server-7.4.0-v1.jammy.x86_64.tar.gz</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mv</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server-7.4.0-v1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sh</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server/bin/redis-stack-server</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 此时就会启动输出...您可以开始测试是否已运行该服务...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 打开另外一个终端开始测试</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MODULE</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LIST</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">RedisCompat</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/rediscompat.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">redisgears_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20020</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisgears.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">v8-plugin-path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/libredisgears_v8_plugin.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">search</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 21005</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisearch.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MAXSEARCHRESULTS</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MAXAGGREGATERESULTS</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bf</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20802</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisbloom.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ReJSON</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20803</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/rejson.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">timeseries</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 11202</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redistimeseries.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 有比较多的回显就是配置成功了</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div>\n<h5 id=\"_3-2-2-1-redisearch-ft\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-1-redisearch-ft\"><span>3.2.2.1.RediSearch(<code v-pre>FT</code>)</span></a></h5>\n<p>主要用于全文搜索和数据索引功能，核心命令如：</p>\n<ul>\n<li><code v-pre>FT.CREATE</code>、<code v-pre>FT.ADD</code>、<code v-pre>FT.SEARCH</code>：创建索引、添加文档、搜索查询</li>\n<li><code v-pre>FT.AGGREGATE</code>：执行聚合查询</li>\n<li><code v-pre>FT.DROPINDEX</code>、<code v-pre>FT.SYNUPDATE</code> 等</li>\n</ul>\n<h5 id=\"_3-2-2-2-redisjson-json\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-2-redisjson-json\"><span>3.2.2.2.RedisJSON(<code v-pre>JSON</code>)</span></a></h5>\n<p><code v-pre>RedisJSON</code> 模块用于在 <code v-pre>Redis</code> 中存储和操作 <code v-pre>JSON</code> 数据类型，核心命令如：</p>\n<ul>\n<li><code v-pre>JSON.SET</code>：设置 <code v-pre>JSON</code> 数据</li>\n<li><code v-pre>JSON.GET</code>：获取 <code v-pre>JSON</code> 数据</li>\n<li><code v-pre>JSON.DEL</code>：删除 <code v-pre>JSON</code> 键</li>\n<li><code v-pre>JSON.MGET</code>：从多个键中获取 <code v-pre>JSON</code> 值</li>\n</ul>\n<h5 id=\"_3-2-2-3-redisgraph-graph\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-3-redisgraph-graph\"><span>3.2.2.3.RedisGraph(<code v-pre>GRAPH</code>)</span></a></h5>\n<p>RedisGraph 提供了图数据库功能，用于图数据的存储和查询，核心命令如：</p>\n<ul>\n<li><code v-pre>GRAPH.QUERY</code>：使用 <code v-pre>Cypher</code> 查询语言执行查询。</li>\n<li><code v-pre>GRAPH.PROFILE</code>：分析查询性能。</li>\n<li><code v-pre>GRAPH.DELETE</code>：删除图。</li>\n</ul>\n<h5 id=\"_3-2-2-4-redis-timeseries-ts\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-4-redis-timeseries-ts\"><span>3.2.2.4.Redis TimeSeries(<code v-pre>TS</code>)</span></a></h5>\n<p><code v-pre>RedisTimeSeries</code> 是用于存储和分析时间序列数据的模块，核心命令如：</p>\n<ul>\n<li><code v-pre>TS.CREATE</code>：创建时间序列</li>\n<li><code v-pre>TS.ADD</code>：添加时间序列数据点</li>\n<li><code v-pre>TS.RANGE</code>、<code v-pre>TS.MRANGE</code>：查询时间范围内的数据</li>\n<li><code v-pre>TS.ALTER</code>：修改时间序列元数据</li>\n</ul>\n<h5 id=\"_3-2-2-5-redisai-ai\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-5-redisai-ai\"><span>3.2.2.5.RedisAI(<code v-pre>AI</code>)</span></a></h5>\n<p><code v-pre>RedisAI</code> 用于在 <code v-pre>Redis</code> 中运行机器学习模型，支持 <code v-pre>TensorFlow, PyTorch, ONNX...</code> 模型，核心命令如：</p>\n<ul>\n<li><code v-pre>AI.MODELSET</code>：加载机器学习模型</li>\n<li><code v-pre>AI.MODELRUN</code>：运行机器学习模型</li>\n<li><code v-pre>AI.SCRIPTSET</code>：设置自定义脚本</li>\n<li><code v-pre>AI.TENSORSET</code> 和 <code v-pre>AI.TENSORGET</code>：处理张量数据</li>\n</ul>\n<h5 id=\"_3-2-2-6-redisbloom-bf-cf-cms-topk\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-6-redisbloom-bf-cf-cms-topk\"><span>3.2.2.6.RedisBloom(<code v-pre>BF</code>, <code v-pre>CF</code>, <code v-pre>CMS</code>, <code v-pre>TOPK</code>)</span></a></h5>\n<p><code v-pre>RedisBloom</code> 提供了<code v-pre>布隆过滤器, 计数最小堆, Cuckoo Filter, TopK...</code> 等数据类型，适合处理大数据集合。</p>\n<ul>\n<li><strong>布隆过滤器</strong> (<code v-pre>BF</code>)：<code v-pre>BF.ADD</code>、<code v-pre>BF.EXISTS</code></li>\n<li><strong>Cuckoo Filter</strong> (<code v-pre>CF</code>)：<code v-pre>CF.ADD</code>、<code v-pre>CF.EXISTS</code></li>\n<li><strong>Count-Min Sketch</strong> (<code v-pre>CMS</code>)：<code v-pre>CMS.INCRBY</code>、<code v-pre>CMS.QUERY</code></li>\n<li><strong>TopK</strong>：<code v-pre>TOPK.ADD</code>、<code v-pre>TOPK.QUERY</code></li>\n</ul>\n<p>这些模块可以根据场景进行组合使用，以增强 <code v-pre>Redis</code> 数据库的功能，从而更高效地处理搜索、图数据、时间序列分析和机器学习任务。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：由于有需要我补充这部分内容。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 RediSearch 和 RedisJSON 的相关指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">FT.CREATE</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置添加索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">idx:bicycle</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置索引名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ON</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> JSON</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 表示针对</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> JSON</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 的索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PREFIX</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 仅对具有</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 前缀的键创建索引</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">这里的数字代表可以设置多个前缀</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCORE</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 为该索引设置评分</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">用于索引之间进行评分比较</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCHEMA</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 后面定义字段的模式</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.brand</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> brand</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.model </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> model</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.description </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> description</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.price </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> price</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> NUMERIC</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.condition </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">TAG </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SEPARATOR</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置标签, 用于分割不同 JSON 对象</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完整一行指令为 FT.CREATE idx:bicycle ON JSON PREFIX 1 bicycle: SCORE 1.0 SCHEMA $.brand AS brand TEXT WEIGHT 1.0 $.model AS model TEXT WEIGHT 1.0 $.description AS description TEXT WEIGHT 1.0 $.price AS price NUMERIC $.condition AS condition TAG SEPARATOR \",\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 上述描述的就是一个 JSON 对象的集合</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#   \"bicycle:xxx\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"brand\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"model\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"description\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"price\": 0,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"condition\": \"\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#   },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 可以使用 FT.INFO idx:bicycle 查看配置结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置 \"键名-JSON:\" 对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.SET</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 存储在根处,</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 也可以是只设置字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: 270, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\\</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">}\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完整指令为 JSON.SET \"bicycle:0\" \".\" \"{\\\"brand\\\": \\\"Velorim\\\", \\\"model\\\": \\\"Jigger\\\", \\\"price\\\": 270, \\\"description\\\": \\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\\\u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\", \\\"condition\\\": \\\"new\\\"}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 获取键对应 JSON 的某个字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.GET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.brand</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.price</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:[</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">],</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:[270]}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 更新键对应 JSON 的某个字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.SET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:1234</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $ </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">{\"price\": 600}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查卡键对应 JSON 的所有字段‘</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.GET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:270,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 不过我们使用的是 JSON.GET, 如果使用 FT.SEARCH 还能用于执行基于全文索引的搜索查询, 它结合了索引、评分、排序和过滤功能, 可以用于复杂的搜索操作...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 FT 的查询</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">FT.SEARCH</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">idx:bicycle</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LIMIT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">$</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:270,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>更多待补充...</p>\n</div>\n<h4 id=\"_3-2-3-自定指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-3-自定指令\"><span>3.2.3.自定指令</span></a></h4>\n<p>除了已有的基础指令和模块指令，还可以使用 <code v-pre>Lua</code> 脚本代码编写出用户自己定义的指令，待补充...</p>\n<h3 id=\"_3-3-数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-数据类型\"><span>3.3.数据类型</span></a></h3>\n<h4 id=\"_3-3-1-数据类型分类\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-1-数据类型分类\"><span>3.3.1.数据类型分类</span></a></h4>\n<p>知道前面的基础指令后，就可以知道 <code v-pre>Redis</code> 是一个跨语言的大号键值对存储数据库，但是除了简单的字符类型以外，键位对应的值还可以是其他数据类型，主要的数据类型有一下六种。</p>\n<ul>\n<li><strong>字符 String</strong> 最基本的数据类型，支持二进制安全的字符串</li>\n<li><strong>列表 List</strong> 按插入顺序存储的字符串列表，支持从两端推入和弹出操作</li>\n<li><strong>无权集合 Set</strong> 无序无权字符串集合，不允许重复元素</li>\n<li><strong>带权集合 Zset</strong> 有序有权字符串集合，保留集合无序不可重复的特点，但每个成员都有一个与之关联的分数（是允许重复的浮点数），并可以按分数排序</li>\n<li><strong>键值集合 Hash</strong> 键值对的集合，适用于存储对象的字段和对应的值，也可以叫哈希，这意味着键对应的值也可以是一系列键值对（有点套娃）</li>\n<li><strong>空值 None</strong> 当键值对不存在时的一种特殊类型</li>\n</ul>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：也有一些比较高级的类型，有很多是字符类型演变而来。</p>\n<ul>\n<li><strong>位图 bitmap</strong> 可以看作是一种压缩的数据类型，按位存储数据</li>\n<li><strong>地理位置 geospatial</strong> 用于存储地理位置数据并进行地理空间查询</li>\n<li><strong>流 stream</strong> 用于存储和管理日志数据、消息队列等类型的数据，流的条目按时间戳进行排序</li>\n<li><strong>基数 HyperLogLog</strong> 用于统计某个数据流中不重复元素的数量（如果您的需求是要 <strong>存储所有的元素并进行操作</strong>，那么 <code v-pre>Set</code> 是合适的选择；如果您只是需要 <strong>估算独立元素的数量</strong>，且不关心精确值，那么 <code v-pre>Hyper LogLog</code> 会更高效）</li>\n<li>...</li>\n</ul>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：流的存在，使得 <code v-pre>Redis</code> 可以简单充当一个消息队列，但是这不是 <code v-pre>Redis</code> 的主要应用场景。不过这可以作为中小型项目的消息队列组件，尤其是在已经引入 <code v-pre>Redis</code> 时，可以快速把 <code v-pre>Redis</code> 作为消息队列，减低系统复杂度。</p>\n</div>\n<h4 id=\"_3-3-2-外部数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-外部数据类型\"><span>3.3.2.外部数据类型</span></a></h4>\n<h5 id=\"_3-3-2-1-string-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-1-string-的基本操作\"><span>3.3.2.1.String 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># String</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystring</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystring</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">string</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-2-list-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-2-list-的基本操作\"><span>3.3.2.2.List 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># List</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询列表所有元素, 0 表示最先一个元素, -1 表示最后一个元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 mylist [1] 处的元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">list</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 除此以外还有阻塞版本的指令, 例如 blpop 和 brpop</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在有数据的情况下行为与 lpop 和 rpop 一致</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 但无数据的情况下 lpop 和 rpop 会立刻返回 nil, 客户端呈现请求阻塞状态, 且期间 Redis 可以继续执行其他指令, 如果超出设定的 timeout 也会返回 nil</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-3-set-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-3-set-的基本操作\"><span>3.3.2.3.Set 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Set</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">smembers</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sismember</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sismember</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 表示不存在这个元素</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">set</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Redis 除了支持增删查改的基础操作, 也支持交集(sinterstore/sinter)、并集(sunionstore/sunion)、差集(sdiffstore/sdiff)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-4-zset-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-4-zset-的基本操作\"><span>3.3.2.4.Zset 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Zset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 添加</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 添加成功个数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查询</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zcrd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # zset 的元素个数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找是否存在元素并且返回排名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zset</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 除此以外还有一些额外的选项</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [XX | NX]: 仅仅⽤于更新已经存在的元素, 不会添加新元素; 仅⽤于添加新元素，不会更新已经存在的元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [GT | LT]: Greater Than, 表示“大于”, 通常用于范围查询中, 表示取值大于某个指定的值; Less Than, 表示“小于”, 通常用于范围查询中, 表示取值小于某个指定的值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [CH]: 默认情况下, ZADD 返回的是本次添加的元素个数, 但指定这个选项之后, 就会还包含本次更新的元素的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [INCR]: 此时命令类似 ZINCRBY 的效果, 将元素的分数加上指定的分数, 此时只能指定⼀个元素和分数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 也支持集合, 并且是聚合集合</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>ZINTERSTORE</code> 是 <code v-pre>Redis</code> 的一个命令，用于对多个有序集合（<code v-pre>ZSET</code>）进行交集操作，并将结果存储到指定的目标集合中。具体来说，<code v-pre>ZINTERSTORE</code> 会计算多个有序集合的交集，并根据权重和聚合方式合并它们的分数，然后将结果保存在指定的目标集合中。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 聚合搜索</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zinterstore</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> destination</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> numkeys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [key </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">...]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [weights </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">weight</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [weight </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">...]]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [aggregate </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sum</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> min</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> max</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (1) destination: 目标集合的名称，交集的结果将存储在这个集合中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (2) numkeys: 输入的有序集合的数量(key 的数量)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (3) key [key ...]: 参与交集操作的多个有序集合的键名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (4) weights weight [weight ...]: 可选参数, 指定每个集合的权重(默认权重为 1), 如果提供了权重, Redis 会按权重计算每个集合中的元素分数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (5) aggregate &#x3C;sum | min | max>: 可选参数, 指定合并多个集合元素时如何聚合它们的分数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# sum 表示分数相加(默认)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# mim 表示取最小值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# max 表示取最大值</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div>\n<h5 id=\"_3-3-2-5-hash-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-5-hash-的基本操作\"><span>3.3.2.5.Hash 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Hash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hkeys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取哈希中的所有字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hvals</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取哈希中的所有值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hexists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field2</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 检查某个字段是否存在于哈希中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">hash</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 内部的哈希通常被称为 <code v-pre>field-value</code> 对，这主要是为了和 <code v-pre>Readis</code> 本身的 <code v-pre>key-value</code> 做区分。</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：使用 <code v-pre>HGETALL</code> 获取哈希元素个数过多时，就有可能阻塞 <code v-pre>Redis</code>，这种情况下可以使用 <code v-pre>HSCAN</code> 扫描指令。</p>\n</div>\n<h5 id=\"_3-3-2-6-none-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-6-none-的基本操作\"><span>3.3.2.6.None 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># None</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> non_existing_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">none</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-3-3-高级数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-高级数据类型\"><span>3.3.3.高级数据类型</span></a></h4>\n<p>下面补充一些高级数据类型的使用。</p>\n<h5 id=\"_3-3-3-1-bitmap\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-1-bitmap\"><span>3.3.3.1.Bitmap</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Bitmap</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置第 7 位为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置第 2 位为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第 7 位设置的比特值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第 7 位设置的比特值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bitcount</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 统计位图中总共有多少个设置为 1 的比特位</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-2-geospatial\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-2-geospatial\"><span>3.3.3.2.Geospatial</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Geospatial</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geoadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 13.361389</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 38.115556</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置一个地理位置, 这里设置了经纬度和地名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geoadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 15.087269</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 37.502669</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geopos</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询某个位置的经纬度</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">13.36138933897018433</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">38.11555639549629859</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geodist</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> km</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询两个地点之间的距离, 以 km 单位</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"166.2742\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">georadius</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 15</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 37</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> km</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询以经纬度 15, 37 为中心, 半径为 100km 的所有地名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-3-stream\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-3-stream\"><span>3.3.3.3.Stream</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Stream</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 添加流</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 添加流的指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置流的名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              *</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 代表由</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 自己生成时间戳</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 18</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 代表流存储的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358298361-0\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每条消息都有一个唯一的 ID, 这个 ID 由两部分组成, 使用 - 分隔</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 第一部分是一个时间戳(毫秒级), 表示消息被写入流的时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 第二部分是一个序列号, 用来区分同一时间戳下的不同消息(为了区分同时间戳)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358303994-0\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 20</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358311147-0\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查询流</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 0 表示从流的开始读取所有的消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358298361-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">18</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358303994-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $ </span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># $ 表示从最新的数据开始读取所有的消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358311147-0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 直接使用流 ID 查询就是读取该 ID 之后的所有消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358303994-0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358298361-0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358303994-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 这种情况下是直接消费数据的, 并且数据不会因为消费消失</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-4-hyperloglog\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-4-hyperloglog\"><span>3.3.3.4.HyperLogLog</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># HyperLogLog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">PFADD</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ip_set</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 这个是重复的</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> IP</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 地址</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                \"192.168.0.4\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.5</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 完整指令为 PFADD ip_set \"192.168.0.1\" \"192.168.0.2\" \"192.168.0.3\" \"192.168.0.1\" \"192.168.0.4\" \"192.168.0.5\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">PFCOUNT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ip_set</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 5</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：不知道您有没有发现很相当大的一部分数据类型是由 <code v-pre>string</code> 这个类型衍生出来的，因此如果需要细学其他的类型，就必须先对 <code v-pre>string</code> 有足够的理解，首先您至少需要知道几件事：</p>\n<ul>\n<li>\n<p>所有的键名类型都是字符类型</p>\n</li>\n<li>\n<p>字符串类型的键值可以单纯是（但是一个字符串的最大值不能是 <code v-pre>512MB</code>）：</p>\n<ul>\n<li>字符串</li>\n<li>一般格式的 <code v-pre>JSON</code></li>\n<li>一般格式的 <code v-pre>XML</code></li>\n<li>数字</li>\n<li>二进制流</li>\n</ul>\n</li>\n<li>\n<p><code v-pre>Redis</code> 内部存储的字符串是完全按照二进制流的形式保存的，所以不需要处理字符集编码，客户端传入的是什么字符集就存储什么</p>\n</li>\n</ul>\n</div>\n<h4 id=\"_3-3-4-内部数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-内部数据类型\"><span>3.3.4.内部数据类型</span></a></h4>\n<p>实际上 <code v-pre>Redis</code> 针对每一种数据类型都有自己的底层内部编码实现，而且是多种实现，这样 <code v-pre>Redis</code> 就会根据合适的场景选择合适的内部编码，例如下表（除去空类型剩下的五个类型）。</p>\n<table>\n<thead>\n<tr>\n<th><strong>数据类型</strong></th>\n<th><strong>内部编码</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>String</td>\n<td><code v-pre>raw(&gt;=39byte), int(8 byte), embstr(&lt;=39byte)</code></td>\n</tr>\n<tr>\n<td>List</td>\n<td><code v-pre>linkedlist, ziplist</code></td>\n</tr>\n<tr>\n<td>Set</td>\n<td><code v-pre>hashtable, intset</code></td>\n</tr>\n<tr>\n<td>Zset</td>\n<td><code v-pre>skiplist, ziplist</code></td>\n</tr>\n<tr>\n<td>Hash</td>\n<td><code v-pre>hashtable, ziplist</code></td>\n</tr>\n</tbody>\n</table>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：我们可以通过 <code v-pre>object encoding 键名</code> 查询此时键的内部编码。</p>\n</div>\n<p><code v-pre>Redis</code> 这样设计有两个好处：</p>\n<ul>\n<li>方便 <code v-pre>Redis</code> 未来改进内部编码，而对外的数据类型和命令没有任何影响，这样可以开发出更优秀的内部编码</li>\n<li>多种内部编码实现可以在不同场景下发挥各自的优势，例如 <code v-pre>ziplist</code> 比较节省内存，但是在列表元素比较较多的情况下，性能会下降，这时候 <code v-pre>Redis</code> 会根据配置选项将列表类型的内部实现转换为 <code v-pre>linkedlist</code>，整个过程用户是全无感知的</li>\n</ul>\n<h5 id=\"_3-3-4-1-string-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-1-string-的内部编码\"><span>3.3.4.1.String 的内部编码</span></a></h5>\n<p>尤其是字符串类型，内部编码至少有三种，<code v-pre>Redis</code> 会自动根据当前的值来决定使用哪一种内部编码进行实现。</p>\n<ul>\n<li>\n<p><strong>int(8byte 的长整型)</strong></p>\n</li>\n<li>\n<p><strong>embstr(&lt;= 39byte 的字符串)</strong></p>\n</li>\n<li>\n<p><strong>raw(&gt; 39byte 的字符串)</strong></p>\n</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查看 string 内部编码的变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 123</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"int\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> limou</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"embstr\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> limou343434343434343434343434343434343434343434343434343434343434</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"raw\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-4-2-list-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-2-list-的内部编码\"><span>3.3.4.2.List 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：下面两个条件同时满足时</p>\n<ul>\n<li>列表元素个数小于 <code v-pre>list-max-ziplist-entries</code> 配置（默认 <code v-pre>512</code> 个）</li>\n<li>列表元素长度小于 <code v-pre>list-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会使用压缩列表（<code v-pre>ziplist</code>）作为列表的内部编码方式，从而减少内存消耗</p>\n</li>\n<li>\n<p><strong>linkedlist(链表)</strong>：当哈希类型无法满足 <code v-pre>ziplist</code> 的条件时，<code v-pre>Redis</code> 会使⽤ <code v-pre>hashtable</code> 作为哈希的内部实现，<code v-pre>Redis</code> 会选择使用 <code v-pre>linkedlist</code> 作为列表的内部实现。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-3-set-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-3-set-的内部编码\"><span>3.3.4.3.Set 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>intset(整数集合)</strong>：</p>\n<ul>\n<li>集合元素的个数小于 <code v-pre>set-max-intset-entries</code> 配置（默认最大 <code v-pre>512</code> 个元素）</li>\n<li>集合元素值都是整数</li>\n</ul>\n<p><code v-pre>Redis</code> 会使用 <code v-pre>intset</code> 作为集合的内部实现，<code v-pre>intset</code> 是一个专门优化整数集合的压缩结构，可以显著减少内存使用。</p>\n</li>\n<li>\n<p><strong>hashtable(哈希表)</strong>：当列表类型无法满足 <code v-pre>intset</code> 的条件时，<code v-pre>Redis</code> 会使用 <code v-pre>hashtable</code> 作为集合的内部实现。<code v-pre>hashtable</code> 提供了高效的插入、查找和删除操作，适用于较大的集合。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-4-zset-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-4-zset-的内部编码\"><span>3.3.4.4.Zset 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：</p>\n<ul>\n<li>集合元素的个数小于 <code v-pre>zset-max-ziplist-entries</code> 配置（默认 <code v-pre>128</code> 个）</li>\n<li>每个元素的值都小于 <code v-pre>zset-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会⽤ <code v-pre>ziplist</code> 来作为有序集合的内部实现，<code v-pre>ziplist</code> 可以有效减少内存消耗</p>\n</li>\n<li>\n<p><strong>skiplist(跳表)</strong>：当 <code v-pre>ziplist</code> 条件不满足时，有序集合会使用 <code v-pre>skiplist</code> 作为内部实现，因为此时 <code v-pre>ziplist</code> 的操作效率会下降。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-5-hash-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-5-hash-的内部编码\"><span>3.3.4.5.Hash 的内部编码</span></a></h5>\n<p>哈希本身的内部编码变化也值得我们关注，内部的编码实现至少有两种 <code v-pre>ziplist(压缩列表), hashtable(哈希表)</code>，这就比字符串要复杂一些。</p>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：下面两个条件同时满足时</p>\n<ul>\n<li>哈希元素个数小于 <code v-pre>hash-max-ziplist-entries</code> 配置（默认 <code v-pre>512</code> 个）</li>\n<li>哈希元素值都小于 <code v-pre>hash-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会使⽤ <code v-pre>ziplist</code> 作为哈希的内部实现，<code v-pre>ziplist</code> 使用更加紧凑的结构实现多个元素的连续存储，所以在节省内存方面比 <code v-pre>hashtable</code> 更加优秀。</p>\n</li>\n<li>\n<p><strong>hashtable(哈希表)</strong>：当哈希类型无法满足 <code v-pre>ziplist</code> 的条件时，<code v-pre>Redis</code> 会使⽤ <code v-pre>hashtable</code> 作为哈希的内部实现，因为此时 <code v-pre>ziplist</code> 的读写效率会下降，而 <code v-pre>hashtable</code> 的读写时间复杂度为 <code v-pre>O(1)</code>。</p>\n</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查看 Hash 内部编码的变化(略)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-4-6-none-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-6-none-的内部编码\"><span>3.3.4.6.None 的内部编码</span></a></h5>\n<p>待补充...</p>\n<h4 id=\"_3-3-4-数据类型原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-数据类型原理\"><span>3.3.4.数据类型原理</span></a></h4>\n<p>待补充...</p>\n<h3 id=\"_3-4-渐进遍历\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-4-渐进遍历\"><span>3.4.渐进遍历</span></a></h3>\n<p><code v-pre>Redis</code> 提供了 <code v-pre>SCAN</code> 命令，允许用户以渐进式的方式进行键的遍历，避免了阻塞操作，适用于遍历大量数据的场景。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCAN</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [TYPE </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># cursor: 游标，初始值为 `0`，返回的游标值指示下次扫描的位置。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># MATCH pattern: 可选参数，用于过滤键名，支持模式匹配（类似于 `glob` 模式）。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># COUNT count: 可选参数，建议每次返回的元素数量。并不是严格的数量限制，实际返回数量可能会有所不同。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># TYPE type: 可选参数，指定键的类型（如 `string`, `list`, `set`, `zset`, `hash` 等）。</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>SCAN</code> 命令的时间复杂度是常数时间 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>，但遍历大数据集时，实际的时间复杂度会受到 <code v-pre>MATCH</code> 和 <code v-pre>COUNT</code> 参数的影响。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:637</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">9></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">17</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:12</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:8</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:14</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:16</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:17</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:15</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   9</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   10</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:7</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:637</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">9></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 17</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:5</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:18</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:19</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:13</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:6</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:9</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   9</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:11</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>Redis</code> 还为不同数据类型提供了相应的 <code v-pre>SCAN</code> 命令变种，功能与 <code v-pre>SCAN</code> 基本类似：</p>\n<ul>\n<li><strong>hscan</strong>: 用于扫描哈希类型的数据。</li>\n<li><strong>sscan</strong>: 用于扫描集合类型的数据。</li>\n<li><strong>zscan</strong>: 用于扫描有序集合类型的数据。</li>\n</ul>\n<p>它们的语法和使用方式与 <code v-pre>SCAN</code> 相同，只是针对特定类型的数据进行扫描。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>scan</code> 在使用过程中也有值得注意的地方。</p>\n<ul>\n<li>\n<p><strong>渐进性遍历</strong>：<code v-pre>SCAN</code> 命令是渐进式的，它不会一次性返回所有数据，而是通过多次调用来遍历数据。每次返回部分数据，并返回一个游标，指示下一次扫描的位置。</p>\n</li>\n<li>\n<p><strong>遍历期间的数据变化</strong>：在扫描期间，如果 <code v-pre>Redis</code> 数据发生变化（例如增加、修改或删除键），可能会导致以下问题：</p>\n<ul>\n<li><strong>重复遍历</strong>：某些键可能会被扫描多次</li>\n<li><strong>遗漏数据</strong>：某些键可能会被遗漏</li>\n</ul>\n<p>因此，在使用 <code v-pre>SCAN</code> 命令时，开发者应考虑到数据可能会在遍历过程中发生变化的情况。</p>\n</li>\n</ul>\n</div>\n<h3 id=\"_3-5-键值空间\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-5-键值空间\"><span>3.5.键值空间</span></a></h3>\n<p>与 <code v-pre>MySQL</code> 等关系型数据库不同的是，<code v-pre>Redis</code> 没有表、字段这种命名空间，而且也没有对键名有强制要求（除了不能使用一些特殊字符）。但设计合理的键名，有利于防止键冲突和项目的可维护性，比较推荐的方式是使用 <mark>&quot;业务名:对象名:唯一标识:属性&quot;</mark> 作为键名。例如 <code v-pre>MySQL</code> 的数据库名为 <code v-pre>vs</code>，用户表名为 <code v-pre>user_info</code>，那么对应的键 <code v-pre>name</code> 可以使用 <code v-pre>&quot;vs:user_info:6379:name&quot;</code> 来表示，如果当前 <code v-pre>Redis</code> 只会被⼀个业务使用，可以省略业务名 <code v-pre>&quot;vs:&quot;</code>。</p>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>注意：键名过长也会影响到 <code v-pre>Redis</code> 的性能。</p>\n</div>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>Redis</code> 中虽然支持持多数据库，但随着版本的升级，其实不是特别建议使⽤多数据库特性。如果真的需要完全隔离的两套键值对，更好的做法是维护多个 <code v-pre>Redis</code> 实例，而不是在⼀个 <code v-pre>Redis</code> 实例中维护多数据库。这是因为本身 <code v-pre>Redis</code> 并没有为多数据库提供太多的特性，其次无论是否有多个数据库，<code v-pre>Redis</code> 都是使用单线程模型，所以彼此之间还是需要排队等待命令的执行。同时多数据库还会让开发、调试和运维⼯作变得复杂。所以实践中，始终使用数据库 <code v-pre>0</code> 其实是⼀个很好的选择。</p>\n</div>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>flushdb/flushall</code> 命令用于清除数据库，区别在于 <code v-pre>flushdb</code> 只清除当前数据库，<code v-pre>flushall</code> 会清理所有数据库（这些行为很接近删库）。</p>\n</div>\n<h3 id=\"_3-6-设计架构\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-6-设计架构\"><span>3.6.设计架构</span></a></h3>\n<p>实际上 <code v-pre>Redis</code> 采用的是单线程的架构，但是为什么采用单线程还能这么快呢？主要原因如下：</p>\n<ul>\n<li>纯内存访问，这是最重要的一点，工作环境和 <code v-pre>MySQL</code> 等持久化数据库完全不一样</li>\n<li>非阻塞 <code v-pre>IO</code> 模型，底层用 <code v-pre>epoll</code> 的 <code v-pre>ET</code> 模式，无论时连接、读写、关闭都被转化为事件来处理，因此不会在网络 <code v-pre>IO</code> 上浪费太多时间</li>\n<li>单线程模型，无论客户端如何操作，在微观上一定时存在时间差的，因此就避免了线程切换开销的问题和并发加锁的问题</li>\n</ul>\n<p><code v-pre>Redis</code> 的这种特性，导致 <code v-pre>Redis</code> 只能作用于快速执行场景的热数据，一旦某个操作过长，就会导致严重延时的响应，这对 <code v-pre>Redis</code> 服务几乎是致命的。</p>\n<h3 id=\"_3-7-的持久化\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-的持久化\"><span>3.7.的持久化</span></a></h3>\n<h4 id=\"_3-7-1-rdb\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-rdb\"><span>3.7.1.RDB</span></a></h4>\n<h5 id=\"_3-7-1-1-rdb-的简单介绍\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-1-rdb-的简单介绍\"><span>3.7.1.1.RDB 的简单介绍</span></a></h5>\n<p><code v-pre>Redis</code> 的 <strong>RDB(Redis Database)</strong> 持久化机制是将当前内存中的数据生成快照并保存到磁盘的过程。<code v-pre>RDB</code> 是一种高效的持久化方式，但它有可能丢失短时间内的数据更新。</p>\n<p>转储的 <code v-pre>RDB</code> ⽂件保存在 <code v-pre>dir</code> 配置指定的目录下（默认 <code v-pre>/var/lib/redis/</code>），⽂件名通过 <code v-pre>dbfilename</code> 配置（默认 <code v-pre>dump.rdb</code>）指定。可以通过执行 <code v-pre>config set dir {newDir}</code> 和 <code v-pre>config set dbfilename {newFilename}</code> 运行期间动态执行，当下次运行时 <code v-pre>RDB</code> ⽂件会保存到新目录。</p>\n<p><code v-pre>Redis</code> 默认采⽤ <code v-pre>LZF</code> 算法对⽣成的 <code v-pre>RDB</code> ⽂件做压缩处理，压缩后的文件远远小于内存大小，默认开启，可以通过参数 <code v-pre>config set rdbcompression {yes|no}</code> 动态修改。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：虽然压缩 <code v-pre>RDB</code> 会消耗 <code v-pre>CPU</code>，但可以大幅降低文件的体积，方便保存到硬盘或通过网络发送到 <strong>从节点</strong>，因此建议开启。</p>\n</div>\n<h5 id=\"_3-7-1-2-rdb-的触发机制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-rdb-的触发机制\"><span>3.7.1.2.RDB 的触发机制</span></a></h5>\n<h6 id=\"_3-7-1-2-1-手动触发\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-1-手动触发\"><span>3.7.1.2.1.手动触发</span></a></h6>\n<ul>\n<li><code v-pre>save</code>：在执行 <code v-pre>save</code> 命令时，<code v-pre>Redis</code> 会阻塞当前服务器，直到 <code v-pre>RDB</code> 过程完成为止。对于大规模数据集会导致长时间的阻塞，因此在实际使用中很少采用。</li>\n<li><code v-pre>bgsave</code>：执行 <code v-pre>bgsave</code> 命令时，<code v-pre>Redis</code> 通过 <code v-pre>fork</code> 创建一个子进程来处理 <code v-pre>RDB</code> 持久化，主进程不会被阻塞，持久化任务由子进程处理。<code v-pre>RDB</code> 完成后，子进程会自动结束，主进程继续处理其他请求。</li>\n</ul>\n<h6 id=\"_3-7-1-2-2-自动触发\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-2-自动触发\"><span>3.7.1.2.2.自动触发</span></a></h6>\n<p>除了手动触发，<code v-pre>Redis</code> 还支持以下几种自动触发的机制：</p>\n<ul>\n<li><code v-pre>save</code>：通过配置文件中的 <code v-pre>save m n</code> 指令，<code v-pre>Redis</code> 会在每隔 <code v-pre>m</code> 秒内数据集发生了 <code v-pre>n</code> 次修改时，自动触发 <code v-pre>RDB</code> 持久化</li>\n<li>从节点复制操作：当 <code v-pre>Redis</code> 的 <strong>从节点</strong> 进行全量复制时，主节点会自动执行 <code v-pre>RDB</code> 持久化，并将生成的 <code v-pre>RDB</code> 文件内容发送给从节点</li>\n<li><code v-pre>shutdown</code>：当执行 <code v-pre>shutdown</code> 命令关闭 <code v-pre>Redis</code> 时，<code v-pre>Redis</code> 会自动执行 <code v-pre>RDB</code> 持久化，确保数据的持久性</li>\n</ul>\n<h5 id=\"_3-7-1-3-rdb-的实现原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-3-rdb-的实现原理\"><span>3.7.1.3.RDB 的实现原理</span></a></h5>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241120211127863.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>执行 <code v-pre>bgsave</code> 后父进程检查是否有其他的持久化子进程在执行持久化操作</li>\n<li>父进程通过 <code v-pre>fork</code> 创建持久化子进程，<code v-pre>fork</code> 的过程中父进程会轻微阻塞，通过 <code v-pre>info stats</code> 命令查看 <code v-pre>latest_fork_usec</code> 选项，可以获取最近一次 <code v-pre>fork</code> 操作的耗时，单位为微秒</li>\n<li><code v-pre>bgsave</code> 命令返回并释放父进程，继续处理请求</li>\n<li>子进程执行 <code v-pre>RDB</code> 持久化操作，根据父进程内存生成老师快照文件，完成并原子化替换原始的 <code v-pre>RDB</code> 文件，执行 <code v-pre>lastsave</code> 命令就可以获取最后一次生成 <code v-pre>RDB</code> 的时间，对应 <code v-pre>info</code> 统计的 <code v-pre>rdb_last_save_time</code> 选项</li>\n<li>子进程发送信号通知父进程操作完成，父进程更新统计信息</li>\n</ol>\n<h5 id=\"_3-7-1-4-rdb-的优势劣势\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-4-rdb-的优势劣势\"><span>3.7.1.4.RDB 的优势劣势</span></a></h5>\n<ul>\n<li><code v-pre>RDB</code> 文件是一个紧凑压缩的二进制文件，代表 <code v-pre>Redis</code> 在某个时间点上的数据快照 <code v-pre>RDB</code> 非常适用于备份、全量复制等场景。例如，每 <code v-pre>6</code> 小时执行 <code v-pre>bgsave</code> 备份，并把 <code v-pre>RDB</code> 文件复制到远程机器或者文件系统（如 <code v-pre>HDFS</code>）用于灾备。而 <code v-pre>Redis</code> 加载 <code v-pre>RDB</code> 恢复数据的速度远快于 <code v-pre>AOF</code> 的方式。</li>\n<li><code v-pre>RDB</code> 方式无法做到实时持久化或秒级持久化，因为 <code v-pre>bgsave</code> 每次执行都要进行 <code v-pre>fork</code> 创建子进程，这属于重量级操作，频繁执行成本过高。另外，由于 <code v-pre>RDB</code> 文件使用特定的二进制格式保存，随着 <code v-pre>Redis</code> 版本演进，<code v-pre>RDB</code> 格式可能发生变化，存在兼容性风险。</li>\n</ul>\n<h4 id=\"_3-7-2-aof\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-aof\"><span>3.7.2.AOF</span></a></h4>\n<h5 id=\"_3-7-2-1-aof-的简单介绍\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-1-aof-的简单介绍\"><span>3.7.2.1.AOF 的简单介绍</span></a></h5>\n<p><code v-pre>Redis</code> 的 <strong>AOF(Append Only File)</strong> 持久化机制，以独立日志的方式记录每次写命令，重启时再重新执行 <code v-pre>AOF</code> 文件中的命令以达到恢复数据的目的。<code v-pre>AOF</code> 的主要作用是解决了数据持久化的实时性问题，目前已经成为 <code v-pre>Redis</code> 持久化的主流方式。</p>\n<h5 id=\"_3-7-2-2-aof-的触发机制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-aof-的触发机制\"><span>3.7.2.2.AOF 的触发机制</span></a></h5>\n<h6 id=\"_3-7-2-2-1-启用持久\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-1-启用持久\"><span>3.7.2.2.1.启用持久</span></a></h6>\n<p>默认 <code v-pre>AOF</code> 是不开启的，需要配置设置 <code v-pre>appendonly yes</code> 才可以打开，<code v-pre>AOF</code> ⽂件名通过 <code v-pre>appendfilename</code> 配置（默认是 <code v-pre>appendonly.aof</code>）设置。保存目录同 <code v-pre>RDB</code> 持久化方式一直，也是通过 <code v-pre>dir</code> 配置来指定。</p>\n<p><code v-pre>AOF</code> 开启后，写命令也会被写入到缓存中，写入的持久化内容是以文本协议格式进行的。例如，<code v-pre>set hello world</code> 这条命令在 <code v-pre>AOF</code> 缓冲区会追加如下文本：</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">3</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$3</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$5</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">hello</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$5</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">world</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>这里遵循了 <code v-pre>Redis</code> 协议格式。<code v-pre>Redis</code> 选择文本协议的原因主要包括：</p>\n<ul>\n<li><strong>兼容性</strong>：文本协议具有较好的跨平台兼容性。</li>\n<li><strong>实现简单</strong>：文本协议易于理解和实现。</li>\n<li><strong>可读性</strong>：文本格式直观，便于调试和查看。</li>\n</ul>\n<p>在 <code v-pre>AOF</code> 过程中，需要一个名为 <code v-pre>aof_buf</code> 的缓冲区。<code v-pre>Redis</code> 使用单线程响应命令，如果每次写 <code v-pre>AOF</code> 文件都直接同步到硬盘，会导致性能下降，因为每次操作都涉及到 <code v-pre>IO</code> 读写，这比内存读写要慢。通过先写入缓冲区，可以有效减少 <code v-pre>IO</code> 次数。同时，<code v-pre>Redis</code> 提供了多种缓冲区同步策略，允许用户根据实际需求进行性能和数据持久性的平衡。</p>\n<h6 id=\"_3-7-2-2-2-同步策略\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-2-同步策略\"><span>3.7.2.2.2.同步策略</span></a></h6>\n<p><code v-pre>Redis</code> 提供了多种 <code v-pre>AOF</code> 缓冲区同步文件策略，通过参数 <code v-pre>appendfsync</code> 控制。不同值的含义如下：</p>\n<table>\n<thead>\n<tr>\n<th>可配置值</th>\n<th>说明</th>\n<th>建议</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code v-pre>always</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后调用 <code v-pre>fsync</code> 同步，完成后返回。</td>\n<td>每次写入都同步 <code v-pre>AOF</code> 文件，数据安全性最高。但是性能非常差，在一般的 <code v-pre>SATA</code> 硬盘上，只能支持约几百 <code v-pre>TPS</code> 的写入量。因此除非数据极其重要，否则不建议配置。</td>\n</tr>\n<tr>\n<td><code v-pre>everysec</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后只执行 <code v-pre>write</code> 操作，不进行 <code v-pre>fsync</code>。每秒由同步线程进行 <code v-pre>fsync</code>。</td>\n<td>默认配置，也是推荐配置。命令写入 <code v-pre>aof_buf</code> 后立即返回，由同步线程每秒执行一次 <code v-pre>fsync</code>。兼顾数据安全性和性能，理论上最多丢失 <code v-pre>1</code> 秒的数据。</td>\n</tr>\n<tr>\n<td><code v-pre>no</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后只执行 <code v-pre>write</code> 操作，由操作系统控制 <code v-pre>fsync</code> 频率。</td>\n<td>操作系统自行决定同步策略，性能较高，但数据丢失风险较大。仅适用于数据重要性极低的场景。</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>\n<p><strong><code v-pre>write</code> 操作：</strong></p>\n<ul>\n<li>会触发 <strong>延迟写</strong> 机制。</li>\n<li><code v-pre>Linux</code> 在内核中提供页面缓冲区，用来提升硬盘 <code v-pre>IO</code> 性能</li>\n<li><code v-pre>write</code> 操作在数据写入系统缓冲区后立即返回，数据同步到硬盘依赖系统调度机制（如缓冲区写满或达到特定时间周期）</li>\n<li>在数据同步到硬盘之前，如果系统发生故障或宕机，缓冲区内的数据将丢失</li>\n</ul>\n</li>\n<li>\n<p><strong><code v-pre>fsync</code> 操作：</strong></p>\n<ul>\n<li>针对单个文件操作，执行强制硬盘同步</li>\n<li><code v-pre>fsync</code> 会阻塞当前操作，直到数据写入到硬盘为止</li>\n</ul>\n</li>\n</ul>\n<p>在大多数场景下，推荐使用 <code v-pre>everysec</code> 配置，以获得较好的数据安全性和系统性能平衡。</p>\n<h6 id=\"_3-7-2-2-3-触发重写\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-3-触发重写\"><span>3.7.2.2.3.触发重写</span></a></h6>\n<p>3.7.2.2.3.1.手动触发</p>\n<p>手动触发 <code v-pre>AOF</code> 重写可以通过执行 <code v-pre>BGREWRITEAOF</code> 命令。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis-cli</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> BGREWRITEAOF</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>该命令会在后台执行 <code v-pre>AOF</code> 文件重写操作，将当前数据库状态保存到新的 <code v-pre>AOF</code> 文件中。</p>\n<p>3.7.2.2.3.2.自动触发</p>\n<p><code v-pre>AOF</code> 重写也可以根据以下两个参数自动触发：</p>\n<ul>\n<li><code v-pre>auto-aof-rewrite-min-size</code>：该参数表示触发 <code v-pre>AOF</code> 重写时，<code v-pre>AOF</code> 文件的最小大小。默认值为 <code v-pre>64MB</code>。当 <code v-pre>AOF</code> 文件的大小超过这个最小值时，<code v-pre>Redis</code> 会考虑是否进行自动重写。</li>\n<li><code v-pre>auto-aof-rewrite-percentage</code>：该参数表示当前 <code v-pre>AOF</code> 文件大小相对于上次重写时的增长百分比。只有当 <code v-pre>AOF</code> 文件的大小增加超过这个百分比时，才会触发自动重写。默认值为 <code v-pre>100%</code>。</li>\n</ul>\n<h5 id=\"_3-7-2-3-aof-的实现原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-3-aof-的实现原理\"><span>3.7.2.3.AOF 的实现原理</span></a></h5>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241120221238022.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>所有的写入命令会追加到 <code v-pre>aof_buf</code>（缓冲区）中</li>\n<li><code v-pre>AOF</code> 缓冲区根据对应的策略向硬盘进行同步操作</li>\n<li>随着 <code v-pre>AOF</code> 文件增大，需要定期对 <code v-pre>AOF</code> 文件进行等价重写，以达到压缩目的</li>\n<li>当 <code v-pre>Redis</code> 服务器启动时，可以加载 <code v-pre>AOF</code> 文件进行数据恢复</li>\n</ol>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：随着命令不断写入 <code v-pre>AOF</code>，文件会越来越大。为了解决这个问题，<code v-pre>Redis</code> 引入了 <code v-pre>AOF</code> 重写机制来压缩文件体积。<code v-pre>AOF</code> 文件重写是将 <code v-pre>Redis</code> 进程内的数据转换为写命令，并同步到新的 <code v-pre>AOF</code> 文件。重写后的 <code v-pre>AOF</code> 为什么可以变小？主要有以下理由：</p>\n<ul>\n<li><strong>超时数据的去除</strong> 进程内已超时的数据不会再写入文件，避免了过期数据的冗余存储</li>\n<li><strong>无效命令的删除</strong> 旧的 <code v-pre>AOF</code> 文件中可能包含无效命令（如 <code v-pre>del</code>、<code v-pre>hdel</code>、<code v-pre>srem</code> 等）。在重写过程中，这些命令会被删除，只保留数据的最终版本</li>\n<li><strong>多条写操作合并</strong> 多条相似的写操作可以合并为一条命令。例如，<code v-pre>lpush list a</code>、<code v-pre>lpush list b</code>、<code v-pre>lpush list c</code> 可以合并为 <code v-pre>lpush list a b c</code>，从而减少冗余操作</li>\n</ul>\n</div>\n<p>此外还有一个重写的原理，您也可以简单看一看。</p>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241121083647145.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>\n<p>执行 <code v-pre>AOF</code> 重写请求</p>\n<ul>\n<li>如果当前进程正在执行 <code v-pre>AOF</code> 重写，请求不执行</li>\n<li>如果当前进程正在执行 <code v-pre>bgsave</code> 操作，重写命令延迟到 <code v-pre>bgsave</code> 完成之后再执行</li>\n</ul>\n</li>\n<li>\n<p>父进程执行 <code v-pre>fork</code> 创建子进程</p>\n</li>\n<li>\n<p>重写过程：</p>\n<ul>\n<li>主进程 <code v-pre>fork</code> 之后，继续响应其他命令。所有修改操作写入 <code v-pre>AOF</code> 缓冲区，并根据 <code v-pre>appendfsync</code> 策略同步到硬盘，保证旧 <code v-pre>AOF</code> 文件机制正确</li>\n<li>子进程只有 <code v-pre>fork</code> 之前的所有内存信息，父进程中需要将 <code v-pre>fork</code> 之后这段时间的修改操作写入 <code v-pre>AOF</code> 重写缓冲区中</li>\n</ul>\n</li>\n<li>\n<p>子进程根据内存快照，将命令合并到新的 <code v-pre>AOF</code> 文件中</p>\n</li>\n<li>\n<p>子进程完成重写：</p>\n<ul>\n<li>新文件写入后，子进程发送信号给父进程</li>\n<li>父进程把 <code v-pre>AOF</code> 重写缓冲区内临时保存的命令追加到新 <code v-pre>AOF</code> 文件中</li>\n<li>用新 <code v-pre>AOF</code> 文件替换旧 <code v-pre>AOF</code> 文件</li>\n</ul>\n</li>\n</ol>\n<h5 id=\"_3-7-2-4-aof-的优势劣势\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-4-aof-的优势劣势\"><span>3.7.2.4.AOF 的优势劣势</span></a></h5>\n<ul>\n<li>\n<p>优势：</p>\n<ul>\n<li><strong>数据更精确</strong>：<code v-pre>AOF</code> 会记录每个写命令，可以达到更高的数据持久化精度。例如，假设 <code v-pre>Redis</code> 崩溃了，你可能丢失不到几秒钟的数据（这取决于 <code v-pre>appendfsync</code> 策略）。</li>\n<li><strong>持久化策略灵活</strong>：<code v-pre>AOF</code> 提供三种同步策略 (<code v-pre>always</code>, <code v-pre>everysec</code>, <code v-pre>no</code>)，可以根据需求在持久化精度和性能之间做平衡。</li>\n<li><strong>支持持久化恢复</strong>：<code v-pre>AOF</code> 文件可以通过重放命令恢复数据，保证数据一致性。</li>\n</ul>\n</li>\n<li>\n<p>劣势：</p>\n<ul>\n<li>\n<p><strong>文件较大</strong>：由于每个写命令都被记录，<code v-pre>AOF</code> 文件的大小可能会比 <code v-pre>RDB</code> 大很多。</p>\n</li>\n<li>\n<p><strong>性能开销</strong>：<code v-pre>AOF</code> 会增加额外的写入操作，尤其是 <code v-pre>appendfsync always</code> 策略会频繁同步磁盘，导致性能下降。</p>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 两种方案的使用</p>\n<ul>\n<li><code v-pre>RDB</code> 高性能，底持久，磁盘多容量，慢速度</li>\n<li><code v-pre>AOF</code> 低性能，高持久，磁盘少容量，快速度</li>\n</ul>\n</div>\n<h3 id=\"_3-8-业务操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-业务操作\"><span>3.8.业务操作</span></a></h3>\n<h4 id=\"_3-8-1-事务\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-1-事务\"><span>3.8.1.事务</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合原子执行多个操作，只能单次启动。</p>\n</div>\n<p>由于 <code v-pre>Redis</code> 的实现是单线程的，对比 <code v-pre>MySQL</code> 来说，<code v-pre>Redis</code> 事务要简单很多。</p>\n<ul>\n<li>弱化的原子性：虽然也是把一系列操作绑定为一组，但是操作失败时，无法回滚，因此原子性比较弱。</li>\n<li>不保证一致性：<span style=\"text-emphasis:filled red;\">这点待补充...</span></li>\n<li>不需要隔离性：<code v-pre>MySQL</code> 需要给多个同时执行的事务设置隔离性，但是由于 <code v-pre>Redis</code> 是单线程的，这导致 <code v-pre>Redis</code> 无需设置隔离性，只要保证自己的每条操作都是原子的即可。</li>\n<li>不需要持久性：这不代表 <code v-pre>Redis</code> 不需要做持久化，或没有持久化功能，而是 <code v-pre>Redis</code> 的事务不需要自己考虑持久化的问题，这个问题交给 <code v-pre>redis-server</code> 自己的 <code v-pre>RDB/AOF</code> 持久化机制。</li>\n</ul>\n<p>总结来看仅仅是打包了一组指令，避免被其他客户端 <strong>加塞</strong> 而已。</p>\n<p><code v-pre>Redis</code> 事务其实是在服务器上搞了一个 <strong>事务队列</strong>. 每次客户端在事务中进行一个操作, 都会把命令先发给服务器, 放到事务队列中（但并不会立刻执行），而是会在真正收到 <code v-pre>EXEC</code> 命令之后, 才真正执行队列中的所有操作。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 操作一个简单的事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开启事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MULTI</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 执行指令(其实还没执行)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 表示命令已加入事务队列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k3</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完成事务(提醒可以执行)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EXEC</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 也可以使用 DISCARD 放弃事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>不过在对同一个键的操作上，并且客户端开始编写事务的情况下，其他客户端先提交事务（或者直接执行指令时），还是会出现一些问题，这个时候会使用 <code v-pre>watch/unwatch</code> 来监控键值的版本号（就是一个整数而已），版本号冲突就立刻停止执行。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 假设两个客户端几乎同时开始编写事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 1 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 开始监视键 k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">watch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 开始事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MULTI</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 将修改 k1 和 k2 作为事务的一部分, 但尚未执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 此时 k1 的版本号为 0, 记录该版本号, 操作被排队, 但没有提交</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k2 的修改操作也被加入队列, 尚未执行</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 尚未执行 EXEC, 事务仍在队列中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 2 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 2 执行修改 k1 操作, 修改 k1 的值, 并将其版本号更改为 1(相当于提前提交了只有一条指令的事务)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 200</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 客户端 2 成功修改了 k1 的值, 服务器上的版本号变为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 1 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 执行 EXEC, 提交事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EXEC</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 由于版本号不一致, 事务被取消, 未执行任何命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查 k1 的最终值, 应该是客户端 2 提交的修改</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"200\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k1 的最终值是 200, 表明客户端 2 修改成功</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查 k2 的最终值, 因为客户端 1 的事务没有成功提交, 所以 k2 未被设置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k2 并没有被修改, 返回 nil</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-8-2-脚本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-2-脚本\"><span>3.8.2.脚本</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合原子执行多个操作，可以复用启动。</p>\n</div>\n<p><code v-pre>Redis</code> 支持执行 <code v-pre>Lua</code> 脚本，关于 <code v-pre>Lua</code>，您可以可以 <a href=\"https://www.lua.org/\" target=\"_blank\" rel=\"noopener noreferrer\">前往 Lua 官网查看大概的情况</a>，使用 <code v-pre>Lua</code> 的原因主要是</p>\n<ul>\n<li>为了将多个操作封装为原子操作，确保操作原子执行</li>\n<li>支持脚本缓存，可以减少因为数据传输引起的网络开销</li>\n<li><code v-pre>Lua</code> 本身也支持一些复杂的数据操作能力，避开 <code v-pre>Redis</code> 内部只有简单计算的缺点，也不必传递给客户端（对于 <code v-pre>Redis</code> 服务端来说客户端）浪费计算时间的问题再进行计算</li>\n<li>对于较多的 <code v-pre>Redis</code> 操作，可以直接使用 <code v-pre>Lua</code> 脚本优化操作，由于 <code v-pre>Redis</code> 对 <code v-pre>Lua</code> 脚本做过优化，可以原生执行 <code v-pre>Redis</code> 的代码</li>\n</ul>\n<p>怎么抉择什么时候使用 <code v-pre>Lua</code> 和 <code v-pre>Cpp</code> 呢？</p>\n<ul>\n<li>需要事务原子操作时</li>\n<li>需要减少网络开销时</li>\n<li>重复执行相同操作时</li>\n<li>避免在客户端计算时（对于 <code v-pre>Redis</code> 的客户端）</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 Redis 的 Lua 脚本缓存机制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SCRIPT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LOAD</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return ARGV[1] + ARGV[2]</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"53c370cb7894e73f9aaf94627c0506c428b5cc97\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EVALSHA</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 53c370cb7894e73f9aaf94627c0506c428b5cc97</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 5</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-8-3-管道\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-3-管道\"><span>3.8.3.管道</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合本地执行多个操作，通常由库实现</p>\n</div>\n<p><code v-pre>Pipeline</code> 用来：</p>\n<ul>\n<li><strong>发送多个 Redis 命令</strong> <code v-pre>Redis</code> 客户端会将多个命令批量发送到服务器，而不是逐条发送</li>\n<li><strong>读取所有命令的结果</strong> 客户端一次性读取所有响应，减少网络往返时间</li>\n</ul>\n<p>实际上<code v-pre>Redis</code> 本身没有管道的相关操作，但是对于大部分的客户端是有实现管道操作的，让多条指令能一次性发送到 <code v-pre>Redis</code> 中，保证多条指令的执行结果如同在 <code v-pre>redis-cli</code> 中是一样的（因此就理解为和在 <code v-pre>Redis</code> 服务器命令行本地中输入执行多条命令是一样的就可以）。</p>\n<p>但是需要强调的是，管道不是原子的，完全只是为了压缩多条指令带来的多个 <code v-pre>RTT(往返时间)</code> 而已，把多个指令请求合并，减少网络开支。</p>\n<h3 id=\"_3-9-通信协议\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-9-通信协议\"><span>3.9.通信协议</span></a></h3>\n<p>待补充...</p>\n<h3 id=\"_3-10-第三方库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-第三方库\"><span>3.10.第三方库</span></a></h3>\n<h4 id=\"_3-10-1-cpp-客户端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-cpp-客户端\"><span>3.10.1.Cpp 客户端</span></a></h4>\n<h5 id=\"_3-10-1-1-redispp-的安装\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-1-redispp-的安装\"><span>3.10.1.1.Redispp 的安装</span></a></h5>\n<p>这里使用 <a href=\"https://github.com/sewenew/redis-plus-plus\" target=\"_blank\" rel=\"noopener noreferrer\">redis-plus-plus 库</a> 来操作 <code v-pre>Redis</code> 的使用，<code v-pre>redis-plus-plus</code> 是基于 <code v-pre>C</code>语 言实现的 <code v-pre>hiredis</code>实现的，先使用 <code v-pre>sudo apt install libhiredis-dev</code>快速安装 <code v-pre>Redis</code> 开发工具，然后 <code v-pre>git clone https://github.com/sewenew/redis-plus-plus.git</code> 克隆该库进行安装。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 编译和安装</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装开发工具包</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> libhiredis-dev</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 克隆源代码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> git</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> clone</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://github.com/sewenew/redis-plus-plus.git</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 编译源代码, 然后进行安装</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-plus-plus</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mkdir</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> cmake</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ..</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> make</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> make</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>接下来请您直接 <a href=\"https://github.com/sewenew/redis-plus-plus/tree/master?tab=readme-ov-file#api-reference\" target=\"_blank\" rel=\"noopener noreferrer\">查看官方文档 API 文档</a> 来学习使用 <code v-pre>Redispp</code>，官方文档写得非常详细。</p>\n<h5 id=\"_3-10-1-2-redispp-的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-2-redispp-的使用\"><span>3.10.1.2.Redispp 的使用</span></a></h5>\n<p>这里结合官方文档简单快速的编写程序来做实验。</p>\n<div class=\"language-cpp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cpp\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// main.cpp</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sw/redis++/redis++.h</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">using</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> namespace</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sw</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    try</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 链接 Redis 实例 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> redis </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">tcp://127.0.0.1:6379</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 单前数据库清空操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">flushdb</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === String 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">del</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 可以提前删除不需要的键</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 设置键值对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> val </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 获取键值对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">expire</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">chrono</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">seconds</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">20</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 设置过期时间(以秒为单位)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // redis.pexpire(\"string\", std::chrono::milliseconds(20000));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 20 秒</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === List 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vec </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">aaa</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bbb</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ccc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">abc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bac</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">cab</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lrange</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Set 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_set</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> set </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">smembers</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sismember</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1 exists</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1 not exists</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Zset 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_map</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> scores </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> scores</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> scores</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 获取带分数的有序集合结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double>></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                UnboundedInterval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;double></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">{}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset_result (with scores):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 获取不带分数的有序集合结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                BoundedInterval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">>(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> BoundType</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">CLOSED</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">),</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意 BoundType::CLOSED 表示闭区间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">without_score (no scores):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double>></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                BoundedInterval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">>(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> BoundType</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OPEN</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">),</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意 BoundType::LEFT_OPEN 表示开区间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">with_score (open interval):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Hash 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">make_pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意这里做了更新操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_map</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> m </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hmset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hgetall</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 打印结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 也可以只获取到值而去除字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hmget</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 脚本操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这个脚本非常简单, 它仅返回 1, 并没有与 Redis 数据库进行任何交互</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> num </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">eval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return 1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> num </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这段代码执行一个简单的 Lua 脚本 return 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // eval&#x3C;long long> 表示将脚本的返回值转换为 long long 类型</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 脚本返回 1, 即返回一个数字 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // {} 表示没有键(KEYS), {} 表示没有传入参数(ARGV)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 该脚本将返回两个元素 1 和 2, 并将其作为字符串存储在 nums 向量中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">eval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return {ARGV[1], ARGV[2]}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这段代码执行 Lua 脚本 \"return {ARGV[1], ARGV[2]}\", 该脚本返回一个包含 ARGV[1] 和 ARGV[2] 两个元素的数组</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // ARGV[1] 和 ARGV[2] 分别对应传入的 {\"1\", \"2\"} 参数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 通过 std::back_inserter(nums) 将返回的结果插入到 nums 向量中</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 脚本操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hash_val </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">script_load</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return ARGV[1] + ARGV[2]</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hash_val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">evalsha</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">hash_val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 执行复杂脚本并且查看过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mset_with_ttl_script </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> R\"(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            local len = #KEYS</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            if (len == 0 or len + 1 ~= #ARGV) then return 0 end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            local ttl = tonumber(ARGV[len + 1])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            if (not ttl or ttl &#x3C;= 0) then return 0 end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            for i = 1, len do redis.call(\"SET\", KEYS[i], ARGV[i], \"EX\", ttl) end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            return 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">        )\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> keys </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> args </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">60</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">eval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mset_with_ttl_script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> args</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> args</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        sleep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 故意等 5 秒后再打印过期时间</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl0 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl1 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl2 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl3 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 使用管道来本地操作多条指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> pipe </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pipeline</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> pipe_replies </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-value</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rename</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">new-my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">b</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">c</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lrange</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">exec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> set_cmd_result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;bool></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第一条命令结果(布尔)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> get_cmd_result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第二条命令结果(字符)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;void></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第三条命令结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第四条命令结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SET command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set_cmd_result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">?</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Success</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> :</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Failure</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">has_value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">())</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">GET command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_cmd_result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">GET command result: Key not found</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">RENAME command result: Success (no return value)</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">LRANGE command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 事物操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tx </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">transaction</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tx_replies </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">incr</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">incr</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mget</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">{</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">exec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 提交事物</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_0 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_1 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 使用 OptionalString 的目的是避免空值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr_result_0: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_0 </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr_result_1: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_1 </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 原生执行 Redis 指令 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 可以使用多个参数执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> get_name </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">command</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CLIENT</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SETNAME</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-redis-cli</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 大小写均可</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        get_name </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">command</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">client</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getname</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_name </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">command</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sort</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">alpha</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">desc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // ALPHA 是指按照字母排序, desc 是逆向排序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sorted_list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 也可以使用初始化列表参数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sort_cmd_str </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sort</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ALPHA</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">command</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">sort_cmd_str</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> sort_cmd_str</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 集群控制 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 如果您运行了多个 Redis 实例, 就可以利用多个实例的创建, 快速管理另外一个 Redis 实例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> redis_cluster </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> RedisCluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">tcp://127.0.0.1:7000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis_cluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 因此对于这个新实例来说, 也是相同的操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> value </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis_cluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> catch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Error </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">e</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Error: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> e</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">what</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>当然，您可以继续查阅文档，官方也有提供 <code v-pre>Doxygen</code> 注释，您可以尝试生成一份来阅读。</p>\n<p>还有一些其他 <code v-pre>API</code> 细节，这里简单概览一下文档支持的大部分功能，就不做详细的解读了...</p>\n<ul>\n<li>连接</li>\n<li>发送指令</li>\n<li>异常</li>\n<li>通用命令界面</li>\n<li>发布订阅</li>\n<li>管道</li>\n<li>事物</li>\n<li>集群</li>\n<li>哨兵</li>\n<li>流</li>\n<li>模块</li>\n<li>异步接口</li>\n<li>协程接口</li>\n</ul>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>警告：部分后续提及，少部分功能未完全实现。</p>\n</div>\n<h4 id=\"_3-10-2-java-客户端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-2-java-客户端\"><span>3.10.2.Java 客户端</span></a></h4>\n<p><code v-pre>Spring boot</code> 可以集成 <code v-pre>Redis</code> 进行使用（内置 <code v-pre>Jedis</code>），待补充...</p>\n<h2 id=\"_4-组件深入\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-组件深入\"><span>4.组件深入</span></a></h2>\n<h2 id=\"_5-组件原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-组件原理\"><span>5.组件原理</span></a></h2>\n","env":{"base":"/","filePath":"/home/ljp/git/work/work-blog-website/work-blog-website-frontend/docs/4.业务服务/3.缓存服务/001_2024_08_11_ljp_redis.md","filePathRelative":"4.业务服务/3.缓存服务/001_2024_08_11_ljp_redis.md","frontmatter":{"createTime":"2025/04/20 19:12:28","permalink":"/4.业务服务/lg10ccmy/","title":"快速入门"},"sfcBlocks":{"template":{"type":"template","content":"<template><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：</p>\n<p>接下来，可以 <a href=\"https://redis.io/docs/latest/get-started/\" target=\"_blank\" rel=\"noopener noreferrer\">根据 Redis 官方的快速学习手册进行学习</a>：</p>\n<ul>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/data-store/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为内存中数据类型存储快速入门</a>，并且还需要 <a href=\"https://redis.io/docs/latest/develop/data-types/\" target=\"_blank\" rel=\"noopener noreferrer\">阅读 Redis 中的数据类型</a>，每一个数据类型都可以有对应的文档</li>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/document-database/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为文档数据库快速入门</a>（但是必须额外下载 <code v-pre>Redis Stack</code>）</li>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/vector-database/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为矢量数据库快速入门</a>（但是必须额外下载 <code v-pre>Redis Stack</code>，并且您必须学习过机器学习）</li>\n</ul>\n<p>这几个文档还是非常简单易读的，非常推荐（和本系列一起阅读更佳）。</p>\n<p>如果觉得文档太难看懂，可以看看 <a href=\"https://www.bilibili.com/video/BV1UnY5ehE4b?vd_source=c92c89dbfcf9cc30c48086469621f35b&amp;spm_id_from=333.788.videopod.episodes\" target=\"_blank\" rel=\"noopener noreferrer\">别人搬运的尚硅谷 Redis 教程(非正版...)</a>。</p>\n</div>\n<h2 id=\"_1-组件简介\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-组件简介\"><span>1.组件简介</span></a></h2>\n<p><code v-pre>Redis</code> 是一种开源的内存数据库，用于存储数据结构，例如字符串、哈希表、列表、集合、有序集合等。它被设计为快速、灵活，并支持多种数据结构的操作。<code v-pre>Redis</code> 通常用作缓存、消息代理、会话存储等用途。它支持多种编程语言，并有许多客户端库可供开发者使用。Redis 也有持久化选项，可以将数据保存到磁盘上，以便在重启时恢复数据。</p>\n<p><code v-pre>Redis</code> 所有数据都是存放在内存中的，把数据放在内存中是 <code v-pre>Redis</code> 速度快的最主要原因。另外 <code v-pre>Redis</code> 是 ⽤ <code v-pre>C</code> 语 ⾔ 实现的，⼀ 般来说 <code v-pre>C</code> 语 ⾔ 实现的最终程序会更快。另外 <code v-pre>Redis</code> 一开始采用的是单线程，预防了多线程可能产 ⽣ 的竞争问题。不够后面的 <code v-pre>Redis</code> 在 <code v-pre>6.0</code> 版本引 ⼊ 了多线程机制，但主要也是在处理 ⽹ 络和 <code v-pre>IO</code>，不涉及到数据命令，即命令的执行仍然采 ⽤ 了单线程模式。</p>\n<p>从网络角度上，<code v-pre>Redis</code> 还使用了 <code v-pre>IO</code> 多路复用的方式，实际上就是 <code v-pre>ET</code> 模式的 <code v-pre>epoll</code>（<code v-pre>Redis</code> 的核心任务主要是操作内存的数据结构，不会吃很多的 <code v-pre>CPU</code> 资源）。</p>\n<p>另外，<code v-pre>Redis</code> 的很多核心功能都是比较简单的逻辑，简单逻辑就代表简单执行，就会非常快速。</p>\n<p><code v-pre>Redis</code> 相对于传统的关系型数据库（如 <code v-pre>MySQL</code>）或自定义内存中的变量有一些优势，这些优势可能导致选择 <code v-pre>Redis</code>：</p>\n<ol>\n<li>\n<p><strong>性能快速</strong>：这里的性能快速是和 <code v-pre>MySQL</code> 进行对比。</p>\n<p>(1)<code v-pre>Redis</code> 是一个基于内存的数据库，因此读写速度非常快，适合需要快速响应的应用场景，如缓存系统或计数器（因此常常是 <code v-pre>MySQL</code> 的一个替代方案，但是存储容量没有 <code v-pre>MySQL</code> 多，不过有一种方案就是两者同时结合使用，热点数据使用 <code v-pre>Redis</code>，其余数据使用 <code v-pre>MySQL</code>）。</p>\n</li>\n<li>\n<p><strong>数据结构</strong>：<code v-pre>Redis</code> 支持丰富的数据结构，如字符串、哈希表、列表、集合、有序集合、<code v-pre>GEO(地理信息定位)</code>...，这使得它可以更灵活地存储和操作数据，而不仅仅局限于关系型数据库的表结构（和 <code v-pre>MySQL</code> 关系数据库不同，<code v-pre>Redis</code> 是基于键值对来组织数据的，是一种典型的非关系型数据库）。</p>\n</li>\n<li>\n<p><strong>可编程的</strong>：可以使用命令行操作 <code v-pre>Redis</code>，也可以使用编程语言脚本的方式批量执行一些操作（主要使用 <code v-pre>Lua</code>，也是一种较火的语言）。</p>\n</li>\n<li>\n<p><strong>可拓展性</strong>：可以使用 <code v-pre>C/C++、Rust</code> 来为 <code v-pre>Redis</code> 功能做拓展（本质是安装动态链接库，类似 <code v-pre>.so/.dll</code> 等），例如支持更多数据结构和更多交互命令。</p>\n</li>\n<li>\n<p><strong>持久化数据</strong>：虽然 <code v-pre>Redis</code> 是基于内存的，但它提供了持久化选项，可以将数据定期写入磁盘，确保数据不会因为系统崩溃而丢失。并且也有两种持久化方案，<code v-pre>RDB</code> 和 <code v-pre>AOF</code>，前者是基于快照数据的持久化，后者是基于日志数据的持久化。</p>\n</li>\n<li>\n<p><strong>水平拓展</strong>：<code v-pre>Redis</code> 支持主从复制和集群模式，可以在多个主机部署多个节点。</p>\n</li>\n<li>\n<p><strong>高可用性</strong>：多个节点上可以复制数据（备份/冗余），提高系统的可用性和容错能力，从节点就相当于主节点的备份。</p>\n</li>\n<li>\n<p><strong>原子操作</strong>：<code v-pre>Redis</code> 支持原子操作，能够保证多个操作的原子性，避免了多线程或多进程并发操作数据时可能出现的竞态条件。</p>\n</li>\n<li>\n<p><strong>客户端语言多</strong>：客户端可以支持的语言非常多，包括但不限于 <code v-pre>Cpp, Java, Python, Node.js...</code>，使用起来非常简单。</p>\n</li>\n<li>\n<p><strong>主从复制功能</strong>：提供了复制功能，实现了多个相同数据的 <code v-pre>Redis</code> 副本。</p>\n</li>\n<li>\n<p><strong>高可用</strong>：提供了哨兵机制，保证 <code v-pre>Redis</code> 的故障发现和故障自动转移。</p>\n</li>\n</ol>\n<p>总的来说，<code v-pre>Redis</code> 适用于需要高性能、低延迟、丰富数据结构和高可用性的应用场景，如缓存、实时数据分析、会话存储等。虽然在某些情况下使用传统的关系型数据库或自定义内存变量也可以实现类似的功能，但 <code v-pre>Redis</code> 提供了更好的性能和更丰富的功能。</p>\n<p>进程间通信，如果是单机，就需要通过管道或者共享内存等机制来传递数据。而如果涉及到多台主机，就会涉及到网络通信。而 <code v-pre>Redis</code> 就是基于网络把内存中数据交给别的进程甚至是其他主机中进程来使用，并且一般是基于分布式系统的。</p>\n<p><code v-pre>Redis</code> 经常会被作为：</p>\n<ul>\n<li>\n<p>存储数据的非关系实时数据库（具有更低的存储和更高的效率）</p>\n</li>\n<li>\n<p>使用 <code v-pre>session</code> 配合 <code v-pre>cookie</code> 实现会话管理...</p>\n</li>\n<li>\n<p>消息队列消息中间件（这里不是进程通信中的消息队列），是网络中的生产者消费者模型（知名的消息队列就有 <code v-pre>RabbitMQ、Kafka、RocketMQ</code> 等，不过 <code v-pre>Redis</code> 的不常使用，多是顺带方便才使用）</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 一开始是作为消息中间件（消息队列）的一个生产者-消费者模型解决方案，但是这种类似的解决方案已经有更优的方案了。</p>\n</div>\n</li>\n</ul>\n<p>但是也不是没有缺点的，比如在数据量大的场景中无法使用，受限于内存空间存储空间不大等。</p>\n<h2 id=\"_2-组件部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-组件部署\"><span>2.组件部署</span></a></h2>\n<p><a href=\"https://redis.io/docs/latest/operate/oss_and_stack/install/install-stack/apt/\" target=\"_blank\" rel=\"noopener noreferrer\">依照 Redis 官方文档即可下载 Redis</a>。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> lsb-release</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 以下指令可能过时, 推荐您看官方文档</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -fsSL</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/gpg</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --dearmor</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 644</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> echo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">$(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lsb_release</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -cs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tee</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/apt/sources.list.d/redis.list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>Redis</code> 也有经典的 <code v-pre>CS</code> 模式，因此需要启动服务。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 启动 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> enable</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-server</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> start</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-server</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>测试是否安装成功。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 测试 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>6379</code> 是 <code v-pre>Redis</code> 默认的服务端程序运行端口号。</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 官方其实是不推荐在 <code v-pre>Windows</code> 下使用 <code v-pre>Redis</code> 的，但是我们有些时候会在 <code v-pre>Windows</code> 下进行测试，因此就可以尝试在 <a href=\"https://github.com/MicrosoftArchive/redis/releases\" target=\"_blank\" rel=\"noopener noreferrer\">这个页面下安装 Redis</a>，对于简单的测试已经足够了。</p>\n</div>\n<h2 id=\"_3-组件基础\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-组件基础\"><span>3.组件基础</span></a></h2>\n<h3 id=\"_3-1-登录退出\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-1-登录退出\"><span>3.1.登录退出</span></a></h3>\n<p>登录方式和 <code v-pre>MySQL</code> 是一样的，可以在命令行使用客户端登录的方式，也可以只执行单条的命令，我们可以简单试试启动 <code v-pre>Redis</code> 的客户端。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Redis 的登录和退出</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 直接使用客户端登录并且使用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -h</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6379</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # WebSocket 协议中, PING 和 PONG 是一种心跳机制, 服务器或客户端可以发送 PING, 而接收方会响应 PONG, 以确保连接存活</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hello</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exit</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 退出 Redis</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在命令行中只执行一次 Redis 的指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -h</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6379</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>注意：<code v-pre>Redis</code> 其实在实际开发中是不会暴露给外界访问的，我们这里只不过是为了方便把配置文件改为 <code v-pre>0.0.0.0</code>，如果您只在本机操作 <code v-pre>redis</code> 则默认使用的是 <code v-pre>127.0.0.1</code> 地址，并且默认 <code v-pre>6379</code> 端口，此时可以直接省略 <code v-pre>-h</code> 和 <code v-pre>-p</code> 直接登录。</p>\n</div>\n<h3 id=\"_3-2-指令教程\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-指令教程\"><span>3.2.指令教程</span></a></h3>\n<p>我们先再来学几个指令尝尝鲜，这些指令在后面用到的概率也非常高，另外 <code v-pre>Redis</code> 的指令也可以无视对大小写。</p>\n<h4 id=\"_3-2-1-基础指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-基础指令\"><span>3.2.1.基础指令</span></a></h4>\n<h5 id=\"_3-2-1-1-set-get-del\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-1-set-get-del\"><span>3.2.1.1.SET, GET, DEL</span></a></h5>\n<p><code v-pre>set, get, del</code> 这三个指令非常简单，就是设置（修改）、获取、删除键值对。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 set, get, del</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">del</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：实际上还有更加方便可用的变种指令</p>\n<ul>\n<li><code v-pre>setex &lt;key_name&gt; &lt;seconds&gt; &lt;key_value&gt;</code> 可以直接使用秒作为单位设置 <code v-pre>key</code> 的过期时间</li>\n<li><code v-pre>setpx &lt;key_name&gt; &lt;milliseconds&gt; &lt;key_value&gt;</code> 可以直接使用毫秒作为单位设置 <code v-pre>key</code> 的过期时间</li>\n<li><code v-pre>setnx &lt;key_name&gt; &lt;key_value&gt;</code> 只在 <code v-pre>key</code> 不存在时才进行设置，即如果 <code v-pre>key</code> 之前已经存在，不执行设置</li>\n<li><code v-pre>setxx &lt;key_name&gt; &lt;key_value&gt;</code> 只在 <code v-pre>key</code> 存在时才进行设置，即如果 <code v-pre>key</code> 之前不存在，不执行设置</li>\n<li><code v-pre>mset &lt;key_name_1&gt; &lt;key_value_1&gt; &lt;key_name_2&gt; &lt;key_value_2&gt; ...</code> 一次设置多个键值对</li>\n<li><code v-pre>mget key_name_1 key_name_2</code> 一次获取多个键值</li>\n<li>另外 <code v-pre>del</code> 本身就支持删除多个键值对...</li>\n</ul>\n<p>这种一次性设置的指令通常会更受欢迎，因为可以减缓一些网络 <code v-pre>IO</code> 的代价。</p>\n</div>\n<h5 id=\"_3-2-1-2-keys-exists-scan\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-2-keys-exists-scan\"><span>3.2.1.2.KEYS, EXISTS, SCAN</span></a></h5>\n<p><code v-pre>keys</code> 指令可以根据一定的样式，或者匹配模式来查询对应的 <code v-pre>key</code> 值，查询的复杂度是 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>，而 <code v-pre>exists</code> 则可以查询 <code v-pre>key</code> 存在的个数，时间复杂度是 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 keys, exists</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 这个是 set 的升级版, 可以一次设置多个 key-value 对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询所有 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_?</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_2 key_y 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 k2ey key_2 kkkkey key_1 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[13]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_3 这两个 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[^1]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询除了 key_1 以外的所有 key_2 key_w key_0 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[0-3]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_2 key_3 这三个 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找符合 key_1 的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_2</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找符合 key_1, key_2 的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>keys</code> 的时间复杂度比较大，一般在实际工程中会直接禁用这个命令，否者一旦 <code v-pre>Redis</code> 在有大量的指令时，就会出现“卡住”的情况，这和 <code v-pre>Redis</code> 的架构设计本身是有关系的，后面再说...</p>\n</div>\n<p>还有一个比较高效的增量扫描 <code v-pre>scan</code> 指令，放回的数据是分批量的，即便是在单线程的情况下，也可以非阻塞返回大规模数据集，不会对 <code v-pre>Redis</code> 有很大的性能影响。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 scan</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> match</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> ## 0 代表游标, 是扫描的起始位置, 表示从当前 Redis 键空间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> ## 这里是因为数据量不大, 直接返回新的游标为 0 表示扫描完成, 如果数据量大会得到新的游标</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>可以看到 <code v-pre>keys</code> 是扫描整个键值空间，但是 <code v-pre>scan</code> 可以由用户指定游标进行增量扫描。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 也是有关于数据库的概念的，也就是 <code v-pre>Redis</code> 键空间。</p>\n</div>\n<h5 id=\"_3-2-1-3-expire-ttl\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-3-expire-ttl\"><span>3.2.1.3.EXPIRE, TTL</span></a></h5>\n<p><code v-pre>expire</code> 为指定的 <code v-pre>key</code> 值添加秒级的过期时间，返回 <code v-pre>1</code> 表示设置成功，返回 <code v-pre>0</code> 表示设置失败，并且可以对同一个 <code v-pre>key</code> 值反复使用达到修改过期时间的目的。而 <code v-pre> TTL</code> 则可以获取指定 <code v-pre>key</code> 值的过去时间，单位也是秒级，其返回值为 <code v-pre>任意数字</code> 表示距离过期时间所剩的秒数，<code v-pre>-1</code> 表示没有关联过期时间，<code v-pre>-2</code> 表示 <code v-pre>key</code> 不存在。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 expire, ttl</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置 key 的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 每一秒获取一次</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看已经不存在的 key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 重新设置一个 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> other_key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 再设置另外一个 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 为第一个 key 设置过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第一个 key 剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 7</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第一个 key 剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 4</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> other_key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 试图查看另外一个没有设置过期时间的 key 的剩余过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 再次重新设置 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 正常获取</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100000</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置比较大的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 99994</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 重新设置过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 检查现在的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 9</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：实际上 <code v-pre>expire, ttl</code> 都有支持毫秒版本的 <code v-pre>pexpire, pttl</code>，使用方法类似。</p>\n</div>\n<h5 id=\"_3-2-1-4-type\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-4-type\"><span>3.2.1.4.TYPE</span></a></h5>\n<p><code v-pre>type</code> 也很简单，可以返回 <code v-pre>key</code> 值的数据类型，返回值有 <code v-pre>none, string, list, set, zset, hash, stream...</code> 其实就对应后面数据类型。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 type</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">string</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-2-1-5-incr-incrby-decr-decrby-incrbyfloar\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-5-incr-incrby-decr-decrby-incrbyfloar\"><span>3.2.1.5.INCR, INCRBY, DECR, DECRBY, INCRBYFLOAR</span></a></h5>\n<p><code v-pre>incr</code> 可以用来给一个字符串类型的实数进行 <code v-pre>+1</code> 操作，哪怕这个 <code v-pre>key</code> 值之前不存在，也会从 <code v-pre>0</code> 开始加起。<code v-pre>incrby</code> 也是类似，但是加上用户指定的整数值（注意只能是整数），不存在时，该 <code v-pre>key</code> 也是从 <code v-pre>0</code> 开始加起。而 <code v-pre>decr</code> 和 <code v-pre>decrby</code> 和前面两者类似，只不过是变成减而已。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：顺口一提上述关于 <code v-pre>...by</code> 的指令都可以使用负数作为操作数。</p>\n</div>\n<p>对于浮点数来说，只使用一个指令 <code v-pre>incrbyfloat</code> 就够了，功能也是类似的，加减使用正负实数调控就行。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 incr, incrby, decr, decrby, incrbyfloat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incr</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 4</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"4\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incrby</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrby</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 9</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># decr</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">decr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 8</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># decrby</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">decrby</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incrbyfloat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrbyfloat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5.6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"9.6\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrbyfloat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -3.10.33</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"-0.73\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-2-1-6-append-getrange-setrange-strlen\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-6-append-getrange-setrange-strlen\"><span>3.2.1.6.APPEND, GETRANGE, SETRANGE, STRLEN</span></a></h5>\n<p>还可以对字符串进行操作，这些也比较简单...</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 append, getrange, setrange, strlen</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置初始字符串值到键 mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ok</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取键 mykey 的值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">append</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> world</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 向 mykey 键追加字符串 \" world\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取追加后的 mykey 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello world\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 值中从索引 0 到 4 的子串</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 值中从索引 6 到 10 的子串</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"world\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">redis</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置 mykey 中从索引 6 开始的新值为 \"redis\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 setrange 操作后的 mykey 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello redis\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">strlen</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 字符串的长度</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：这些指令都很简单，如果您需要了解更多，可以 <a href=\"https://redis.io/docs/latest/develop/get-started/\" target=\"_blank\" rel=\"noopener noreferrer\">前往 Redis 的官网中查看</a>，不过由于我们使用 <code v-pre>Redis</code> 的大部分场景都是在代码中直接进行编程（除了一些运维人员、测试人员可能需要非常了解进行必要的检查以外），因此没有必要了解得特别细（除非需要使用）...</p>\n</div>\n<h4 id=\"_3-2-2-模块指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-模块指令\"><span>3.2.2.模块指令</span></a></h4>\n<p>除了基础的对于数据类型的操作指令，还有一些不同模块的指令，有需要再进行学习，不过这里先列出来：</p>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：模块默认不直接内嵌到 <code v-pre>redis service</code> 中，因此需要您下载 <code v-pre>Redis</code> 的拓展 <code v-pre>Redis Stack</code> 才能使用。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装 Redis Stack</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 停止传统的 Redis 服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> stop</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查是否停止 Redis 服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Could</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> not</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> to</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> at</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:6379:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Connection</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> refused</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">not</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> connecte</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">d</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> exit</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开始安装 Redis Stack</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> lsb-release</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -fsSL</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/gpg</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --dearmor</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 644</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> echo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">$(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lsb_release</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -cs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tee</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/apt/sources.list.d/redis.list</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 由于我使用的是 Ubuntu24.04(这个时候比较新), 因此我需要使用二进制进行下载, 而无法使用包管理安装...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在 https://redis.io/downloads/#redis-stack-downloads 底部获取你所需要的安装链接</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> wget</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/redis-stack/redis-stack-server-7.4.0-v1.jammy.x86_64.tar.gz</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mv</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server-7.4.0-v1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sh</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server/bin/redis-stack-server</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 此时就会启动输出...您可以开始测试是否已运行该服务...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 打开另外一个终端开始测试</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MODULE</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LIST</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">RedisCompat</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/rediscompat.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">redisgears_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20020</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisgears.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">v8-plugin-path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/libredisgears_v8_plugin.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">search</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 21005</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisearch.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MAXSEARCHRESULTS</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MAXAGGREGATERESULTS</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bf</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20802</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisbloom.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ReJSON</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20803</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/rejson.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">timeseries</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 11202</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redistimeseries.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 有比较多的回显就是配置成功了</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div>\n<h5 id=\"_3-2-2-1-redisearch-ft\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-1-redisearch-ft\"><span>3.2.2.1.RediSearch(<code v-pre>FT</code>)</span></a></h5>\n<p>主要用于全文搜索和数据索引功能，核心命令如：</p>\n<ul>\n<li><code v-pre>FT.CREATE</code>、<code v-pre>FT.ADD</code>、<code v-pre>FT.SEARCH</code>：创建索引、添加文档、搜索查询</li>\n<li><code v-pre>FT.AGGREGATE</code>：执行聚合查询</li>\n<li><code v-pre>FT.DROPINDEX</code>、<code v-pre>FT.SYNUPDATE</code> 等</li>\n</ul>\n<h5 id=\"_3-2-2-2-redisjson-json\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-2-redisjson-json\"><span>3.2.2.2.RedisJSON(<code v-pre>JSON</code>)</span></a></h5>\n<p><code v-pre>RedisJSON</code> 模块用于在 <code v-pre>Redis</code> 中存储和操作 <code v-pre>JSON</code> 数据类型，核心命令如：</p>\n<ul>\n<li><code v-pre>JSON.SET</code>：设置 <code v-pre>JSON</code> 数据</li>\n<li><code v-pre>JSON.GET</code>：获取 <code v-pre>JSON</code> 数据</li>\n<li><code v-pre>JSON.DEL</code>：删除 <code v-pre>JSON</code> 键</li>\n<li><code v-pre>JSON.MGET</code>：从多个键中获取 <code v-pre>JSON</code> 值</li>\n</ul>\n<h5 id=\"_3-2-2-3-redisgraph-graph\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-3-redisgraph-graph\"><span>3.2.2.3.RedisGraph(<code v-pre>GRAPH</code>)</span></a></h5>\n<p>RedisGraph 提供了图数据库功能，用于图数据的存储和查询，核心命令如：</p>\n<ul>\n<li><code v-pre>GRAPH.QUERY</code>：使用 <code v-pre>Cypher</code> 查询语言执行查询。</li>\n<li><code v-pre>GRAPH.PROFILE</code>：分析查询性能。</li>\n<li><code v-pre>GRAPH.DELETE</code>：删除图。</li>\n</ul>\n<h5 id=\"_3-2-2-4-redis-timeseries-ts\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-4-redis-timeseries-ts\"><span>3.2.2.4.Redis TimeSeries(<code v-pre>TS</code>)</span></a></h5>\n<p><code v-pre>RedisTimeSeries</code> 是用于存储和分析时间序列数据的模块，核心命令如：</p>\n<ul>\n<li><code v-pre>TS.CREATE</code>：创建时间序列</li>\n<li><code v-pre>TS.ADD</code>：添加时间序列数据点</li>\n<li><code v-pre>TS.RANGE</code>、<code v-pre>TS.MRANGE</code>：查询时间范围内的数据</li>\n<li><code v-pre>TS.ALTER</code>：修改时间序列元数据</li>\n</ul>\n<h5 id=\"_3-2-2-5-redisai-ai\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-5-redisai-ai\"><span>3.2.2.5.RedisAI(<code v-pre>AI</code>)</span></a></h5>\n<p><code v-pre>RedisAI</code> 用于在 <code v-pre>Redis</code> 中运行机器学习模型，支持 <code v-pre>TensorFlow, PyTorch, ONNX...</code> 模型，核心命令如：</p>\n<ul>\n<li><code v-pre>AI.MODELSET</code>：加载机器学习模型</li>\n<li><code v-pre>AI.MODELRUN</code>：运行机器学习模型</li>\n<li><code v-pre>AI.SCRIPTSET</code>：设置自定义脚本</li>\n<li><code v-pre>AI.TENSORSET</code> 和 <code v-pre>AI.TENSORGET</code>：处理张量数据</li>\n</ul>\n<h5 id=\"_3-2-2-6-redisbloom-bf-cf-cms-topk\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-6-redisbloom-bf-cf-cms-topk\"><span>3.2.2.6.RedisBloom(<code v-pre>BF</code>, <code v-pre>CF</code>, <code v-pre>CMS</code>, <code v-pre>TOPK</code>)</span></a></h5>\n<p><code v-pre>RedisBloom</code> 提供了<code v-pre>布隆过滤器, 计数最小堆, Cuckoo Filter, TopK...</code> 等数据类型，适合处理大数据集合。</p>\n<ul>\n<li><strong>布隆过滤器</strong> (<code v-pre>BF</code>)：<code v-pre>BF.ADD</code>、<code v-pre>BF.EXISTS</code></li>\n<li><strong>Cuckoo Filter</strong> (<code v-pre>CF</code>)：<code v-pre>CF.ADD</code>、<code v-pre>CF.EXISTS</code></li>\n<li><strong>Count-Min Sketch</strong> (<code v-pre>CMS</code>)：<code v-pre>CMS.INCRBY</code>、<code v-pre>CMS.QUERY</code></li>\n<li><strong>TopK</strong>：<code v-pre>TOPK.ADD</code>、<code v-pre>TOPK.QUERY</code></li>\n</ul>\n<p>这些模块可以根据场景进行组合使用，以增强 <code v-pre>Redis</code> 数据库的功能，从而更高效地处理搜索、图数据、时间序列分析和机器学习任务。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：由于有需要我补充这部分内容。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 RediSearch 和 RedisJSON 的相关指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">FT.CREATE</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置添加索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">idx:bicycle</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置索引名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ON</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> JSON</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 表示针对</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> JSON</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 的索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PREFIX</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 仅对具有</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 前缀的键创建索引</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">这里的数字代表可以设置多个前缀</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCORE</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 为该索引设置评分</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">用于索引之间进行评分比较</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCHEMA</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 后面定义字段的模式</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.brand</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> brand</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.model </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> model</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.description </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> description</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.price </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> price</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> NUMERIC</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.condition </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">TAG </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SEPARATOR</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置标签, 用于分割不同 JSON 对象</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完整一行指令为 FT.CREATE idx:bicycle ON JSON PREFIX 1 bicycle: SCORE 1.0 SCHEMA $.brand AS brand TEXT WEIGHT 1.0 $.model AS model TEXT WEIGHT 1.0 $.description AS description TEXT WEIGHT 1.0 $.price AS price NUMERIC $.condition AS condition TAG SEPARATOR \",\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 上述描述的就是一个 JSON 对象的集合</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#   \"bicycle:xxx\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"brand\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"model\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"description\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"price\": 0,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"condition\": \"\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#   },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 可以使用 FT.INFO idx:bicycle 查看配置结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置 \"键名-JSON:\" 对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.SET</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 存储在根处,</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 也可以是只设置字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: 270, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\\</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">}\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完整指令为 JSON.SET \"bicycle:0\" \".\" \"{\\\"brand\\\": \\\"Velorim\\\", \\\"model\\\": \\\"Jigger\\\", \\\"price\\\": 270, \\\"description\\\": \\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\\\u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\", \\\"condition\\\": \\\"new\\\"}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 获取键对应 JSON 的某个字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.GET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.brand</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.price</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:[</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">],</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:[270]}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 更新键对应 JSON 的某个字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.SET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:1234</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $ </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">{\"price\": 600}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查卡键对应 JSON 的所有字段‘</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.GET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:270,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 不过我们使用的是 JSON.GET, 如果使用 FT.SEARCH 还能用于执行基于全文索引的搜索查询, 它结合了索引、评分、排序和过滤功能, 可以用于复杂的搜索操作...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 FT 的查询</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">FT.SEARCH</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">idx:bicycle</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LIMIT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">$</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:270,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>更多待补充...</p>\n</div>\n<h4 id=\"_3-2-3-自定指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-3-自定指令\"><span>3.2.3.自定指令</span></a></h4>\n<p>除了已有的基础指令和模块指令，还可以使用 <code v-pre>Lua</code> 脚本代码编写出用户自己定义的指令，待补充...</p>\n<h3 id=\"_3-3-数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-数据类型\"><span>3.3.数据类型</span></a></h3>\n<h4 id=\"_3-3-1-数据类型分类\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-1-数据类型分类\"><span>3.3.1.数据类型分类</span></a></h4>\n<p>知道前面的基础指令后，就可以知道 <code v-pre>Redis</code> 是一个跨语言的大号键值对存储数据库，但是除了简单的字符类型以外，键位对应的值还可以是其他数据类型，主要的数据类型有一下六种。</p>\n<ul>\n<li><strong>字符 String</strong> 最基本的数据类型，支持二进制安全的字符串</li>\n<li><strong>列表 List</strong> 按插入顺序存储的字符串列表，支持从两端推入和弹出操作</li>\n<li><strong>无权集合 Set</strong> 无序无权字符串集合，不允许重复元素</li>\n<li><strong>带权集合 Zset</strong> 有序有权字符串集合，保留集合无序不可重复的特点，但每个成员都有一个与之关联的分数（是允许重复的浮点数），并可以按分数排序</li>\n<li><strong>键值集合 Hash</strong> 键值对的集合，适用于存储对象的字段和对应的值，也可以叫哈希，这意味着键对应的值也可以是一系列键值对（有点套娃）</li>\n<li><strong>空值 None</strong> 当键值对不存在时的一种特殊类型</li>\n</ul>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：也有一些比较高级的类型，有很多是字符类型演变而来。</p>\n<ul>\n<li><strong>位图 bitmap</strong> 可以看作是一种压缩的数据类型，按位存储数据</li>\n<li><strong>地理位置 geospatial</strong> 用于存储地理位置数据并进行地理空间查询</li>\n<li><strong>流 stream</strong> 用于存储和管理日志数据、消息队列等类型的数据，流的条目按时间戳进行排序</li>\n<li><strong>基数 HyperLogLog</strong> 用于统计某个数据流中不重复元素的数量（如果您的需求是要 <strong>存储所有的元素并进行操作</strong>，那么 <code v-pre>Set</code> 是合适的选择；如果您只是需要 <strong>估算独立元素的数量</strong>，且不关心精确值，那么 <code v-pre>Hyper LogLog</code> 会更高效）</li>\n<li>...</li>\n</ul>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：流的存在，使得 <code v-pre>Redis</code> 可以简单充当一个消息队列，但是这不是 <code v-pre>Redis</code> 的主要应用场景。不过这可以作为中小型项目的消息队列组件，尤其是在已经引入 <code v-pre>Redis</code> 时，可以快速把 <code v-pre>Redis</code> 作为消息队列，减低系统复杂度。</p>\n</div>\n<h4 id=\"_3-3-2-外部数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-外部数据类型\"><span>3.3.2.外部数据类型</span></a></h4>\n<h5 id=\"_3-3-2-1-string-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-1-string-的基本操作\"><span>3.3.2.1.String 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># String</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystring</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystring</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">string</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-2-list-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-2-list-的基本操作\"><span>3.3.2.2.List 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># List</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询列表所有元素, 0 表示最先一个元素, -1 表示最后一个元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 mylist [1] 处的元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">list</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 除此以外还有阻塞版本的指令, 例如 blpop 和 brpop</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在有数据的情况下行为与 lpop 和 rpop 一致</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 但无数据的情况下 lpop 和 rpop 会立刻返回 nil, 客户端呈现请求阻塞状态, 且期间 Redis 可以继续执行其他指令, 如果超出设定的 timeout 也会返回 nil</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-3-set-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-3-set-的基本操作\"><span>3.3.2.3.Set 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Set</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">smembers</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sismember</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sismember</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 表示不存在这个元素</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">set</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Redis 除了支持增删查改的基础操作, 也支持交集(sinterstore/sinter)、并集(sunionstore/sunion)、差集(sdiffstore/sdiff)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-4-zset-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-4-zset-的基本操作\"><span>3.3.2.4.Zset 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Zset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 添加</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 添加成功个数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查询</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zcrd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # zset 的元素个数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找是否存在元素并且返回排名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zset</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 除此以外还有一些额外的选项</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [XX | NX]: 仅仅⽤于更新已经存在的元素, 不会添加新元素; 仅⽤于添加新元素，不会更新已经存在的元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [GT | LT]: Greater Than, 表示“大于”, 通常用于范围查询中, 表示取值大于某个指定的值; Less Than, 表示“小于”, 通常用于范围查询中, 表示取值小于某个指定的值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [CH]: 默认情况下, ZADD 返回的是本次添加的元素个数, 但指定这个选项之后, 就会还包含本次更新的元素的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [INCR]: 此时命令类似 ZINCRBY 的效果, 将元素的分数加上指定的分数, 此时只能指定⼀个元素和分数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 也支持集合, 并且是聚合集合</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>ZINTERSTORE</code> 是 <code v-pre>Redis</code> 的一个命令，用于对多个有序集合（<code v-pre>ZSET</code>）进行交集操作，并将结果存储到指定的目标集合中。具体来说，<code v-pre>ZINTERSTORE</code> 会计算多个有序集合的交集，并根据权重和聚合方式合并它们的分数，然后将结果保存在指定的目标集合中。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 聚合搜索</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zinterstore</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> destination</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> numkeys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [key </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">...]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [weights </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">weight</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [weight </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">...]]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [aggregate </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sum</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> min</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> max</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (1) destination: 目标集合的名称，交集的结果将存储在这个集合中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (2) numkeys: 输入的有序集合的数量(key 的数量)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (3) key [key ...]: 参与交集操作的多个有序集合的键名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (4) weights weight [weight ...]: 可选参数, 指定每个集合的权重(默认权重为 1), 如果提供了权重, Redis 会按权重计算每个集合中的元素分数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (5) aggregate &#x3C;sum | min | max>: 可选参数, 指定合并多个集合元素时如何聚合它们的分数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# sum 表示分数相加(默认)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# mim 表示取最小值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# max 表示取最大值</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div>\n<h5 id=\"_3-3-2-5-hash-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-5-hash-的基本操作\"><span>3.3.2.5.Hash 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Hash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hkeys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取哈希中的所有字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hvals</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取哈希中的所有值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hexists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field2</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 检查某个字段是否存在于哈希中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">hash</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 内部的哈希通常被称为 <code v-pre>field-value</code> 对，这主要是为了和 <code v-pre>Readis</code> 本身的 <code v-pre>key-value</code> 做区分。</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：使用 <code v-pre>HGETALL</code> 获取哈希元素个数过多时，就有可能阻塞 <code v-pre>Redis</code>，这种情况下可以使用 <code v-pre>HSCAN</code> 扫描指令。</p>\n</div>\n<h5 id=\"_3-3-2-6-none-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-6-none-的基本操作\"><span>3.3.2.6.None 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># None</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> non_existing_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">none</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-3-3-高级数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-高级数据类型\"><span>3.3.3.高级数据类型</span></a></h4>\n<p>下面补充一些高级数据类型的使用。</p>\n<h5 id=\"_3-3-3-1-bitmap\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-1-bitmap\"><span>3.3.3.1.Bitmap</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Bitmap</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置第 7 位为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置第 2 位为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第 7 位设置的比特值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第 7 位设置的比特值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bitcount</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 统计位图中总共有多少个设置为 1 的比特位</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-2-geospatial\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-2-geospatial\"><span>3.3.3.2.Geospatial</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Geospatial</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geoadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 13.361389</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 38.115556</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置一个地理位置, 这里设置了经纬度和地名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geoadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 15.087269</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 37.502669</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geopos</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询某个位置的经纬度</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">13.36138933897018433</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">38.11555639549629859</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geodist</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> km</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询两个地点之间的距离, 以 km 单位</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"166.2742\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">georadius</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 15</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 37</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> km</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询以经纬度 15, 37 为中心, 半径为 100km 的所有地名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-3-stream\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-3-stream\"><span>3.3.3.3.Stream</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Stream</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 添加流</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 添加流的指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置流的名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              *</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 代表由</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 自己生成时间戳</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 18</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 代表流存储的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358298361-0\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每条消息都有一个唯一的 ID, 这个 ID 由两部分组成, 使用 - 分隔</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 第一部分是一个时间戳(毫秒级), 表示消息被写入流的时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 第二部分是一个序列号, 用来区分同一时间戳下的不同消息(为了区分同时间戳)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358303994-0\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 20</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358311147-0\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查询流</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 0 表示从流的开始读取所有的消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358298361-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">18</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358303994-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $ </span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># $ 表示从最新的数据开始读取所有的消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358311147-0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 直接使用流 ID 查询就是读取该 ID 之后的所有消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358303994-0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358298361-0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358303994-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 这种情况下是直接消费数据的, 并且数据不会因为消费消失</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-4-hyperloglog\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-4-hyperloglog\"><span>3.3.3.4.HyperLogLog</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># HyperLogLog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">PFADD</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ip_set</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 这个是重复的</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> IP</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 地址</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                \"192.168.0.4\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.5</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 完整指令为 PFADD ip_set \"192.168.0.1\" \"192.168.0.2\" \"192.168.0.3\" \"192.168.0.1\" \"192.168.0.4\" \"192.168.0.5\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">PFCOUNT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ip_set</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 5</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：不知道您有没有发现很相当大的一部分数据类型是由 <code v-pre>string</code> 这个类型衍生出来的，因此如果需要细学其他的类型，就必须先对 <code v-pre>string</code> 有足够的理解，首先您至少需要知道几件事：</p>\n<ul>\n<li>\n<p>所有的键名类型都是字符类型</p>\n</li>\n<li>\n<p>字符串类型的键值可以单纯是（但是一个字符串的最大值不能是 <code v-pre>512MB</code>）：</p>\n<ul>\n<li>字符串</li>\n<li>一般格式的 <code v-pre>JSON</code></li>\n<li>一般格式的 <code v-pre>XML</code></li>\n<li>数字</li>\n<li>二进制流</li>\n</ul>\n</li>\n<li>\n<p><code v-pre>Redis</code> 内部存储的字符串是完全按照二进制流的形式保存的，所以不需要处理字符集编码，客户端传入的是什么字符集就存储什么</p>\n</li>\n</ul>\n</div>\n<h4 id=\"_3-3-4-内部数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-内部数据类型\"><span>3.3.4.内部数据类型</span></a></h4>\n<p>实际上 <code v-pre>Redis</code> 针对每一种数据类型都有自己的底层内部编码实现，而且是多种实现，这样 <code v-pre>Redis</code> 就会根据合适的场景选择合适的内部编码，例如下表（除去空类型剩下的五个类型）。</p>\n<table>\n<thead>\n<tr>\n<th><strong>数据类型</strong></th>\n<th><strong>内部编码</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>String</td>\n<td><code v-pre>raw(&gt;=39byte), int(8 byte), embstr(&lt;=39byte)</code></td>\n</tr>\n<tr>\n<td>List</td>\n<td><code v-pre>linkedlist, ziplist</code></td>\n</tr>\n<tr>\n<td>Set</td>\n<td><code v-pre>hashtable, intset</code></td>\n</tr>\n<tr>\n<td>Zset</td>\n<td><code v-pre>skiplist, ziplist</code></td>\n</tr>\n<tr>\n<td>Hash</td>\n<td><code v-pre>hashtable, ziplist</code></td>\n</tr>\n</tbody>\n</table>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：我们可以通过 <code v-pre>object encoding 键名</code> 查询此时键的内部编码。</p>\n</div>\n<p><code v-pre>Redis</code> 这样设计有两个好处：</p>\n<ul>\n<li>方便 <code v-pre>Redis</code> 未来改进内部编码，而对外的数据类型和命令没有任何影响，这样可以开发出更优秀的内部编码</li>\n<li>多种内部编码实现可以在不同场景下发挥各自的优势，例如 <code v-pre>ziplist</code> 比较节省内存，但是在列表元素比较较多的情况下，性能会下降，这时候 <code v-pre>Redis</code> 会根据配置选项将列表类型的内部实现转换为 <code v-pre>linkedlist</code>，整个过程用户是全无感知的</li>\n</ul>\n<h5 id=\"_3-3-4-1-string-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-1-string-的内部编码\"><span>3.3.4.1.String 的内部编码</span></a></h5>\n<p>尤其是字符串类型，内部编码至少有三种，<code v-pre>Redis</code> 会自动根据当前的值来决定使用哪一种内部编码进行实现。</p>\n<ul>\n<li>\n<p><strong>int(8byte 的长整型)</strong></p>\n</li>\n<li>\n<p><strong>embstr(&lt;= 39byte 的字符串)</strong></p>\n</li>\n<li>\n<p><strong>raw(&gt; 39byte 的字符串)</strong></p>\n</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查看 string 内部编码的变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 123</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"int\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> limou</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"embstr\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> limou343434343434343434343434343434343434343434343434343434343434</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"raw\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-4-2-list-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-2-list-的内部编码\"><span>3.3.4.2.List 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：下面两个条件同时满足时</p>\n<ul>\n<li>列表元素个数小于 <code v-pre>list-max-ziplist-entries</code> 配置（默认 <code v-pre>512</code> 个）</li>\n<li>列表元素长度小于 <code v-pre>list-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会使用压缩列表（<code v-pre>ziplist</code>）作为列表的内部编码方式，从而减少内存消耗</p>\n</li>\n<li>\n<p><strong>linkedlist(链表)</strong>：当哈希类型无法满足 <code v-pre>ziplist</code> 的条件时，<code v-pre>Redis</code> 会使⽤ <code v-pre>hashtable</code> 作为哈希的内部实现，<code v-pre>Redis</code> 会选择使用 <code v-pre>linkedlist</code> 作为列表的内部实现。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-3-set-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-3-set-的内部编码\"><span>3.3.4.3.Set 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>intset(整数集合)</strong>：</p>\n<ul>\n<li>集合元素的个数小于 <code v-pre>set-max-intset-entries</code> 配置（默认最大 <code v-pre>512</code> 个元素）</li>\n<li>集合元素值都是整数</li>\n</ul>\n<p><code v-pre>Redis</code> 会使用 <code v-pre>intset</code> 作为集合的内部实现，<code v-pre>intset</code> 是一个专门优化整数集合的压缩结构，可以显著减少内存使用。</p>\n</li>\n<li>\n<p><strong>hashtable(哈希表)</strong>：当列表类型无法满足 <code v-pre>intset</code> 的条件时，<code v-pre>Redis</code> 会使用 <code v-pre>hashtable</code> 作为集合的内部实现。<code v-pre>hashtable</code> 提供了高效的插入、查找和删除操作，适用于较大的集合。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-4-zset-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-4-zset-的内部编码\"><span>3.3.4.4.Zset 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：</p>\n<ul>\n<li>集合元素的个数小于 <code v-pre>zset-max-ziplist-entries</code> 配置（默认 <code v-pre>128</code> 个）</li>\n<li>每个元素的值都小于 <code v-pre>zset-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会⽤ <code v-pre>ziplist</code> 来作为有序集合的内部实现，<code v-pre>ziplist</code> 可以有效减少内存消耗</p>\n</li>\n<li>\n<p><strong>skiplist(跳表)</strong>：当 <code v-pre>ziplist</code> 条件不满足时，有序集合会使用 <code v-pre>skiplist</code> 作为内部实现，因为此时 <code v-pre>ziplist</code> 的操作效率会下降。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-5-hash-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-5-hash-的内部编码\"><span>3.3.4.5.Hash 的内部编码</span></a></h5>\n<p>哈希本身的内部编码变化也值得我们关注，内部的编码实现至少有两种 <code v-pre>ziplist(压缩列表), hashtable(哈希表)</code>，这就比字符串要复杂一些。</p>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：下面两个条件同时满足时</p>\n<ul>\n<li>哈希元素个数小于 <code v-pre>hash-max-ziplist-entries</code> 配置（默认 <code v-pre>512</code> 个）</li>\n<li>哈希元素值都小于 <code v-pre>hash-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会使⽤ <code v-pre>ziplist</code> 作为哈希的内部实现，<code v-pre>ziplist</code> 使用更加紧凑的结构实现多个元素的连续存储，所以在节省内存方面比 <code v-pre>hashtable</code> 更加优秀。</p>\n</li>\n<li>\n<p><strong>hashtable(哈希表)</strong>：当哈希类型无法满足 <code v-pre>ziplist</code> 的条件时，<code v-pre>Redis</code> 会使⽤ <code v-pre>hashtable</code> 作为哈希的内部实现，因为此时 <code v-pre>ziplist</code> 的读写效率会下降，而 <code v-pre>hashtable</code> 的读写时间复杂度为 <code v-pre>O(1)</code>。</p>\n</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查看 Hash 内部编码的变化(略)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-4-6-none-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-6-none-的内部编码\"><span>3.3.4.6.None 的内部编码</span></a></h5>\n<p>待补充...</p>\n<h4 id=\"_3-3-4-数据类型原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-数据类型原理\"><span>3.3.4.数据类型原理</span></a></h4>\n<p>待补充...</p>\n<h3 id=\"_3-4-渐进遍历\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-4-渐进遍历\"><span>3.4.渐进遍历</span></a></h3>\n<p><code v-pre>Redis</code> 提供了 <code v-pre>SCAN</code> 命令，允许用户以渐进式的方式进行键的遍历，避免了阻塞操作，适用于遍历大量数据的场景。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCAN</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [TYPE </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># cursor: 游标，初始值为 `0`，返回的游标值指示下次扫描的位置。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># MATCH pattern: 可选参数，用于过滤键名，支持模式匹配（类似于 `glob` 模式）。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># COUNT count: 可选参数，建议每次返回的元素数量。并不是严格的数量限制，实际返回数量可能会有所不同。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># TYPE type: 可选参数，指定键的类型（如 `string`, `list`, `set`, `zset`, `hash` 等）。</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>SCAN</code> 命令的时间复杂度是常数时间 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>，但遍历大数据集时，实际的时间复杂度会受到 <code v-pre>MATCH</code> 和 <code v-pre>COUNT</code> 参数的影响。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:637</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">9></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">17</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:12</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:8</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:14</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:16</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:17</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:15</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   9</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   10</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:7</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:637</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">9></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 17</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:5</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:18</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:19</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:13</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:6</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:9</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   9</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:11</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>Redis</code> 还为不同数据类型提供了相应的 <code v-pre>SCAN</code> 命令变种，功能与 <code v-pre>SCAN</code> 基本类似：</p>\n<ul>\n<li><strong>hscan</strong>: 用于扫描哈希类型的数据。</li>\n<li><strong>sscan</strong>: 用于扫描集合类型的数据。</li>\n<li><strong>zscan</strong>: 用于扫描有序集合类型的数据。</li>\n</ul>\n<p>它们的语法和使用方式与 <code v-pre>SCAN</code> 相同，只是针对特定类型的数据进行扫描。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>scan</code> 在使用过程中也有值得注意的地方。</p>\n<ul>\n<li>\n<p><strong>渐进性遍历</strong>：<code v-pre>SCAN</code> 命令是渐进式的，它不会一次性返回所有数据，而是通过多次调用来遍历数据。每次返回部分数据，并返回一个游标，指示下一次扫描的位置。</p>\n</li>\n<li>\n<p><strong>遍历期间的数据变化</strong>：在扫描期间，如果 <code v-pre>Redis</code> 数据发生变化（例如增加、修改或删除键），可能会导致以下问题：</p>\n<ul>\n<li><strong>重复遍历</strong>：某些键可能会被扫描多次</li>\n<li><strong>遗漏数据</strong>：某些键可能会被遗漏</li>\n</ul>\n<p>因此，在使用 <code v-pre>SCAN</code> 命令时，开发者应考虑到数据可能会在遍历过程中发生变化的情况。</p>\n</li>\n</ul>\n</div>\n<h3 id=\"_3-5-键值空间\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-5-键值空间\"><span>3.5.键值空间</span></a></h3>\n<p>与 <code v-pre>MySQL</code> 等关系型数据库不同的是，<code v-pre>Redis</code> 没有表、字段这种命名空间，而且也没有对键名有强制要求（除了不能使用一些特殊字符）。但设计合理的键名，有利于防止键冲突和项目的可维护性，比较推荐的方式是使用 <mark>&quot;业务名:对象名:唯一标识:属性&quot;</mark> 作为键名。例如 <code v-pre>MySQL</code> 的数据库名为 <code v-pre>vs</code>，用户表名为 <code v-pre>user_info</code>，那么对应的键 <code v-pre>name</code> 可以使用 <code v-pre>&quot;vs:user_info:6379:name&quot;</code> 来表示，如果当前 <code v-pre>Redis</code> 只会被⼀个业务使用，可以省略业务名 <code v-pre>&quot;vs:&quot;</code>。</p>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>注意：键名过长也会影响到 <code v-pre>Redis</code> 的性能。</p>\n</div>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>Redis</code> 中虽然支持持多数据库，但随着版本的升级，其实不是特别建议使⽤多数据库特性。如果真的需要完全隔离的两套键值对，更好的做法是维护多个 <code v-pre>Redis</code> 实例，而不是在⼀个 <code v-pre>Redis</code> 实例中维护多数据库。这是因为本身 <code v-pre>Redis</code> 并没有为多数据库提供太多的特性，其次无论是否有多个数据库，<code v-pre>Redis</code> 都是使用单线程模型，所以彼此之间还是需要排队等待命令的执行。同时多数据库还会让开发、调试和运维⼯作变得复杂。所以实践中，始终使用数据库 <code v-pre>0</code> 其实是⼀个很好的选择。</p>\n</div>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>flushdb/flushall</code> 命令用于清除数据库，区别在于 <code v-pre>flushdb</code> 只清除当前数据库，<code v-pre>flushall</code> 会清理所有数据库（这些行为很接近删库）。</p>\n</div>\n<h3 id=\"_3-6-设计架构\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-6-设计架构\"><span>3.6.设计架构</span></a></h3>\n<p>实际上 <code v-pre>Redis</code> 采用的是单线程的架构，但是为什么采用单线程还能这么快呢？主要原因如下：</p>\n<ul>\n<li>纯内存访问，这是最重要的一点，工作环境和 <code v-pre>MySQL</code> 等持久化数据库完全不一样</li>\n<li>非阻塞 <code v-pre>IO</code> 模型，底层用 <code v-pre>epoll</code> 的 <code v-pre>ET</code> 模式，无论时连接、读写、关闭都被转化为事件来处理，因此不会在网络 <code v-pre>IO</code> 上浪费太多时间</li>\n<li>单线程模型，无论客户端如何操作，在微观上一定时存在时间差的，因此就避免了线程切换开销的问题和并发加锁的问题</li>\n</ul>\n<p><code v-pre>Redis</code> 的这种特性，导致 <code v-pre>Redis</code> 只能作用于快速执行场景的热数据，一旦某个操作过长，就会导致严重延时的响应，这对 <code v-pre>Redis</code> 服务几乎是致命的。</p>\n<h3 id=\"_3-7-的持久化\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-的持久化\"><span>3.7.的持久化</span></a></h3>\n<h4 id=\"_3-7-1-rdb\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-rdb\"><span>3.7.1.RDB</span></a></h4>\n<h5 id=\"_3-7-1-1-rdb-的简单介绍\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-1-rdb-的简单介绍\"><span>3.7.1.1.RDB 的简单介绍</span></a></h5>\n<p><code v-pre>Redis</code> 的 <strong>RDB(Redis Database)</strong> 持久化机制是将当前内存中的数据生成快照并保存到磁盘的过程。<code v-pre>RDB</code> 是一种高效的持久化方式，但它有可能丢失短时间内的数据更新。</p>\n<p>转储的 <code v-pre>RDB</code> ⽂件保存在 <code v-pre>dir</code> 配置指定的目录下（默认 <code v-pre>/var/lib/redis/</code>），⽂件名通过 <code v-pre>dbfilename</code> 配置（默认 <code v-pre>dump.rdb</code>）指定。可以通过执行 <code v-pre>config set dir {newDir}</code> 和 <code v-pre>config set dbfilename {newFilename}</code> 运行期间动态执行，当下次运行时 <code v-pre>RDB</code> ⽂件会保存到新目录。</p>\n<p><code v-pre>Redis</code> 默认采⽤ <code v-pre>LZF</code> 算法对⽣成的 <code v-pre>RDB</code> ⽂件做压缩处理，压缩后的文件远远小于内存大小，默认开启，可以通过参数 <code v-pre>config set rdbcompression {yes|no}</code> 动态修改。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：虽然压缩 <code v-pre>RDB</code> 会消耗 <code v-pre>CPU</code>，但可以大幅降低文件的体积，方便保存到硬盘或通过网络发送到 <strong>从节点</strong>，因此建议开启。</p>\n</div>\n<h5 id=\"_3-7-1-2-rdb-的触发机制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-rdb-的触发机制\"><span>3.7.1.2.RDB 的触发机制</span></a></h5>\n<h6 id=\"_3-7-1-2-1-手动触发\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-1-手动触发\"><span>3.7.1.2.1.手动触发</span></a></h6>\n<ul>\n<li><code v-pre>save</code>：在执行 <code v-pre>save</code> 命令时，<code v-pre>Redis</code> 会阻塞当前服务器，直到 <code v-pre>RDB</code> 过程完成为止。对于大规模数据集会导致长时间的阻塞，因此在实际使用中很少采用。</li>\n<li><code v-pre>bgsave</code>：执行 <code v-pre>bgsave</code> 命令时，<code v-pre>Redis</code> 通过 <code v-pre>fork</code> 创建一个子进程来处理 <code v-pre>RDB</code> 持久化，主进程不会被阻塞，持久化任务由子进程处理。<code v-pre>RDB</code> 完成后，子进程会自动结束，主进程继续处理其他请求。</li>\n</ul>\n<h6 id=\"_3-7-1-2-2-自动触发\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-2-自动触发\"><span>3.7.1.2.2.自动触发</span></a></h6>\n<p>除了手动触发，<code v-pre>Redis</code> 还支持以下几种自动触发的机制：</p>\n<ul>\n<li><code v-pre>save</code>：通过配置文件中的 <code v-pre>save m n</code> 指令，<code v-pre>Redis</code> 会在每隔 <code v-pre>m</code> 秒内数据集发生了 <code v-pre>n</code> 次修改时，自动触发 <code v-pre>RDB</code> 持久化</li>\n<li>从节点复制操作：当 <code v-pre>Redis</code> 的 <strong>从节点</strong> 进行全量复制时，主节点会自动执行 <code v-pre>RDB</code> 持久化，并将生成的 <code v-pre>RDB</code> 文件内容发送给从节点</li>\n<li><code v-pre>shutdown</code>：当执行 <code v-pre>shutdown</code> 命令关闭 <code v-pre>Redis</code> 时，<code v-pre>Redis</code> 会自动执行 <code v-pre>RDB</code> 持久化，确保数据的持久性</li>\n</ul>\n<h5 id=\"_3-7-1-3-rdb-的实现原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-3-rdb-的实现原理\"><span>3.7.1.3.RDB 的实现原理</span></a></h5>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241120211127863.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>执行 <code v-pre>bgsave</code> 后父进程检查是否有其他的持久化子进程在执行持久化操作</li>\n<li>父进程通过 <code v-pre>fork</code> 创建持久化子进程，<code v-pre>fork</code> 的过程中父进程会轻微阻塞，通过 <code v-pre>info stats</code> 命令查看 <code v-pre>latest_fork_usec</code> 选项，可以获取最近一次 <code v-pre>fork</code> 操作的耗时，单位为微秒</li>\n<li><code v-pre>bgsave</code> 命令返回并释放父进程，继续处理请求</li>\n<li>子进程执行 <code v-pre>RDB</code> 持久化操作，根据父进程内存生成老师快照文件，完成并原子化替换原始的 <code v-pre>RDB</code> 文件，执行 <code v-pre>lastsave</code> 命令就可以获取最后一次生成 <code v-pre>RDB</code> 的时间，对应 <code v-pre>info</code> 统计的 <code v-pre>rdb_last_save_time</code> 选项</li>\n<li>子进程发送信号通知父进程操作完成，父进程更新统计信息</li>\n</ol>\n<h5 id=\"_3-7-1-4-rdb-的优势劣势\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-4-rdb-的优势劣势\"><span>3.7.1.4.RDB 的优势劣势</span></a></h5>\n<ul>\n<li><code v-pre>RDB</code> 文件是一个紧凑压缩的二进制文件，代表 <code v-pre>Redis</code> 在某个时间点上的数据快照 <code v-pre>RDB</code> 非常适用于备份、全量复制等场景。例如，每 <code v-pre>6</code> 小时执行 <code v-pre>bgsave</code> 备份，并把 <code v-pre>RDB</code> 文件复制到远程机器或者文件系统（如 <code v-pre>HDFS</code>）用于灾备。而 <code v-pre>Redis</code> 加载 <code v-pre>RDB</code> 恢复数据的速度远快于 <code v-pre>AOF</code> 的方式。</li>\n<li><code v-pre>RDB</code> 方式无法做到实时持久化或秒级持久化，因为 <code v-pre>bgsave</code> 每次执行都要进行 <code v-pre>fork</code> 创建子进程，这属于重量级操作，频繁执行成本过高。另外，由于 <code v-pre>RDB</code> 文件使用特定的二进制格式保存，随着 <code v-pre>Redis</code> 版本演进，<code v-pre>RDB</code> 格式可能发生变化，存在兼容性风险。</li>\n</ul>\n<h4 id=\"_3-7-2-aof\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-aof\"><span>3.7.2.AOF</span></a></h4>\n<h5 id=\"_3-7-2-1-aof-的简单介绍\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-1-aof-的简单介绍\"><span>3.7.2.1.AOF 的简单介绍</span></a></h5>\n<p><code v-pre>Redis</code> 的 <strong>AOF(Append Only File)</strong> 持久化机制，以独立日志的方式记录每次写命令，重启时再重新执行 <code v-pre>AOF</code> 文件中的命令以达到恢复数据的目的。<code v-pre>AOF</code> 的主要作用是解决了数据持久化的实时性问题，目前已经成为 <code v-pre>Redis</code> 持久化的主流方式。</p>\n<h5 id=\"_3-7-2-2-aof-的触发机制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-aof-的触发机制\"><span>3.7.2.2.AOF 的触发机制</span></a></h5>\n<h6 id=\"_3-7-2-2-1-启用持久\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-1-启用持久\"><span>3.7.2.2.1.启用持久</span></a></h6>\n<p>默认 <code v-pre>AOF</code> 是不开启的，需要配置设置 <code v-pre>appendonly yes</code> 才可以打开，<code v-pre>AOF</code> ⽂件名通过 <code v-pre>appendfilename</code> 配置（默认是 <code v-pre>appendonly.aof</code>）设置。保存目录同 <code v-pre>RDB</code> 持久化方式一直，也是通过 <code v-pre>dir</code> 配置来指定。</p>\n<p><code v-pre>AOF</code> 开启后，写命令也会被写入到缓存中，写入的持久化内容是以文本协议格式进行的。例如，<code v-pre>set hello world</code> 这条命令在 <code v-pre>AOF</code> 缓冲区会追加如下文本：</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">3</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$3</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$5</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">hello</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$5</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">world</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>这里遵循了 <code v-pre>Redis</code> 协议格式。<code v-pre>Redis</code> 选择文本协议的原因主要包括：</p>\n<ul>\n<li><strong>兼容性</strong>：文本协议具有较好的跨平台兼容性。</li>\n<li><strong>实现简单</strong>：文本协议易于理解和实现。</li>\n<li><strong>可读性</strong>：文本格式直观，便于调试和查看。</li>\n</ul>\n<p>在 <code v-pre>AOF</code> 过程中，需要一个名为 <code v-pre>aof_buf</code> 的缓冲区。<code v-pre>Redis</code> 使用单线程响应命令，如果每次写 <code v-pre>AOF</code> 文件都直接同步到硬盘，会导致性能下降，因为每次操作都涉及到 <code v-pre>IO</code> 读写，这比内存读写要慢。通过先写入缓冲区，可以有效减少 <code v-pre>IO</code> 次数。同时，<code v-pre>Redis</code> 提供了多种缓冲区同步策略，允许用户根据实际需求进行性能和数据持久性的平衡。</p>\n<h6 id=\"_3-7-2-2-2-同步策略\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-2-同步策略\"><span>3.7.2.2.2.同步策略</span></a></h6>\n<p><code v-pre>Redis</code> 提供了多种 <code v-pre>AOF</code> 缓冲区同步文件策略，通过参数 <code v-pre>appendfsync</code> 控制。不同值的含义如下：</p>\n<table>\n<thead>\n<tr>\n<th>可配置值</th>\n<th>说明</th>\n<th>建议</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code v-pre>always</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后调用 <code v-pre>fsync</code> 同步，完成后返回。</td>\n<td>每次写入都同步 <code v-pre>AOF</code> 文件，数据安全性最高。但是性能非常差，在一般的 <code v-pre>SATA</code> 硬盘上，只能支持约几百 <code v-pre>TPS</code> 的写入量。因此除非数据极其重要，否则不建议配置。</td>\n</tr>\n<tr>\n<td><code v-pre>everysec</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后只执行 <code v-pre>write</code> 操作，不进行 <code v-pre>fsync</code>。每秒由同步线程进行 <code v-pre>fsync</code>。</td>\n<td>默认配置，也是推荐配置。命令写入 <code v-pre>aof_buf</code> 后立即返回，由同步线程每秒执行一次 <code v-pre>fsync</code>。兼顾数据安全性和性能，理论上最多丢失 <code v-pre>1</code> 秒的数据。</td>\n</tr>\n<tr>\n<td><code v-pre>no</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后只执行 <code v-pre>write</code> 操作，由操作系统控制 <code v-pre>fsync</code> 频率。</td>\n<td>操作系统自行决定同步策略，性能较高，但数据丢失风险较大。仅适用于数据重要性极低的场景。</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>\n<p><strong><code v-pre>write</code> 操作：</strong></p>\n<ul>\n<li>会触发 <strong>延迟写</strong> 机制。</li>\n<li><code v-pre>Linux</code> 在内核中提供页面缓冲区，用来提升硬盘 <code v-pre>IO</code> 性能</li>\n<li><code v-pre>write</code> 操作在数据写入系统缓冲区后立即返回，数据同步到硬盘依赖系统调度机制（如缓冲区写满或达到特定时间周期）</li>\n<li>在数据同步到硬盘之前，如果系统发生故障或宕机，缓冲区内的数据将丢失</li>\n</ul>\n</li>\n<li>\n<p><strong><code v-pre>fsync</code> 操作：</strong></p>\n<ul>\n<li>针对单个文件操作，执行强制硬盘同步</li>\n<li><code v-pre>fsync</code> 会阻塞当前操作，直到数据写入到硬盘为止</li>\n</ul>\n</li>\n</ul>\n<p>在大多数场景下，推荐使用 <code v-pre>everysec</code> 配置，以获得较好的数据安全性和系统性能平衡。</p>\n<h6 id=\"_3-7-2-2-3-触发重写\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-3-触发重写\"><span>3.7.2.2.3.触发重写</span></a></h6>\n<p>3.7.2.2.3.1.手动触发</p>\n<p>手动触发 <code v-pre>AOF</code> 重写可以通过执行 <code v-pre>BGREWRITEAOF</code> 命令。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis-cli</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> BGREWRITEAOF</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>该命令会在后台执行 <code v-pre>AOF</code> 文件重写操作，将当前数据库状态保存到新的 <code v-pre>AOF</code> 文件中。</p>\n<p>3.7.2.2.3.2.自动触发</p>\n<p><code v-pre>AOF</code> 重写也可以根据以下两个参数自动触发：</p>\n<ul>\n<li><code v-pre>auto-aof-rewrite-min-size</code>：该参数表示触发 <code v-pre>AOF</code> 重写时，<code v-pre>AOF</code> 文件的最小大小。默认值为 <code v-pre>64MB</code>。当 <code v-pre>AOF</code> 文件的大小超过这个最小值时，<code v-pre>Redis</code> 会考虑是否进行自动重写。</li>\n<li><code v-pre>auto-aof-rewrite-percentage</code>：该参数表示当前 <code v-pre>AOF</code> 文件大小相对于上次重写时的增长百分比。只有当 <code v-pre>AOF</code> 文件的大小增加超过这个百分比时，才会触发自动重写。默认值为 <code v-pre>100%</code>。</li>\n</ul>\n<h5 id=\"_3-7-2-3-aof-的实现原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-3-aof-的实现原理\"><span>3.7.2.3.AOF 的实现原理</span></a></h5>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241120221238022.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>所有的写入命令会追加到 <code v-pre>aof_buf</code>（缓冲区）中</li>\n<li><code v-pre>AOF</code> 缓冲区根据对应的策略向硬盘进行同步操作</li>\n<li>随着 <code v-pre>AOF</code> 文件增大，需要定期对 <code v-pre>AOF</code> 文件进行等价重写，以达到压缩目的</li>\n<li>当 <code v-pre>Redis</code> 服务器启动时，可以加载 <code v-pre>AOF</code> 文件进行数据恢复</li>\n</ol>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：随着命令不断写入 <code v-pre>AOF</code>，文件会越来越大。为了解决这个问题，<code v-pre>Redis</code> 引入了 <code v-pre>AOF</code> 重写机制来压缩文件体积。<code v-pre>AOF</code> 文件重写是将 <code v-pre>Redis</code> 进程内的数据转换为写命令，并同步到新的 <code v-pre>AOF</code> 文件。重写后的 <code v-pre>AOF</code> 为什么可以变小？主要有以下理由：</p>\n<ul>\n<li><strong>超时数据的去除</strong> 进程内已超时的数据不会再写入文件，避免了过期数据的冗余存储</li>\n<li><strong>无效命令的删除</strong> 旧的 <code v-pre>AOF</code> 文件中可能包含无效命令（如 <code v-pre>del</code>、<code v-pre>hdel</code>、<code v-pre>srem</code> 等）。在重写过程中，这些命令会被删除，只保留数据的最终版本</li>\n<li><strong>多条写操作合并</strong> 多条相似的写操作可以合并为一条命令。例如，<code v-pre>lpush list a</code>、<code v-pre>lpush list b</code>、<code v-pre>lpush list c</code> 可以合并为 <code v-pre>lpush list a b c</code>，从而减少冗余操作</li>\n</ul>\n</div>\n<p>此外还有一个重写的原理，您也可以简单看一看。</p>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241121083647145.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>\n<p>执行 <code v-pre>AOF</code> 重写请求</p>\n<ul>\n<li>如果当前进程正在执行 <code v-pre>AOF</code> 重写，请求不执行</li>\n<li>如果当前进程正在执行 <code v-pre>bgsave</code> 操作，重写命令延迟到 <code v-pre>bgsave</code> 完成之后再执行</li>\n</ul>\n</li>\n<li>\n<p>父进程执行 <code v-pre>fork</code> 创建子进程</p>\n</li>\n<li>\n<p>重写过程：</p>\n<ul>\n<li>主进程 <code v-pre>fork</code> 之后，继续响应其他命令。所有修改操作写入 <code v-pre>AOF</code> 缓冲区，并根据 <code v-pre>appendfsync</code> 策略同步到硬盘，保证旧 <code v-pre>AOF</code> 文件机制正确</li>\n<li>子进程只有 <code v-pre>fork</code> 之前的所有内存信息，父进程中需要将 <code v-pre>fork</code> 之后这段时间的修改操作写入 <code v-pre>AOF</code> 重写缓冲区中</li>\n</ul>\n</li>\n<li>\n<p>子进程根据内存快照，将命令合并到新的 <code v-pre>AOF</code> 文件中</p>\n</li>\n<li>\n<p>子进程完成重写：</p>\n<ul>\n<li>新文件写入后，子进程发送信号给父进程</li>\n<li>父进程把 <code v-pre>AOF</code> 重写缓冲区内临时保存的命令追加到新 <code v-pre>AOF</code> 文件中</li>\n<li>用新 <code v-pre>AOF</code> 文件替换旧 <code v-pre>AOF</code> 文件</li>\n</ul>\n</li>\n</ol>\n<h5 id=\"_3-7-2-4-aof-的优势劣势\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-4-aof-的优势劣势\"><span>3.7.2.4.AOF 的优势劣势</span></a></h5>\n<ul>\n<li>\n<p>优势：</p>\n<ul>\n<li><strong>数据更精确</strong>：<code v-pre>AOF</code> 会记录每个写命令，可以达到更高的数据持久化精度。例如，假设 <code v-pre>Redis</code> 崩溃了，你可能丢失不到几秒钟的数据（这取决于 <code v-pre>appendfsync</code> 策略）。</li>\n<li><strong>持久化策略灵活</strong>：<code v-pre>AOF</code> 提供三种同步策略 (<code v-pre>always</code>, <code v-pre>everysec</code>, <code v-pre>no</code>)，可以根据需求在持久化精度和性能之间做平衡。</li>\n<li><strong>支持持久化恢复</strong>：<code v-pre>AOF</code> 文件可以通过重放命令恢复数据，保证数据一致性。</li>\n</ul>\n</li>\n<li>\n<p>劣势：</p>\n<ul>\n<li>\n<p><strong>文件较大</strong>：由于每个写命令都被记录，<code v-pre>AOF</code> 文件的大小可能会比 <code v-pre>RDB</code> 大很多。</p>\n</li>\n<li>\n<p><strong>性能开销</strong>：<code v-pre>AOF</code> 会增加额外的写入操作，尤其是 <code v-pre>appendfsync always</code> 策略会频繁同步磁盘，导致性能下降。</p>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 两种方案的使用</p>\n<ul>\n<li><code v-pre>RDB</code> 高性能，底持久，磁盘多容量，慢速度</li>\n<li><code v-pre>AOF</code> 低性能，高持久，磁盘少容量，快速度</li>\n</ul>\n</div>\n<h3 id=\"_3-8-业务操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-业务操作\"><span>3.8.业务操作</span></a></h3>\n<h4 id=\"_3-8-1-事务\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-1-事务\"><span>3.8.1.事务</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合原子执行多个操作，只能单次启动。</p>\n</div>\n<p>由于 <code v-pre>Redis</code> 的实现是单线程的，对比 <code v-pre>MySQL</code> 来说，<code v-pre>Redis</code> 事务要简单很多。</p>\n<ul>\n<li>弱化的原子性：虽然也是把一系列操作绑定为一组，但是操作失败时，无法回滚，因此原子性比较弱。</li>\n<li>不保证一致性：<span style=\"text-emphasis:filled red;\">这点待补充...</span></li>\n<li>不需要隔离性：<code v-pre>MySQL</code> 需要给多个同时执行的事务设置隔离性，但是由于 <code v-pre>Redis</code> 是单线程的，这导致 <code v-pre>Redis</code> 无需设置隔离性，只要保证自己的每条操作都是原子的即可。</li>\n<li>不需要持久性：这不代表 <code v-pre>Redis</code> 不需要做持久化，或没有持久化功能，而是 <code v-pre>Redis</code> 的事务不需要自己考虑持久化的问题，这个问题交给 <code v-pre>redis-server</code> 自己的 <code v-pre>RDB/AOF</code> 持久化机制。</li>\n</ul>\n<p>总结来看仅仅是打包了一组指令，避免被其他客户端 <strong>加塞</strong> 而已。</p>\n<p><code v-pre>Redis</code> 事务其实是在服务器上搞了一个 <strong>事务队列</strong>. 每次客户端在事务中进行一个操作, 都会把命令先发给服务器, 放到事务队列中（但并不会立刻执行），而是会在真正收到 <code v-pre>EXEC</code> 命令之后, 才真正执行队列中的所有操作。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 操作一个简单的事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开启事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MULTI</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 执行指令(其实还没执行)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 表示命令已加入事务队列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k3</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完成事务(提醒可以执行)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EXEC</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 也可以使用 DISCARD 放弃事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>不过在对同一个键的操作上，并且客户端开始编写事务的情况下，其他客户端先提交事务（或者直接执行指令时），还是会出现一些问题，这个时候会使用 <code v-pre>watch/unwatch</code> 来监控键值的版本号（就是一个整数而已），版本号冲突就立刻停止执行。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 假设两个客户端几乎同时开始编写事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 1 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 开始监视键 k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">watch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 开始事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MULTI</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 将修改 k1 和 k2 作为事务的一部分, 但尚未执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 此时 k1 的版本号为 0, 记录该版本号, 操作被排队, 但没有提交</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k2 的修改操作也被加入队列, 尚未执行</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 尚未执行 EXEC, 事务仍在队列中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 2 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 2 执行修改 k1 操作, 修改 k1 的值, 并将其版本号更改为 1(相当于提前提交了只有一条指令的事务)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 200</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 客户端 2 成功修改了 k1 的值, 服务器上的版本号变为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 1 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 执行 EXEC, 提交事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EXEC</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 由于版本号不一致, 事务被取消, 未执行任何命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查 k1 的最终值, 应该是客户端 2 提交的修改</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"200\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k1 的最终值是 200, 表明客户端 2 修改成功</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查 k2 的最终值, 因为客户端 1 的事务没有成功提交, 所以 k2 未被设置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k2 并没有被修改, 返回 nil</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-8-2-脚本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-2-脚本\"><span>3.8.2.脚本</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合原子执行多个操作，可以复用启动。</p>\n</div>\n<p><code v-pre>Redis</code> 支持执行 <code v-pre>Lua</code> 脚本，关于 <code v-pre>Lua</code>，您可以可以 <a href=\"https://www.lua.org/\" target=\"_blank\" rel=\"noopener noreferrer\">前往 Lua 官网查看大概的情况</a>，使用 <code v-pre>Lua</code> 的原因主要是</p>\n<ul>\n<li>为了将多个操作封装为原子操作，确保操作原子执行</li>\n<li>支持脚本缓存，可以减少因为数据传输引起的网络开销</li>\n<li><code v-pre>Lua</code> 本身也支持一些复杂的数据操作能力，避开 <code v-pre>Redis</code> 内部只有简单计算的缺点，也不必传递给客户端（对于 <code v-pre>Redis</code> 服务端来说客户端）浪费计算时间的问题再进行计算</li>\n<li>对于较多的 <code v-pre>Redis</code> 操作，可以直接使用 <code v-pre>Lua</code> 脚本优化操作，由于 <code v-pre>Redis</code> 对 <code v-pre>Lua</code> 脚本做过优化，可以原生执行 <code v-pre>Redis</code> 的代码</li>\n</ul>\n<p>怎么抉择什么时候使用 <code v-pre>Lua</code> 和 <code v-pre>Cpp</code> 呢？</p>\n<ul>\n<li>需要事务原子操作时</li>\n<li>需要减少网络开销时</li>\n<li>重复执行相同操作时</li>\n<li>避免在客户端计算时（对于 <code v-pre>Redis</code> 的客户端）</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 Redis 的 Lua 脚本缓存机制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SCRIPT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LOAD</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return ARGV[1] + ARGV[2]</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"53c370cb7894e73f9aaf94627c0506c428b5cc97\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EVALSHA</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 53c370cb7894e73f9aaf94627c0506c428b5cc97</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 5</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-8-3-管道\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-3-管道\"><span>3.8.3.管道</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合本地执行多个操作，通常由库实现</p>\n</div>\n<p><code v-pre>Pipeline</code> 用来：</p>\n<ul>\n<li><strong>发送多个 Redis 命令</strong> <code v-pre>Redis</code> 客户端会将多个命令批量发送到服务器，而不是逐条发送</li>\n<li><strong>读取所有命令的结果</strong> 客户端一次性读取所有响应，减少网络往返时间</li>\n</ul>\n<p>实际上<code v-pre>Redis</code> 本身没有管道的相关操作，但是对于大部分的客户端是有实现管道操作的，让多条指令能一次性发送到 <code v-pre>Redis</code> 中，保证多条指令的执行结果如同在 <code v-pre>redis-cli</code> 中是一样的（因此就理解为和在 <code v-pre>Redis</code> 服务器命令行本地中输入执行多条命令是一样的就可以）。</p>\n<p>但是需要强调的是，管道不是原子的，完全只是为了压缩多条指令带来的多个 <code v-pre>RTT(往返时间)</code> 而已，把多个指令请求合并，减少网络开支。</p>\n<h3 id=\"_3-9-通信协议\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-9-通信协议\"><span>3.9.通信协议</span></a></h3>\n<p>待补充...</p>\n<h3 id=\"_3-10-第三方库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-第三方库\"><span>3.10.第三方库</span></a></h3>\n<h4 id=\"_3-10-1-cpp-客户端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-cpp-客户端\"><span>3.10.1.Cpp 客户端</span></a></h4>\n<h5 id=\"_3-10-1-1-redispp-的安装\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-1-redispp-的安装\"><span>3.10.1.1.Redispp 的安装</span></a></h5>\n<p>这里使用 <a href=\"https://github.com/sewenew/redis-plus-plus\" target=\"_blank\" rel=\"noopener noreferrer\">redis-plus-plus 库</a> 来操作 <code v-pre>Redis</code> 的使用，<code v-pre>redis-plus-plus</code> 是基于 <code v-pre>C</code>语 言实现的 <code v-pre>hiredis</code>实现的，先使用 <code v-pre>sudo apt install libhiredis-dev</code>快速安装 <code v-pre>Redis</code> 开发工具，然后 <code v-pre>git clone https://github.com/sewenew/redis-plus-plus.git</code> 克隆该库进行安装。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 编译和安装</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装开发工具包</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> libhiredis-dev</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 克隆源代码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> git</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> clone</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://github.com/sewenew/redis-plus-plus.git</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 编译源代码, 然后进行安装</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-plus-plus</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mkdir</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> cmake</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ..</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> make</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> make</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>接下来请您直接 <a href=\"https://github.com/sewenew/redis-plus-plus/tree/master?tab=readme-ov-file#api-reference\" target=\"_blank\" rel=\"noopener noreferrer\">查看官方文档 API 文档</a> 来学习使用 <code v-pre>Redispp</code>，官方文档写得非常详细。</p>\n<h5 id=\"_3-10-1-2-redispp-的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-2-redispp-的使用\"><span>3.10.1.2.Redispp 的使用</span></a></h5>\n<p>这里结合官方文档简单快速的编写程序来做实验。</p>\n<div class=\"language-cpp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cpp\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// main.cpp</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sw/redis++/redis++.h</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">using</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> namespace</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sw</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    try</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 链接 Redis 实例 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> redis </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">tcp://127.0.0.1:6379</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 单前数据库清空操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">flushdb</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === String 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">del</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 可以提前删除不需要的键</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 设置键值对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> val </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 获取键值对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">expire</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">chrono</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">seconds</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">20</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 设置过期时间(以秒为单位)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // redis.pexpire(\"string\", std::chrono::milliseconds(20000));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 20 秒</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === List 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vec </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">aaa</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bbb</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ccc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">abc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bac</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">cab</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lrange</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Set 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_set</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> set </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">smembers</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sismember</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1 exists</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1 not exists</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Zset 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_map</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> scores </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> scores</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> scores</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 获取带分数的有序集合结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double>></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                UnboundedInterval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;double></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">{}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset_result (with scores):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 获取不带分数的有序集合结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                BoundedInterval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">>(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> BoundType</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">CLOSED</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">),</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意 BoundType::CLOSED 表示闭区间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">without_score (no scores):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double>></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                BoundedInterval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">>(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> BoundType</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OPEN</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">),</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意 BoundType::LEFT_OPEN 表示开区间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">with_score (open interval):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Hash 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">make_pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意这里做了更新操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_map</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> m </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hmset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hgetall</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 打印结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 也可以只获取到值而去除字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hmget</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 脚本操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这个脚本非常简单, 它仅返回 1, 并没有与 Redis 数据库进行任何交互</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> num </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">eval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return 1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> num </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这段代码执行一个简单的 Lua 脚本 return 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // eval&#x3C;long long> 表示将脚本的返回值转换为 long long 类型</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 脚本返回 1, 即返回一个数字 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // {} 表示没有键(KEYS), {} 表示没有传入参数(ARGV)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 该脚本将返回两个元素 1 和 2, 并将其作为字符串存储在 nums 向量中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">eval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return {ARGV[1], ARGV[2]}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这段代码执行 Lua 脚本 \"return {ARGV[1], ARGV[2]}\", 该脚本返回一个包含 ARGV[1] 和 ARGV[2] 两个元素的数组</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // ARGV[1] 和 ARGV[2] 分别对应传入的 {\"1\", \"2\"} 参数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 通过 std::back_inserter(nums) 将返回的结果插入到 nums 向量中</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 脚本操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hash_val </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">script_load</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return ARGV[1] + ARGV[2]</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hash_val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">evalsha</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">hash_val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 执行复杂脚本并且查看过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mset_with_ttl_script </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> R\"(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            local len = #KEYS</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            if (len == 0 or len + 1 ~= #ARGV) then return 0 end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            local ttl = tonumber(ARGV[len + 1])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            if (not ttl or ttl &#x3C;= 0) then return 0 end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            for i = 1, len do redis.call(\"SET\", KEYS[i], ARGV[i], \"EX\", ttl) end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            return 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">        )\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> keys </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> args </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">60</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">eval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mset_with_ttl_script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> args</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> args</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        sleep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 故意等 5 秒后再打印过期时间</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl0 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl1 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl2 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl3 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 使用管道来本地操作多条指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> pipe </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pipeline</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> pipe_replies </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-value</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rename</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">new-my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">b</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">c</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lrange</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">exec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> set_cmd_result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;bool></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第一条命令结果(布尔)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> get_cmd_result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第二条命令结果(字符)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;void></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第三条命令结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第四条命令结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SET command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set_cmd_result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">?</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Success</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> :</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Failure</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">has_value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">())</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">GET command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_cmd_result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">GET command result: Key not found</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">RENAME command result: Success (no return value)</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">LRANGE command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 事物操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tx </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">transaction</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tx_replies </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">incr</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">incr</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mget</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">{</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">exec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 提交事物</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_0 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_1 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 使用 OptionalString 的目的是避免空值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr_result_0: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_0 </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr_result_1: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_1 </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 原生执行 Redis 指令 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 可以使用多个参数执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> get_name </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">command</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CLIENT</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SETNAME</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-redis-cli</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 大小写均可</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        get_name </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">command</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">client</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getname</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_name </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">command</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sort</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">alpha</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">desc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // ALPHA 是指按照字母排序, desc 是逆向排序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sorted_list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 也可以使用初始化列表参数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sort_cmd_str </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sort</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ALPHA</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">command</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">sort_cmd_str</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> sort_cmd_str</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 集群控制 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 如果您运行了多个 Redis 实例, 就可以利用多个实例的创建, 快速管理另外一个 Redis 实例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> redis_cluster </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> RedisCluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">tcp://127.0.0.1:7000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis_cluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 因此对于这个新实例来说, 也是相同的操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> value </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis_cluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> catch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Error </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">e</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Error: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> e</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">what</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>当然，您可以继续查阅文档，官方也有提供 <code v-pre>Doxygen</code> 注释，您可以尝试生成一份来阅读。</p>\n<p>还有一些其他 <code v-pre>API</code> 细节，这里简单概览一下文档支持的大部分功能，就不做详细的解读了...</p>\n<ul>\n<li>连接</li>\n<li>发送指令</li>\n<li>异常</li>\n<li>通用命令界面</li>\n<li>发布订阅</li>\n<li>管道</li>\n<li>事物</li>\n<li>集群</li>\n<li>哨兵</li>\n<li>流</li>\n<li>模块</li>\n<li>异步接口</li>\n<li>协程接口</li>\n</ul>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>警告：部分后续提及，少部分功能未完全实现。</p>\n</div>\n<h4 id=\"_3-10-2-java-客户端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-2-java-客户端\"><span>3.10.2.Java 客户端</span></a></h4>\n<p><code v-pre>Spring boot</code> 可以集成 <code v-pre>Redis</code> 进行使用（内置 <code v-pre>Jedis</code>），待补充...</p>\n<h2 id=\"_4-组件深入\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-组件深入\"><span>4.组件深入</span></a></h2>\n<h2 id=\"_5-组件原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-组件原理\"><span>5.组件原理</span></a></h2>\n</template>","contentStripped":"<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：</p>\n<p>接下来，可以 <a href=\"https://redis.io/docs/latest/get-started/\" target=\"_blank\" rel=\"noopener noreferrer\">根据 Redis 官方的快速学习手册进行学习</a>：</p>\n<ul>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/data-store/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为内存中数据类型存储快速入门</a>，并且还需要 <a href=\"https://redis.io/docs/latest/develop/data-types/\" target=\"_blank\" rel=\"noopener noreferrer\">阅读 Redis 中的数据类型</a>，每一个数据类型都可以有对应的文档</li>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/document-database/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为文档数据库快速入门</a>（但是必须额外下载 <code v-pre>Redis Stack</code>）</li>\n<li><a href=\"https://redis.io/docs/latest/develop/get-started/vector-database/\" target=\"_blank\" rel=\"noopener noreferrer\">Redis 作为矢量数据库快速入门</a>（但是必须额外下载 <code v-pre>Redis Stack</code>，并且您必须学习过机器学习）</li>\n</ul>\n<p>这几个文档还是非常简单易读的，非常推荐（和本系列一起阅读更佳）。</p>\n<p>如果觉得文档太难看懂，可以看看 <a href=\"https://www.bilibili.com/video/BV1UnY5ehE4b?vd_source=c92c89dbfcf9cc30c48086469621f35b&amp;spm_id_from=333.788.videopod.episodes\" target=\"_blank\" rel=\"noopener noreferrer\">别人搬运的尚硅谷 Redis 教程(非正版...)</a>。</p>\n</div>\n<h2 id=\"_1-组件简介\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-组件简介\"><span>1.组件简介</span></a></h2>\n<p><code v-pre>Redis</code> 是一种开源的内存数据库，用于存储数据结构，例如字符串、哈希表、列表、集合、有序集合等。它被设计为快速、灵活，并支持多种数据结构的操作。<code v-pre>Redis</code> 通常用作缓存、消息代理、会话存储等用途。它支持多种编程语言，并有许多客户端库可供开发者使用。Redis 也有持久化选项，可以将数据保存到磁盘上，以便在重启时恢复数据。</p>\n<p><code v-pre>Redis</code> 所有数据都是存放在内存中的，把数据放在内存中是 <code v-pre>Redis</code> 速度快的最主要原因。另外 <code v-pre>Redis</code> 是 ⽤ <code v-pre>C</code> 语 ⾔ 实现的，⼀ 般来说 <code v-pre>C</code> 语 ⾔ 实现的最终程序会更快。另外 <code v-pre>Redis</code> 一开始采用的是单线程，预防了多线程可能产 ⽣ 的竞争问题。不够后面的 <code v-pre>Redis</code> 在 <code v-pre>6.0</code> 版本引 ⼊ 了多线程机制，但主要也是在处理 ⽹ 络和 <code v-pre>IO</code>，不涉及到数据命令，即命令的执行仍然采 ⽤ 了单线程模式。</p>\n<p>从网络角度上，<code v-pre>Redis</code> 还使用了 <code v-pre>IO</code> 多路复用的方式，实际上就是 <code v-pre>ET</code> 模式的 <code v-pre>epoll</code>（<code v-pre>Redis</code> 的核心任务主要是操作内存的数据结构，不会吃很多的 <code v-pre>CPU</code> 资源）。</p>\n<p>另外，<code v-pre>Redis</code> 的很多核心功能都是比较简单的逻辑，简单逻辑就代表简单执行，就会非常快速。</p>\n<p><code v-pre>Redis</code> 相对于传统的关系型数据库（如 <code v-pre>MySQL</code>）或自定义内存中的变量有一些优势，这些优势可能导致选择 <code v-pre>Redis</code>：</p>\n<ol>\n<li>\n<p><strong>性能快速</strong>：这里的性能快速是和 <code v-pre>MySQL</code> 进行对比。</p>\n<p>(1)<code v-pre>Redis</code> 是一个基于内存的数据库，因此读写速度非常快，适合需要快速响应的应用场景，如缓存系统或计数器（因此常常是 <code v-pre>MySQL</code> 的一个替代方案，但是存储容量没有 <code v-pre>MySQL</code> 多，不过有一种方案就是两者同时结合使用，热点数据使用 <code v-pre>Redis</code>，其余数据使用 <code v-pre>MySQL</code>）。</p>\n</li>\n<li>\n<p><strong>数据结构</strong>：<code v-pre>Redis</code> 支持丰富的数据结构，如字符串、哈希表、列表、集合、有序集合、<code v-pre>GEO(地理信息定位)</code>...，这使得它可以更灵活地存储和操作数据，而不仅仅局限于关系型数据库的表结构（和 <code v-pre>MySQL</code> 关系数据库不同，<code v-pre>Redis</code> 是基于键值对来组织数据的，是一种典型的非关系型数据库）。</p>\n</li>\n<li>\n<p><strong>可编程的</strong>：可以使用命令行操作 <code v-pre>Redis</code>，也可以使用编程语言脚本的方式批量执行一些操作（主要使用 <code v-pre>Lua</code>，也是一种较火的语言）。</p>\n</li>\n<li>\n<p><strong>可拓展性</strong>：可以使用 <code v-pre>C/C++、Rust</code> 来为 <code v-pre>Redis</code> 功能做拓展（本质是安装动态链接库，类似 <code v-pre>.so/.dll</code> 等），例如支持更多数据结构和更多交互命令。</p>\n</li>\n<li>\n<p><strong>持久化数据</strong>：虽然 <code v-pre>Redis</code> 是基于内存的，但它提供了持久化选项，可以将数据定期写入磁盘，确保数据不会因为系统崩溃而丢失。并且也有两种持久化方案，<code v-pre>RDB</code> 和 <code v-pre>AOF</code>，前者是基于快照数据的持久化，后者是基于日志数据的持久化。</p>\n</li>\n<li>\n<p><strong>水平拓展</strong>：<code v-pre>Redis</code> 支持主从复制和集群模式，可以在多个主机部署多个节点。</p>\n</li>\n<li>\n<p><strong>高可用性</strong>：多个节点上可以复制数据（备份/冗余），提高系统的可用性和容错能力，从节点就相当于主节点的备份。</p>\n</li>\n<li>\n<p><strong>原子操作</strong>：<code v-pre>Redis</code> 支持原子操作，能够保证多个操作的原子性，避免了多线程或多进程并发操作数据时可能出现的竞态条件。</p>\n</li>\n<li>\n<p><strong>客户端语言多</strong>：客户端可以支持的语言非常多，包括但不限于 <code v-pre>Cpp, Java, Python, Node.js...</code>，使用起来非常简单。</p>\n</li>\n<li>\n<p><strong>主从复制功能</strong>：提供了复制功能，实现了多个相同数据的 <code v-pre>Redis</code> 副本。</p>\n</li>\n<li>\n<p><strong>高可用</strong>：提供了哨兵机制，保证 <code v-pre>Redis</code> 的故障发现和故障自动转移。</p>\n</li>\n</ol>\n<p>总的来说，<code v-pre>Redis</code> 适用于需要高性能、低延迟、丰富数据结构和高可用性的应用场景，如缓存、实时数据分析、会话存储等。虽然在某些情况下使用传统的关系型数据库或自定义内存变量也可以实现类似的功能，但 <code v-pre>Redis</code> 提供了更好的性能和更丰富的功能。</p>\n<p>进程间通信，如果是单机，就需要通过管道或者共享内存等机制来传递数据。而如果涉及到多台主机，就会涉及到网络通信。而 <code v-pre>Redis</code> 就是基于网络把内存中数据交给别的进程甚至是其他主机中进程来使用，并且一般是基于分布式系统的。</p>\n<p><code v-pre>Redis</code> 经常会被作为：</p>\n<ul>\n<li>\n<p>存储数据的非关系实时数据库（具有更低的存储和更高的效率）</p>\n</li>\n<li>\n<p>使用 <code v-pre>session</code> 配合 <code v-pre>cookie</code> 实现会话管理...</p>\n</li>\n<li>\n<p>消息队列消息中间件（这里不是进程通信中的消息队列），是网络中的生产者消费者模型（知名的消息队列就有 <code v-pre>RabbitMQ、Kafka、RocketMQ</code> 等，不过 <code v-pre>Redis</code> 的不常使用，多是顺带方便才使用）</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 一开始是作为消息中间件（消息队列）的一个生产者-消费者模型解决方案，但是这种类似的解决方案已经有更优的方案了。</p>\n</div>\n</li>\n</ul>\n<p>但是也不是没有缺点的，比如在数据量大的场景中无法使用，受限于内存空间存储空间不大等。</p>\n<h2 id=\"_2-组件部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-组件部署\"><span>2.组件部署</span></a></h2>\n<p><a href=\"https://redis.io/docs/latest/operate/oss_and_stack/install/install-stack/apt/\" target=\"_blank\" rel=\"noopener noreferrer\">依照 Redis 官方文档即可下载 Redis</a>。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> lsb-release</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 以下指令可能过时, 推荐您看官方文档</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -fsSL</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/gpg</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --dearmor</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 644</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> echo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">$(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lsb_release</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -cs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tee</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/apt/sources.list.d/redis.list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>Redis</code> 也有经典的 <code v-pre>CS</code> 模式，因此需要启动服务。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 启动 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> enable</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-server</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> start</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-server</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>测试是否安装成功。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 测试 Redis</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>6379</code> 是 <code v-pre>Redis</code> 默认的服务端程序运行端口号。</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 官方其实是不推荐在 <code v-pre>Windows</code> 下使用 <code v-pre>Redis</code> 的，但是我们有些时候会在 <code v-pre>Windows</code> 下进行测试，因此就可以尝试在 <a href=\"https://github.com/MicrosoftArchive/redis/releases\" target=\"_blank\" rel=\"noopener noreferrer\">这个页面下安装 Redis</a>，对于简单的测试已经足够了。</p>\n</div>\n<h2 id=\"_3-组件基础\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-组件基础\"><span>3.组件基础</span></a></h2>\n<h3 id=\"_3-1-登录退出\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-1-登录退出\"><span>3.1.登录退出</span></a></h3>\n<p>登录方式和 <code v-pre>MySQL</code> 是一样的，可以在命令行使用客户端登录的方式，也可以只执行单条的命令，我们可以简单试试启动 <code v-pre>Redis</code> 的客户端。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Redis 的登录和退出</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 直接使用客户端登录并且使用</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -h</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6379</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # WebSocket 协议中, PING 和 PONG 是一种心跳机制, 服务器或客户端可以发送 PING, 而接收方会响应 PONG, 以确保连接存活</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hello</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exit</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 退出 Redis</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在命令行中只执行一次 Redis 的指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -h</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6379</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ping</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PONG</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>注意：<code v-pre>Redis</code> 其实在实际开发中是不会暴露给外界访问的，我们这里只不过是为了方便把配置文件改为 <code v-pre>0.0.0.0</code>，如果您只在本机操作 <code v-pre>redis</code> 则默认使用的是 <code v-pre>127.0.0.1</code> 地址，并且默认 <code v-pre>6379</code> 端口，此时可以直接省略 <code v-pre>-h</code> 和 <code v-pre>-p</code> 直接登录。</p>\n</div>\n<h3 id=\"_3-2-指令教程\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-指令教程\"><span>3.2.指令教程</span></a></h3>\n<p>我们先再来学几个指令尝尝鲜，这些指令在后面用到的概率也非常高，另外 <code v-pre>Redis</code> 的指令也可以无视对大小写。</p>\n<h4 id=\"_3-2-1-基础指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-基础指令\"><span>3.2.1.基础指令</span></a></h4>\n<h5 id=\"_3-2-1-1-set-get-del\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-1-set-get-del\"><span>3.2.1.1.SET, GET, DEL</span></a></h5>\n<p><code v-pre>set, get, del</code> 这三个指令非常简单，就是设置（修改）、获取、删除键值对。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 set, get, del</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">del</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> my_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：实际上还有更加方便可用的变种指令</p>\n<ul>\n<li><code v-pre>setex &lt;key_name&gt; &lt;seconds&gt; &lt;key_value&gt;</code> 可以直接使用秒作为单位设置 <code v-pre>key</code> 的过期时间</li>\n<li><code v-pre>setpx &lt;key_name&gt; &lt;milliseconds&gt; &lt;key_value&gt;</code> 可以直接使用毫秒作为单位设置 <code v-pre>key</code> 的过期时间</li>\n<li><code v-pre>setnx &lt;key_name&gt; &lt;key_value&gt;</code> 只在 <code v-pre>key</code> 不存在时才进行设置，即如果 <code v-pre>key</code> 之前已经存在，不执行设置</li>\n<li><code v-pre>setxx &lt;key_name&gt; &lt;key_value&gt;</code> 只在 <code v-pre>key</code> 存在时才进行设置，即如果 <code v-pre>key</code> 之前不存在，不执行设置</li>\n<li><code v-pre>mset &lt;key_name_1&gt; &lt;key_value_1&gt; &lt;key_name_2&gt; &lt;key_value_2&gt; ...</code> 一次设置多个键值对</li>\n<li><code v-pre>mget key_name_1 key_name_2</code> 一次获取多个键值</li>\n<li>另外 <code v-pre>del</code> 本身就支持删除多个键值对...</li>\n</ul>\n<p>这种一次性设置的指令通常会更受欢迎，因为可以减缓一些网络 <code v-pre>IO</code> 的代价。</p>\n</div>\n<h5 id=\"_3-2-1-2-keys-exists-scan\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-2-keys-exists-scan\"><span>3.2.1.2.KEYS, EXISTS, SCAN</span></a></h5>\n<p><code v-pre>keys</code> 指令可以根据一定的样式，或者匹配模式来查询对应的 <code v-pre>key</code> 值，查询的复杂度是 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>，而 <code v-pre>exists</code> 则可以查询 <code v-pre>key</code> 存在的个数，时间复杂度是 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 keys, exists</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 这个是 set 的升级版, 可以一次设置多个 key-value 对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询所有 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">backup2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_?</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_2 key_y 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 k2ey key_2 kkkkey key_1 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[13]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_3 这两个 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[^1]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询除了 key_1 以外的所有 key_2 key_w key_0 等 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_[0-3]</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 key_1 key_2 key_3 这三个 k-v 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找符合 key_1 的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key_2</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找符合 key_1, key_2 的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>keys</code> 的时间复杂度比较大，一般在实际工程中会直接禁用这个命令，否者一旦 <code v-pre>Redis</code> 在有大量的指令时，就会出现“卡住”的情况，这和 <code v-pre>Redis</code> 的架构设计本身是有关系的，后面再说...</p>\n</div>\n<p>还有一个比较高效的增量扫描 <code v-pre>scan</code> 指令，放回的数据是分批量的，即便是在单线程的情况下，也可以非阻塞返回大规模数据集，不会对 <code v-pre>Redis</code> 有很大的性能影响。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 scan</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> match</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> ## 0 代表游标, 是扫描的起始位置, 表示从当前 Redis 键空间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> ## 这里是因为数据量不大, 直接返回新的游标为 0 表示扫描完成, 如果数据量大会得到新的游标</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key_1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>可以看到 <code v-pre>keys</code> 是扫描整个键值空间，但是 <code v-pre>scan</code> 可以由用户指定游标进行增量扫描。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 也是有关于数据库的概念的，也就是 <code v-pre>Redis</code> 键空间。</p>\n</div>\n<h5 id=\"_3-2-1-3-expire-ttl\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-3-expire-ttl\"><span>3.2.1.3.EXPIRE, TTL</span></a></h5>\n<p><code v-pre>expire</code> 为指定的 <code v-pre>key</code> 值添加秒级的过期时间，返回 <code v-pre>1</code> 表示设置成功，返回 <code v-pre>0</code> 表示设置失败，并且可以对同一个 <code v-pre>key</code> 值反复使用达到修改过期时间的目的。而 <code v-pre> TTL</code> 则可以获取指定 <code v-pre>key</code> 值的过去时间，单位也是秒级，其返回值为 <code v-pre>任意数字</code> 表示距离过期时间所剩的秒数，<code v-pre>-1</code> 表示没有关联过期时间，<code v-pre>-2</code> 表示 <code v-pre>key</code> 不存在。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 expire, ttl</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置 key 的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 每一秒获取一次</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看已经不存在的 key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 重新设置一个 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> other_key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 再设置另外一个 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 为第一个 key 设置过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第一个 key 剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 7</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第一个 key 剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 4</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> other_key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 试图查看另外一个没有设置过期时间的 key 的剩余过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 再次重新设置 key 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 正常获取</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100000</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置比较大的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看剩余的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 99994</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">expire</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 重新设置过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ttl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 检查现在的过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 9</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：实际上 <code v-pre>expire, ttl</code> 都有支持毫秒版本的 <code v-pre>pexpire, pttl</code>，使用方法类似。</p>\n</div>\n<h5 id=\"_3-2-1-4-type\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-4-type\"><span>3.2.1.4.TYPE</span></a></h5>\n<p><code v-pre>type</code> 也很简单，可以返回 <code v-pre>key</code> 值的数据类型，返回值有 <code v-pre>none, string, list, set, zset, hash, stream...</code> 其实就对应后面数据类型。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 type</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"100\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">string</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-2-1-5-incr-incrby-decr-decrby-incrbyfloar\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-5-incr-incrby-decr-decrby-incrbyfloar\"><span>3.2.1.5.INCR, INCRBY, DECR, DECRBY, INCRBYFLOAR</span></a></h5>\n<p><code v-pre>incr</code> 可以用来给一个字符串类型的实数进行 <code v-pre>+1</code> 操作，哪怕这个 <code v-pre>key</code> 值之前不存在，也会从 <code v-pre>0</code> 开始加起。<code v-pre>incrby</code> 也是类似，但是加上用户指定的整数值（注意只能是整数），不存在时，该 <code v-pre>key</code> 也是从 <code v-pre>0</code> 开始加起。而 <code v-pre>decr</code> 和 <code v-pre>decrby</code> 和前面两者类似，只不过是变成减而已。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：顺口一提上述关于 <code v-pre>...by</code> 的指令都可以使用负数作为操作数。</p>\n</div>\n<p>对于浮点数来说，只使用一个指令 <code v-pre>incrbyfloat</code> 就够了，功能也是类似的，加减使用正负实数调控就行。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 incr, incrby, decr, decrby, incrbyfloat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incr</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">exists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 4</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"4\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incrby</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrby</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 9</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># decr</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">decr</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 8</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># decrby</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">decrby</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># incrbyfloat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrbyfloat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 5.6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"9.6\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incrbyfloat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -3.10.33</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"-0.73\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-2-1-6-append-getrange-setrange-strlen\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-1-6-append-getrange-setrange-strlen\"><span>3.2.1.6.APPEND, GETRANGE, SETRANGE, STRLEN</span></a></h5>\n<p>还可以对字符串进行操作，这些也比较简单...</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 append, getrange, setrange, strlen</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置初始字符串值到键 mykey</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ok</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取键 mykey 的值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">append</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> world</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 向 mykey 键追加字符串 \" world\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取追加后的 mykey 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello world\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 值中从索引 0 到 4 的子串</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 值中从索引 6 到 10 的子串</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"world\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">redis</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置 mykey 中从索引 6 开始的新值为 \"redis\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 setrange 操作后的 mykey 值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"hello redis\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">strlen</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mykey</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取 mykey 字符串的长度</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 11</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：这些指令都很简单，如果您需要了解更多，可以 <a href=\"https://redis.io/docs/latest/develop/get-started/\" target=\"_blank\" rel=\"noopener noreferrer\">前往 Redis 的官网中查看</a>，不过由于我们使用 <code v-pre>Redis</code> 的大部分场景都是在代码中直接进行编程（除了一些运维人员、测试人员可能需要非常了解进行必要的检查以外），因此没有必要了解得特别细（除非需要使用）...</p>\n</div>\n<h4 id=\"_3-2-2-模块指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-模块指令\"><span>3.2.2.模块指令</span></a></h4>\n<p>除了基础的对于数据类型的操作指令，还有一些不同模块的指令，有需要再进行学习，不过这里先列出来：</p>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：模块默认不直接内嵌到 <code v-pre>redis service</code> 中，因此需要您下载 <code v-pre>Redis</code> 的拓展 <code v-pre>Redis Stack</code> 才能使用。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装 Redis Stack</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 停止传统的 Redis 服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> stop</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查是否停止 Redis 服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Could</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> not</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> to</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> at</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:6379:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Connection</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> refused</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">not</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> connecte</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">d</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> exit</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开始安装 Redis Stack</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> lsb-release</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> curl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -fsSL</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/gpg</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> gpg</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --dearmor</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 644</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/keyrings/redis-archive-keyring.gpg</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> echo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">$(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lsb_release</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -cs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tee</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/apt/sources.list.d/redis.list</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 由于我使用的是 Ubuntu24.04(这个时候比较新), 因此我需要使用二进制进行下载, 而无法使用包管理安装...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在 https://redis.io/downloads/#redis-stack-downloads 底部获取你所需要的安装链接</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> wget</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://packages.redis.io/redis-stack/redis-stack-server-7.4.0-v1.jammy.x86_64.tar.gz</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mv</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server-7.4.0-v1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sh</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-stack-server/bin/redis-stack-server</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 此时就会启动输出...您可以开始测试是否已运行该服务...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 打开另外一个终端开始测试</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-cli</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MODULE</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LIST</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">RedisCompat</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/rediscompat.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">redisgears_2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20020</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisgears.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">v8-plugin-path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/libredisgears_v8_plugin.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">search</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 21005</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisearch.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MAXSEARCHRESULTS</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MAXAGGREGATERESULTS</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bf</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20802</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redisbloom.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ReJSON</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 20803</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/rejson.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">timeseries</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ver</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 11202</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">path</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/home/ljp/temp/redis-stack-server/lib/redistimeseries.so</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">args</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> array</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 有比较多的回显就是配置成功了</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div>\n<h5 id=\"_3-2-2-1-redisearch-ft\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-1-redisearch-ft\"><span>3.2.2.1.RediSearch(<code v-pre>FT</code>)</span></a></h5>\n<p>主要用于全文搜索和数据索引功能，核心命令如：</p>\n<ul>\n<li><code v-pre>FT.CREATE</code>、<code v-pre>FT.ADD</code>、<code v-pre>FT.SEARCH</code>：创建索引、添加文档、搜索查询</li>\n<li><code v-pre>FT.AGGREGATE</code>：执行聚合查询</li>\n<li><code v-pre>FT.DROPINDEX</code>、<code v-pre>FT.SYNUPDATE</code> 等</li>\n</ul>\n<h5 id=\"_3-2-2-2-redisjson-json\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-2-redisjson-json\"><span>3.2.2.2.RedisJSON(<code v-pre>JSON</code>)</span></a></h5>\n<p><code v-pre>RedisJSON</code> 模块用于在 <code v-pre>Redis</code> 中存储和操作 <code v-pre>JSON</code> 数据类型，核心命令如：</p>\n<ul>\n<li><code v-pre>JSON.SET</code>：设置 <code v-pre>JSON</code> 数据</li>\n<li><code v-pre>JSON.GET</code>：获取 <code v-pre>JSON</code> 数据</li>\n<li><code v-pre>JSON.DEL</code>：删除 <code v-pre>JSON</code> 键</li>\n<li><code v-pre>JSON.MGET</code>：从多个键中获取 <code v-pre>JSON</code> 值</li>\n</ul>\n<h5 id=\"_3-2-2-3-redisgraph-graph\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-3-redisgraph-graph\"><span>3.2.2.3.RedisGraph(<code v-pre>GRAPH</code>)</span></a></h5>\n<p>RedisGraph 提供了图数据库功能，用于图数据的存储和查询，核心命令如：</p>\n<ul>\n<li><code v-pre>GRAPH.QUERY</code>：使用 <code v-pre>Cypher</code> 查询语言执行查询。</li>\n<li><code v-pre>GRAPH.PROFILE</code>：分析查询性能。</li>\n<li><code v-pre>GRAPH.DELETE</code>：删除图。</li>\n</ul>\n<h5 id=\"_3-2-2-4-redis-timeseries-ts\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-4-redis-timeseries-ts\"><span>3.2.2.4.Redis TimeSeries(<code v-pre>TS</code>)</span></a></h5>\n<p><code v-pre>RedisTimeSeries</code> 是用于存储和分析时间序列数据的模块，核心命令如：</p>\n<ul>\n<li><code v-pre>TS.CREATE</code>：创建时间序列</li>\n<li><code v-pre>TS.ADD</code>：添加时间序列数据点</li>\n<li><code v-pre>TS.RANGE</code>、<code v-pre>TS.MRANGE</code>：查询时间范围内的数据</li>\n<li><code v-pre>TS.ALTER</code>：修改时间序列元数据</li>\n</ul>\n<h5 id=\"_3-2-2-5-redisai-ai\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-5-redisai-ai\"><span>3.2.2.5.RedisAI(<code v-pre>AI</code>)</span></a></h5>\n<p><code v-pre>RedisAI</code> 用于在 <code v-pre>Redis</code> 中运行机器学习模型，支持 <code v-pre>TensorFlow, PyTorch, ONNX...</code> 模型，核心命令如：</p>\n<ul>\n<li><code v-pre>AI.MODELSET</code>：加载机器学习模型</li>\n<li><code v-pre>AI.MODELRUN</code>：运行机器学习模型</li>\n<li><code v-pre>AI.SCRIPTSET</code>：设置自定义脚本</li>\n<li><code v-pre>AI.TENSORSET</code> 和 <code v-pre>AI.TENSORGET</code>：处理张量数据</li>\n</ul>\n<h5 id=\"_3-2-2-6-redisbloom-bf-cf-cms-topk\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-2-6-redisbloom-bf-cf-cms-topk\"><span>3.2.2.6.RedisBloom(<code v-pre>BF</code>, <code v-pre>CF</code>, <code v-pre>CMS</code>, <code v-pre>TOPK</code>)</span></a></h5>\n<p><code v-pre>RedisBloom</code> 提供了<code v-pre>布隆过滤器, 计数最小堆, Cuckoo Filter, TopK...</code> 等数据类型，适合处理大数据集合。</p>\n<ul>\n<li><strong>布隆过滤器</strong> (<code v-pre>BF</code>)：<code v-pre>BF.ADD</code>、<code v-pre>BF.EXISTS</code></li>\n<li><strong>Cuckoo Filter</strong> (<code v-pre>CF</code>)：<code v-pre>CF.ADD</code>、<code v-pre>CF.EXISTS</code></li>\n<li><strong>Count-Min Sketch</strong> (<code v-pre>CMS</code>)：<code v-pre>CMS.INCRBY</code>、<code v-pre>CMS.QUERY</code></li>\n<li><strong>TopK</strong>：<code v-pre>TOPK.ADD</code>、<code v-pre>TOPK.QUERY</code></li>\n</ul>\n<p>这些模块可以根据场景进行组合使用，以增强 <code v-pre>Redis</code> 数据库的功能，从而更高效地处理搜索、图数据、时间序列分析和机器学习任务。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：由于有需要我补充这部分内容。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 RediSearch 和 RedisJSON 的相关指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">FT.CREATE</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置添加索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">idx:bicycle</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置索引名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ON</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> JSON</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 表示针对</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> JSON</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 的索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">PREFIX</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 仅对具有</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 前缀的键创建索引</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">这里的数字代表可以设置多个前缀</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCORE</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 为该索引设置评分</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">用于索引之间进行评分比较</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCHEMA</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 后面定义字段的模式</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.brand</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> brand</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.model </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> model</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.description </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> description</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> TEXT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> WEIGHT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.price </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> price</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> NUMERIC</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">$.condition </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">AS</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">TAG </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SEPARATOR</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置标签, 用于分割不同 JSON 对象</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完整一行指令为 FT.CREATE idx:bicycle ON JSON PREFIX 1 bicycle: SCORE 1.0 SCHEMA $.brand AS brand TEXT WEIGHT 1.0 $.model AS model TEXT WEIGHT 1.0 $.description AS description TEXT WEIGHT 1.0 $.price AS price NUMERIC $.condition AS condition TAG SEPARATOR \",\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 上述描述的就是一个 JSON 对象的集合</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#   \"bicycle:xxx\": {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"brand\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"model\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"description\": \"\",</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"price\": 0,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#     \"condition\": \"\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#   },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 可以使用 FT.INFO idx:bicycle 查看配置结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置 \"键名-JSON:\" 对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.SET</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 存储在根处,</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 也可以是只设置字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: 270, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\\</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">, </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">: </span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">}\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完整指令为 JSON.SET \"bicycle:0\" \".\" \"{\\\"brand\\\": \\\"Velorim\\\", \\\"model\\\": \\\"Jigger\\\", \\\"price\\\": 270, \\\"description\\\": \\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\\\u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\", \\\"condition\\\": \\\"new\\\"}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 获取键对应 JSON 的某个字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.GET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.brand</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.price</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:[</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">],</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$.price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:[270]}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 更新键对应 JSON 的某个字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.SET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:1234</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $ </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">{\"price\": 600}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查卡键对应 JSON 的所有字段‘</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">JSON.GET</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bicycle:0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:270,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">}\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 不过我们使用的是 JSON.GET, 如果使用 FT.SEARCH 还能用于执行基于全文索引的搜索查询, 它结合了索引、评分、排序和过滤功能, 可以用于复杂的搜索操作...</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 FT 的查询</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">FT.SEARCH</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">idx:bicycle</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LIMIT</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) (</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bicycle:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">$</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">{</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">brand</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Velorim</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">model</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Jigger</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">price</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:270,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">description</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">condition</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">new</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>更多待补充...</p>\n</div>\n<h4 id=\"_3-2-3-自定指令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-3-自定指令\"><span>3.2.3.自定指令</span></a></h4>\n<p>除了已有的基础指令和模块指令，还可以使用 <code v-pre>Lua</code> 脚本代码编写出用户自己定义的指令，待补充...</p>\n<h3 id=\"_3-3-数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-数据类型\"><span>3.3.数据类型</span></a></h3>\n<h4 id=\"_3-3-1-数据类型分类\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-1-数据类型分类\"><span>3.3.1.数据类型分类</span></a></h4>\n<p>知道前面的基础指令后，就可以知道 <code v-pre>Redis</code> 是一个跨语言的大号键值对存储数据库，但是除了简单的字符类型以外，键位对应的值还可以是其他数据类型，主要的数据类型有一下六种。</p>\n<ul>\n<li><strong>字符 String</strong> 最基本的数据类型，支持二进制安全的字符串</li>\n<li><strong>列表 List</strong> 按插入顺序存储的字符串列表，支持从两端推入和弹出操作</li>\n<li><strong>无权集合 Set</strong> 无序无权字符串集合，不允许重复元素</li>\n<li><strong>带权集合 Zset</strong> 有序有权字符串集合，保留集合无序不可重复的特点，但每个成员都有一个与之关联的分数（是允许重复的浮点数），并可以按分数排序</li>\n<li><strong>键值集合 Hash</strong> 键值对的集合，适用于存储对象的字段和对应的值，也可以叫哈希，这意味着键对应的值也可以是一系列键值对（有点套娃）</li>\n<li><strong>空值 None</strong> 当键值对不存在时的一种特殊类型</li>\n</ul>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：也有一些比较高级的类型，有很多是字符类型演变而来。</p>\n<ul>\n<li><strong>位图 bitmap</strong> 可以看作是一种压缩的数据类型，按位存储数据</li>\n<li><strong>地理位置 geospatial</strong> 用于存储地理位置数据并进行地理空间查询</li>\n<li><strong>流 stream</strong> 用于存储和管理日志数据、消息队列等类型的数据，流的条目按时间戳进行排序</li>\n<li><strong>基数 HyperLogLog</strong> 用于统计某个数据流中不重复元素的数量（如果您的需求是要 <strong>存储所有的元素并进行操作</strong>，那么 <code v-pre>Set</code> 是合适的选择；如果您只是需要 <strong>估算独立元素的数量</strong>，且不关心精确值，那么 <code v-pre>Hyper LogLog</code> 会更高效）</li>\n<li>...</li>\n</ul>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：流的存在，使得 <code v-pre>Redis</code> 可以简单充当一个消息队列，但是这不是 <code v-pre>Redis</code> 的主要应用场景。不过这可以作为中小型项目的消息队列组件，尤其是在已经引入 <code v-pre>Redis</code> 时，可以快速把 <code v-pre>Redis</code> 作为消息队列，减低系统复杂度。</p>\n</div>\n<h4 id=\"_3-3-2-外部数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-外部数据类型\"><span>3.3.2.外部数据类型</span></a></h4>\n<h5 id=\"_3-3-2-1-string-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-1-string-的基本操作\"><span>3.3.2.1.String 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># String</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystring</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hello</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystring</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">string</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-2-list-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-2-list-的基本操作\"><span>3.3.2.2.List 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># List</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lpush</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询列表所有元素, 0 表示最先一个元素, -1 表示最后一个元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">lrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询 mylist [1] 处的元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">item2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mylist</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">list</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 除此以外还有阻塞版本的指令, 例如 blpop 和 brpop</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在有数据的情况下行为与 lpop 和 rpop 一致</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 但无数据的情况下 lpop 和 rpop 会立刻返回 nil, 客户端呈现请求阻塞状态, 且期间 Redis 可以继续执行其他指令, 如果超出设定的 timeout 也会返回 nil</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-3-set-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-3-set-的基本操作\"><span>3.3.2.3.Set 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Set</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">smembers</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sismember</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sismember</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 表示不存在这个元素</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">set</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Redis 除了支持增删查改的基础操作, 也支持交集(sinterstore/sinter)、并集(sunionstore/sunion)、差集(sdiffstore/sdiff)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-2-4-zset-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-4-zset-的基本操作\"><span>3.3.2.4.Zset 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Zset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 添加</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 添加成功个数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查询</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zcrd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 3</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # zset 的元素个数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrange</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查找是否存在元素并且返回排名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zrank</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">member1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myzset</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zset</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 除此以外还有一些额外的选项</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [XX | NX]: 仅仅⽤于更新已经存在的元素, 不会添加新元素; 仅⽤于添加新元素，不会更新已经存在的元素</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [GT | LT]: Greater Than, 表示“大于”, 通常用于范围查询中, 表示取值大于某个指定的值; Less Than, 表示“小于”, 通常用于范围查询中, 表示取值小于某个指定的值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [CH]: 默认情况下, ZADD 返回的是本次添加的元素个数, 但指定这个选项之后, 就会还包含本次更新的元素的个数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ZADD key [INCR]: 此时命令类似 ZINCRBY 的效果, 将元素的分数加上指定的分数, 此时只能指定⼀个元素和分数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 也支持集合, 并且是聚合集合</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>ZINTERSTORE</code> 是 <code v-pre>Redis</code> 的一个命令，用于对多个有序集合（<code v-pre>ZSET</code>）进行交集操作，并将结果存储到指定的目标集合中。具体来说，<code v-pre>ZINTERSTORE</code> 会计算多个有序集合的交集，并根据权重和聚合方式合并它们的分数，然后将结果保存在指定的目标集合中。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 聚合搜索</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zinterstore</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> destination</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> numkeys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [key </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">...]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [weights </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">weight</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [weight </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">...]]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [aggregate </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sum</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> min</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> |</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> max</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (1) destination: 目标集合的名称，交集的结果将存储在这个集合中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (2) numkeys: 输入的有序集合的数量(key 的数量)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (3) key [key ...]: 参与交集操作的多个有序集合的键名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (4) weights weight [weight ...]: 可选参数, 指定每个集合的权重(默认权重为 1), 如果提供了权重, Redis 会按权重计算每个集合中的元素分数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># (5) aggregate &#x3C;sum | min | max>: 可选参数, 指定合并多个集合元素时如何聚合它们的分数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# sum 表示分数相加(默认)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# mim 表示取最小值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">\t# max 表示取最大值</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></div>\n<h5 id=\"_3-3-2-5-hash-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-5-hash-的基本操作\"><span>3.3.2.5.Hash 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Hash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hset</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hkeys</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取哈希中的所有字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hvals</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 获取哈希中的所有值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hexists</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> field2</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 检查某个字段是否存在于哈希中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myhash</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">hash</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 内部的哈希通常被称为 <code v-pre>field-value</code> 对，这主要是为了和 <code v-pre>Readis</code> 本身的 <code v-pre>key-value</code> 做区分。</p>\n</div>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：使用 <code v-pre>HGETALL</code> 获取哈希元素个数过多时，就有可能阻塞 <code v-pre>Redis</code>，这种情况下可以使用 <code v-pre>HSCAN</code> 扫描指令。</p>\n</div>\n<h5 id=\"_3-3-2-6-none-的基本操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-2-6-none-的基本操作\"><span>3.3.2.6.None 的基本操作</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># None</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> non_existing_key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">none</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-3-3-高级数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-高级数据类型\"><span>3.3.3.高级数据类型</span></a></h4>\n<p>下面补充一些高级数据类型的使用。</p>\n<h5 id=\"_3-3-3-1-bitmap\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-1-bitmap\"><span>3.3.3.1.Bitmap</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Bitmap</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置第 7 位为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">setbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置第 2 位为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第 7 位设置的比特值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getbit</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查看第 7 位设置的比特值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bitcount</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mybitmap</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 统计位图中总共有多少个设置为 1 的比特位</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 2</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-2-geospatial\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-2-geospatial\"><span>3.3.3.2.Geospatial</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Geospatial</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geoadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 13.361389</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 38.115556</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 设置一个地理位置, 这里设置了经纬度和地名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geoadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 15.087269</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 37.502669</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geopos</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询某个位置的经纬度</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">13.36138933897018433</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">38.11555639549629859</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">geodist</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Palermo</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> km</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询两个地点之间的距离, 以 km 单位</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"166.2742\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">georadius</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> myplaces</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 15</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 37</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> km</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 查询以经纬度 15, 37 为中心, 半径为 100km 的所有地名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Catania</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-3-stream\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-3-stream\"><span>3.3.3.3.Stream</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Stream</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 添加流</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 添加流的指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 设置流的名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              *</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 代表由</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 自己生成时间戳</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">              name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 18</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 代表流存储的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358298361-0\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每条消息都有一个唯一的 ID, 这个 ID 由两部分组成, 使用 - 分隔</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 第一部分是一个时间戳(毫秒级), 表示消息被写入流的时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 第二部分是一个序列号, 用来区分同一时间戳下的不同消息(为了区分同时间戳)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358303994-0\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xadd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> age</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 20</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"1723358311147-0\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查询流</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">keys</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 0 表示从流的开始读取所有的消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358298361-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">18</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358303994-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> $ </span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># $ 表示从最新的数据开始读取所有的消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358311147-0</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 直接使用流 ID 查询就是读取该 ID 之后的所有消息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358303994-0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">xread</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> count</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> streams</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mystream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 1723358298361-0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mystream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358303994-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">      2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1723358311147-0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">         2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">gimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">20</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 这种情况下是直接消费数据的, 并且数据不会因为消费消失</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-3-4-hyperloglog\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-3-4-hyperloglog\"><span>3.3.3.4.HyperLogLog</span></a></h5>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># HyperLogLog</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">PFADD</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ip_set</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\ </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">#</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 这个是重复的</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> IP</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 地址</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                \"192.168.0.4\"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">                \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">192.168.0.5</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 完整指令为 PFADD ip_set \"192.168.0.1\" \"192.168.0.2\" \"192.168.0.3\" \"192.168.0.1\" \"192.168.0.4\" \"192.168.0.5\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">PFCOUNT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ip_set</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 5</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：不知道您有没有发现很相当大的一部分数据类型是由 <code v-pre>string</code> 这个类型衍生出来的，因此如果需要细学其他的类型，就必须先对 <code v-pre>string</code> 有足够的理解，首先您至少需要知道几件事：</p>\n<ul>\n<li>\n<p>所有的键名类型都是字符类型</p>\n</li>\n<li>\n<p>字符串类型的键值可以单纯是（但是一个字符串的最大值不能是 <code v-pre>512MB</code>）：</p>\n<ul>\n<li>字符串</li>\n<li>一般格式的 <code v-pre>JSON</code></li>\n<li>一般格式的 <code v-pre>XML</code></li>\n<li>数字</li>\n<li>二进制流</li>\n</ul>\n</li>\n<li>\n<p><code v-pre>Redis</code> 内部存储的字符串是完全按照二进制流的形式保存的，所以不需要处理字符集编码，客户端传入的是什么字符集就存储什么</p>\n</li>\n</ul>\n</div>\n<h4 id=\"_3-3-4-内部数据类型\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-内部数据类型\"><span>3.3.4.内部数据类型</span></a></h4>\n<p>实际上 <code v-pre>Redis</code> 针对每一种数据类型都有自己的底层内部编码实现，而且是多种实现，这样 <code v-pre>Redis</code> 就会根据合适的场景选择合适的内部编码，例如下表（除去空类型剩下的五个类型）。</p>\n<table>\n<thead>\n<tr>\n<th><strong>数据类型</strong></th>\n<th><strong>内部编码</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>String</td>\n<td><code v-pre>raw(&gt;=39byte), int(8 byte), embstr(&lt;=39byte)</code></td>\n</tr>\n<tr>\n<td>List</td>\n<td><code v-pre>linkedlist, ziplist</code></td>\n</tr>\n<tr>\n<td>Set</td>\n<td><code v-pre>hashtable, intset</code></td>\n</tr>\n<tr>\n<td>Zset</td>\n<td><code v-pre>skiplist, ziplist</code></td>\n</tr>\n<tr>\n<td>Hash</td>\n<td><code v-pre>hashtable, ziplist</code></td>\n</tr>\n</tbody>\n</table>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：我们可以通过 <code v-pre>object encoding 键名</code> 查询此时键的内部编码。</p>\n</div>\n<p><code v-pre>Redis</code> 这样设计有两个好处：</p>\n<ul>\n<li>方便 <code v-pre>Redis</code> 未来改进内部编码，而对外的数据类型和命令没有任何影响，这样可以开发出更优秀的内部编码</li>\n<li>多种内部编码实现可以在不同场景下发挥各自的优势，例如 <code v-pre>ziplist</code> 比较节省内存，但是在列表元素比较较多的情况下，性能会下降，这时候 <code v-pre>Redis</code> 会根据配置选项将列表类型的内部实现转换为 <code v-pre>linkedlist</code>，整个过程用户是全无感知的</li>\n</ul>\n<h5 id=\"_3-3-4-1-string-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-1-string-的内部编码\"><span>3.3.4.1.String 的内部编码</span></a></h5>\n<p>尤其是字符串类型，内部编码至少有三种，<code v-pre>Redis</code> 会自动根据当前的值来决定使用哪一种内部编码进行实现。</p>\n<ul>\n<li>\n<p><strong>int(8byte 的长整型)</strong></p>\n</li>\n<li>\n<p><strong>embstr(&lt;= 39byte 的字符串)</strong></p>\n</li>\n<li>\n<p><strong>raw(&gt; 39byte 的字符串)</strong></p>\n</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查看 string 内部编码的变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 123</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"int\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> limou</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"embstr\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> limou343434343434343434343434343434343434343434343434343434343434</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">0.0.0.0:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> encoding</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"raw\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-4-2-list-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-2-list-的内部编码\"><span>3.3.4.2.List 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：下面两个条件同时满足时</p>\n<ul>\n<li>列表元素个数小于 <code v-pre>list-max-ziplist-entries</code> 配置（默认 <code v-pre>512</code> 个）</li>\n<li>列表元素长度小于 <code v-pre>list-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会使用压缩列表（<code v-pre>ziplist</code>）作为列表的内部编码方式，从而减少内存消耗</p>\n</li>\n<li>\n<p><strong>linkedlist(链表)</strong>：当哈希类型无法满足 <code v-pre>ziplist</code> 的条件时，<code v-pre>Redis</code> 会使⽤ <code v-pre>hashtable</code> 作为哈希的内部实现，<code v-pre>Redis</code> 会选择使用 <code v-pre>linkedlist</code> 作为列表的内部实现。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-3-set-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-3-set-的内部编码\"><span>3.3.4.3.Set 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>intset(整数集合)</strong>：</p>\n<ul>\n<li>集合元素的个数小于 <code v-pre>set-max-intset-entries</code> 配置（默认最大 <code v-pre>512</code> 个元素）</li>\n<li>集合元素值都是整数</li>\n</ul>\n<p><code v-pre>Redis</code> 会使用 <code v-pre>intset</code> 作为集合的内部实现，<code v-pre>intset</code> 是一个专门优化整数集合的压缩结构，可以显著减少内存使用。</p>\n</li>\n<li>\n<p><strong>hashtable(哈希表)</strong>：当列表类型无法满足 <code v-pre>intset</code> 的条件时，<code v-pre>Redis</code> 会使用 <code v-pre>hashtable</code> 作为集合的内部实现。<code v-pre>hashtable</code> 提供了高效的插入、查找和删除操作，适用于较大的集合。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-4-zset-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-4-zset-的内部编码\"><span>3.3.4.4.Zset 的内部编码</span></a></h5>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：</p>\n<ul>\n<li>集合元素的个数小于 <code v-pre>zset-max-ziplist-entries</code> 配置（默认 <code v-pre>128</code> 个）</li>\n<li>每个元素的值都小于 <code v-pre>zset-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会⽤ <code v-pre>ziplist</code> 来作为有序集合的内部实现，<code v-pre>ziplist</code> 可以有效减少内存消耗</p>\n</li>\n<li>\n<p><strong>skiplist(跳表)</strong>：当 <code v-pre>ziplist</code> 条件不满足时，有序集合会使用 <code v-pre>skiplist</code> 作为内部实现，因为此时 <code v-pre>ziplist</code> 的操作效率会下降。</p>\n</li>\n</ul>\n<h5 id=\"_3-3-4-5-hash-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-5-hash-的内部编码\"><span>3.3.4.5.Hash 的内部编码</span></a></h5>\n<p>哈希本身的内部编码变化也值得我们关注，内部的编码实现至少有两种 <code v-pre>ziplist(压缩列表), hashtable(哈希表)</code>，这就比字符串要复杂一些。</p>\n<ul>\n<li>\n<p><strong>ziplist(压缩列表)</strong>：下面两个条件同时满足时</p>\n<ul>\n<li>哈希元素个数小于 <code v-pre>hash-max-ziplist-entries</code> 配置（默认 <code v-pre>512</code> 个）</li>\n<li>哈希元素值都小于 <code v-pre>hash-max-ziplist-value</code> 配置（默认 <code v-pre>64</code> 字节）</li>\n</ul>\n<p><code v-pre>Redis</code> 会使⽤ <code v-pre>ziplist</code> 作为哈希的内部实现，<code v-pre>ziplist</code> 使用更加紧凑的结构实现多个元素的连续存储，所以在节省内存方面比 <code v-pre>hashtable</code> 更加优秀。</p>\n</li>\n<li>\n<p><strong>hashtable(哈希表)</strong>：当哈希类型无法满足 <code v-pre>ziplist</code> 的条件时，<code v-pre>Redis</code> 会使⽤ <code v-pre>hashtable</code> 作为哈希的内部实现，因为此时 <code v-pre>ziplist</code> 的读写效率会下降，而 <code v-pre>hashtable</code> 的读写时间复杂度为 <code v-pre>O(1)</code>。</p>\n</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 查看 Hash 内部编码的变化(略)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h5 id=\"_3-3-4-6-none-的内部编码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-6-none-的内部编码\"><span>3.3.4.6.None 的内部编码</span></a></h5>\n<p>待补充...</p>\n<h4 id=\"_3-3-4-数据类型原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-3-4-数据类型原理\"><span>3.3.4.数据类型原理</span></a></h4>\n<p>待补充...</p>\n<h3 id=\"_3-4-渐进遍历\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-4-渐进遍历\"><span>3.4.渐进遍历</span></a></h3>\n<p><code v-pre>Redis</code> 提供了 <code v-pre>SCAN</code> 命令，允许用户以渐进式的方式进行键的遍历，避免了阻塞操作，适用于遍历大量数据的场景。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">SCAN</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [TYPE </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">type]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># cursor: 游标，初始值为 `0`，返回的游标值指示下次扫描的位置。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># MATCH pattern: 可选参数，用于过滤键名，支持模式匹配（类似于 `glob` 模式）。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># COUNT count: 可选参数，建议每次返回的元素数量。并不是严格的数量限制，实际返回数量可能会有所不同。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># TYPE type: 可选参数，指定键的类型（如 `string`, `list`, `set`, `zset`, `hash` 等）。</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>SCAN</code> 命令的时间复杂度是常数时间 <span v-pre class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>，但遍历大数据集时，实际的时间复杂度会受到 <code v-pre>MATCH</code> 和 <code v-pre>COUNT</code> 参数的影响。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:637</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">9></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">17</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:12</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:8</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:4</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:14</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:16</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:17</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:15</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:10</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   9</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   10</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:7</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 127.0.0.1:637</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">9></span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> scan</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 17</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) 1) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:5</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:18</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:19</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:13</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   7</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:6</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:9</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">   9</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key:11</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><code v-pre>Redis</code> 还为不同数据类型提供了相应的 <code v-pre>SCAN</code> 命令变种，功能与 <code v-pre>SCAN</code> 基本类似：</p>\n<ul>\n<li><strong>hscan</strong>: 用于扫描哈希类型的数据。</li>\n<li><strong>sscan</strong>: 用于扫描集合类型的数据。</li>\n<li><strong>zscan</strong>: 用于扫描有序集合类型的数据。</li>\n</ul>\n<p>它们的语法和使用方式与 <code v-pre>SCAN</code> 相同，只是针对特定类型的数据进行扫描。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zscan</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> key</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cursor</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [MATCH </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pattern]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [COUNT </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count]</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>scan</code> 在使用过程中也有值得注意的地方。</p>\n<ul>\n<li>\n<p><strong>渐进性遍历</strong>：<code v-pre>SCAN</code> 命令是渐进式的，它不会一次性返回所有数据，而是通过多次调用来遍历数据。每次返回部分数据，并返回一个游标，指示下一次扫描的位置。</p>\n</li>\n<li>\n<p><strong>遍历期间的数据变化</strong>：在扫描期间，如果 <code v-pre>Redis</code> 数据发生变化（例如增加、修改或删除键），可能会导致以下问题：</p>\n<ul>\n<li><strong>重复遍历</strong>：某些键可能会被扫描多次</li>\n<li><strong>遗漏数据</strong>：某些键可能会被遗漏</li>\n</ul>\n<p>因此，在使用 <code v-pre>SCAN</code> 命令时，开发者应考虑到数据可能会在遍历过程中发生变化的情况。</p>\n</li>\n</ul>\n</div>\n<h3 id=\"_3-5-键值空间\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-5-键值空间\"><span>3.5.键值空间</span></a></h3>\n<p>与 <code v-pre>MySQL</code> 等关系型数据库不同的是，<code v-pre>Redis</code> 没有表、字段这种命名空间，而且也没有对键名有强制要求（除了不能使用一些特殊字符）。但设计合理的键名，有利于防止键冲突和项目的可维护性，比较推荐的方式是使用 <mark>&quot;业务名:对象名:唯一标识:属性&quot;</mark> 作为键名。例如 <code v-pre>MySQL</code> 的数据库名为 <code v-pre>vs</code>，用户表名为 <code v-pre>user_info</code>，那么对应的键 <code v-pre>name</code> 可以使用 <code v-pre>&quot;vs:user_info:6379:name&quot;</code> 来表示，如果当前 <code v-pre>Redis</code> 只会被⼀个业务使用，可以省略业务名 <code v-pre>&quot;vs:&quot;</code>。</p>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>注意：键名过长也会影响到 <code v-pre>Redis</code> 的性能。</p>\n</div>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>Redis</code> 中虽然支持持多数据库，但随着版本的升级，其实不是特别建议使⽤多数据库特性。如果真的需要完全隔离的两套键值对，更好的做法是维护多个 <code v-pre>Redis</code> 实例，而不是在⼀个 <code v-pre>Redis</code> 实例中维护多数据库。这是因为本身 <code v-pre>Redis</code> 并没有为多数据库提供太多的特性，其次无论是否有多个数据库，<code v-pre>Redis</code> 都是使用单线程模型，所以彼此之间还是需要排队等待命令的执行。同时多数据库还会让开发、调试和运维⼯作变得复杂。所以实践中，始终使用数据库 <code v-pre>0</code> 其实是⼀个很好的选择。</p>\n</div>\n<div class=\"hint-container caution\">\n<p class=\"hint-container-title\">警告</p>\n<p>警告：<code v-pre>flushdb/flushall</code> 命令用于清除数据库，区别在于 <code v-pre>flushdb</code> 只清除当前数据库，<code v-pre>flushall</code> 会清理所有数据库（这些行为很接近删库）。</p>\n</div>\n<h3 id=\"_3-6-设计架构\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-6-设计架构\"><span>3.6.设计架构</span></a></h3>\n<p>实际上 <code v-pre>Redis</code> 采用的是单线程的架构，但是为什么采用单线程还能这么快呢？主要原因如下：</p>\n<ul>\n<li>纯内存访问，这是最重要的一点，工作环境和 <code v-pre>MySQL</code> 等持久化数据库完全不一样</li>\n<li>非阻塞 <code v-pre>IO</code> 模型，底层用 <code v-pre>epoll</code> 的 <code v-pre>ET</code> 模式，无论时连接、读写、关闭都被转化为事件来处理，因此不会在网络 <code v-pre>IO</code> 上浪费太多时间</li>\n<li>单线程模型，无论客户端如何操作，在微观上一定时存在时间差的，因此就避免了线程切换开销的问题和并发加锁的问题</li>\n</ul>\n<p><code v-pre>Redis</code> 的这种特性，导致 <code v-pre>Redis</code> 只能作用于快速执行场景的热数据，一旦某个操作过长，就会导致严重延时的响应，这对 <code v-pre>Redis</code> 服务几乎是致命的。</p>\n<h3 id=\"_3-7-的持久化\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-的持久化\"><span>3.7.的持久化</span></a></h3>\n<h4 id=\"_3-7-1-rdb\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-rdb\"><span>3.7.1.RDB</span></a></h4>\n<h5 id=\"_3-7-1-1-rdb-的简单介绍\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-1-rdb-的简单介绍\"><span>3.7.1.1.RDB 的简单介绍</span></a></h5>\n<p><code v-pre>Redis</code> 的 <strong>RDB(Redis Database)</strong> 持久化机制是将当前内存中的数据生成快照并保存到磁盘的过程。<code v-pre>RDB</code> 是一种高效的持久化方式，但它有可能丢失短时间内的数据更新。</p>\n<p>转储的 <code v-pre>RDB</code> ⽂件保存在 <code v-pre>dir</code> 配置指定的目录下（默认 <code v-pre>/var/lib/redis/</code>），⽂件名通过 <code v-pre>dbfilename</code> 配置（默认 <code v-pre>dump.rdb</code>）指定。可以通过执行 <code v-pre>config set dir {newDir}</code> 和 <code v-pre>config set dbfilename {newFilename}</code> 运行期间动态执行，当下次运行时 <code v-pre>RDB</code> ⽂件会保存到新目录。</p>\n<p><code v-pre>Redis</code> 默认采⽤ <code v-pre>LZF</code> 算法对⽣成的 <code v-pre>RDB</code> ⽂件做压缩处理，压缩后的文件远远小于内存大小，默认开启，可以通过参数 <code v-pre>config set rdbcompression {yes|no}</code> 动态修改。</p>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：虽然压缩 <code v-pre>RDB</code> 会消耗 <code v-pre>CPU</code>，但可以大幅降低文件的体积，方便保存到硬盘或通过网络发送到 <strong>从节点</strong>，因此建议开启。</p>\n</div>\n<h5 id=\"_3-7-1-2-rdb-的触发机制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-rdb-的触发机制\"><span>3.7.1.2.RDB 的触发机制</span></a></h5>\n<h6 id=\"_3-7-1-2-1-手动触发\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-1-手动触发\"><span>3.7.1.2.1.手动触发</span></a></h6>\n<ul>\n<li><code v-pre>save</code>：在执行 <code v-pre>save</code> 命令时，<code v-pre>Redis</code> 会阻塞当前服务器，直到 <code v-pre>RDB</code> 过程完成为止。对于大规模数据集会导致长时间的阻塞，因此在实际使用中很少采用。</li>\n<li><code v-pre>bgsave</code>：执行 <code v-pre>bgsave</code> 命令时，<code v-pre>Redis</code> 通过 <code v-pre>fork</code> 创建一个子进程来处理 <code v-pre>RDB</code> 持久化，主进程不会被阻塞，持久化任务由子进程处理。<code v-pre>RDB</code> 完成后，子进程会自动结束，主进程继续处理其他请求。</li>\n</ul>\n<h6 id=\"_3-7-1-2-2-自动触发\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-2-2-自动触发\"><span>3.7.1.2.2.自动触发</span></a></h6>\n<p>除了手动触发，<code v-pre>Redis</code> 还支持以下几种自动触发的机制：</p>\n<ul>\n<li><code v-pre>save</code>：通过配置文件中的 <code v-pre>save m n</code> 指令，<code v-pre>Redis</code> 会在每隔 <code v-pre>m</code> 秒内数据集发生了 <code v-pre>n</code> 次修改时，自动触发 <code v-pre>RDB</code> 持久化</li>\n<li>从节点复制操作：当 <code v-pre>Redis</code> 的 <strong>从节点</strong> 进行全量复制时，主节点会自动执行 <code v-pre>RDB</code> 持久化，并将生成的 <code v-pre>RDB</code> 文件内容发送给从节点</li>\n<li><code v-pre>shutdown</code>：当执行 <code v-pre>shutdown</code> 命令关闭 <code v-pre>Redis</code> 时，<code v-pre>Redis</code> 会自动执行 <code v-pre>RDB</code> 持久化，确保数据的持久性</li>\n</ul>\n<h5 id=\"_3-7-1-3-rdb-的实现原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-3-rdb-的实现原理\"><span>3.7.1.3.RDB 的实现原理</span></a></h5>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241120211127863.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>执行 <code v-pre>bgsave</code> 后父进程检查是否有其他的持久化子进程在执行持久化操作</li>\n<li>父进程通过 <code v-pre>fork</code> 创建持久化子进程，<code v-pre>fork</code> 的过程中父进程会轻微阻塞，通过 <code v-pre>info stats</code> 命令查看 <code v-pre>latest_fork_usec</code> 选项，可以获取最近一次 <code v-pre>fork</code> 操作的耗时，单位为微秒</li>\n<li><code v-pre>bgsave</code> 命令返回并释放父进程，继续处理请求</li>\n<li>子进程执行 <code v-pre>RDB</code> 持久化操作，根据父进程内存生成老师快照文件，完成并原子化替换原始的 <code v-pre>RDB</code> 文件，执行 <code v-pre>lastsave</code> 命令就可以获取最后一次生成 <code v-pre>RDB</code> 的时间，对应 <code v-pre>info</code> 统计的 <code v-pre>rdb_last_save_time</code> 选项</li>\n<li>子进程发送信号通知父进程操作完成，父进程更新统计信息</li>\n</ol>\n<h5 id=\"_3-7-1-4-rdb-的优势劣势\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-1-4-rdb-的优势劣势\"><span>3.7.1.4.RDB 的优势劣势</span></a></h5>\n<ul>\n<li><code v-pre>RDB</code> 文件是一个紧凑压缩的二进制文件，代表 <code v-pre>Redis</code> 在某个时间点上的数据快照 <code v-pre>RDB</code> 非常适用于备份、全量复制等场景。例如，每 <code v-pre>6</code> 小时执行 <code v-pre>bgsave</code> 备份，并把 <code v-pre>RDB</code> 文件复制到远程机器或者文件系统（如 <code v-pre>HDFS</code>）用于灾备。而 <code v-pre>Redis</code> 加载 <code v-pre>RDB</code> 恢复数据的速度远快于 <code v-pre>AOF</code> 的方式。</li>\n<li><code v-pre>RDB</code> 方式无法做到实时持久化或秒级持久化，因为 <code v-pre>bgsave</code> 每次执行都要进行 <code v-pre>fork</code> 创建子进程，这属于重量级操作，频繁执行成本过高。另外，由于 <code v-pre>RDB</code> 文件使用特定的二进制格式保存，随着 <code v-pre>Redis</code> 版本演进，<code v-pre>RDB</code> 格式可能发生变化，存在兼容性风险。</li>\n</ul>\n<h4 id=\"_3-7-2-aof\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-aof\"><span>3.7.2.AOF</span></a></h4>\n<h5 id=\"_3-7-2-1-aof-的简单介绍\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-1-aof-的简单介绍\"><span>3.7.2.1.AOF 的简单介绍</span></a></h5>\n<p><code v-pre>Redis</code> 的 <strong>AOF(Append Only File)</strong> 持久化机制，以独立日志的方式记录每次写命令，重启时再重新执行 <code v-pre>AOF</code> 文件中的命令以达到恢复数据的目的。<code v-pre>AOF</code> 的主要作用是解决了数据持久化的实时性问题，目前已经成为 <code v-pre>Redis</code> 持久化的主流方式。</p>\n<h5 id=\"_3-7-2-2-aof-的触发机制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-aof-的触发机制\"><span>3.7.2.2.AOF 的触发机制</span></a></h5>\n<h6 id=\"_3-7-2-2-1-启用持久\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-1-启用持久\"><span>3.7.2.2.1.启用持久</span></a></h6>\n<p>默认 <code v-pre>AOF</code> 是不开启的，需要配置设置 <code v-pre>appendonly yes</code> 才可以打开，<code v-pre>AOF</code> ⽂件名通过 <code v-pre>appendfilename</code> 配置（默认是 <code v-pre>appendonly.aof</code>）设置。保存目录同 <code v-pre>RDB</code> 持久化方式一直，也是通过 <code v-pre>dir</code> 配置来指定。</p>\n<p><code v-pre>AOF</code> 开启后，写命令也会被写入到缓存中，写入的持久化内容是以文本协议格式进行的。例如，<code v-pre>set hello world</code> 这条命令在 <code v-pre>AOF</code> 缓冲区会追加如下文本：</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">3</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$3</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$5</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">hello</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$5</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">world</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\r\\n</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>这里遵循了 <code v-pre>Redis</code> 协议格式。<code v-pre>Redis</code> 选择文本协议的原因主要包括：</p>\n<ul>\n<li><strong>兼容性</strong>：文本协议具有较好的跨平台兼容性。</li>\n<li><strong>实现简单</strong>：文本协议易于理解和实现。</li>\n<li><strong>可读性</strong>：文本格式直观，便于调试和查看。</li>\n</ul>\n<p>在 <code v-pre>AOF</code> 过程中，需要一个名为 <code v-pre>aof_buf</code> 的缓冲区。<code v-pre>Redis</code> 使用单线程响应命令，如果每次写 <code v-pre>AOF</code> 文件都直接同步到硬盘，会导致性能下降，因为每次操作都涉及到 <code v-pre>IO</code> 读写，这比内存读写要慢。通过先写入缓冲区，可以有效减少 <code v-pre>IO</code> 次数。同时，<code v-pre>Redis</code> 提供了多种缓冲区同步策略，允许用户根据实际需求进行性能和数据持久性的平衡。</p>\n<h6 id=\"_3-7-2-2-2-同步策略\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-2-同步策略\"><span>3.7.2.2.2.同步策略</span></a></h6>\n<p><code v-pre>Redis</code> 提供了多种 <code v-pre>AOF</code> 缓冲区同步文件策略，通过参数 <code v-pre>appendfsync</code> 控制。不同值的含义如下：</p>\n<table>\n<thead>\n<tr>\n<th>可配置值</th>\n<th>说明</th>\n<th>建议</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code v-pre>always</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后调用 <code v-pre>fsync</code> 同步，完成后返回。</td>\n<td>每次写入都同步 <code v-pre>AOF</code> 文件，数据安全性最高。但是性能非常差，在一般的 <code v-pre>SATA</code> 硬盘上，只能支持约几百 <code v-pre>TPS</code> 的写入量。因此除非数据极其重要，否则不建议配置。</td>\n</tr>\n<tr>\n<td><code v-pre>everysec</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后只执行 <code v-pre>write</code> 操作，不进行 <code v-pre>fsync</code>。每秒由同步线程进行 <code v-pre>fsync</code>。</td>\n<td>默认配置，也是推荐配置。命令写入 <code v-pre>aof_buf</code> 后立即返回，由同步线程每秒执行一次 <code v-pre>fsync</code>。兼顾数据安全性和性能，理论上最多丢失 <code v-pre>1</code> 秒的数据。</td>\n</tr>\n<tr>\n<td><code v-pre>no</code></td>\n<td>命令写入 <code v-pre>aof_buf</code> 后只执行 <code v-pre>write</code> 操作，由操作系统控制 <code v-pre>fsync</code> 频率。</td>\n<td>操作系统自行决定同步策略，性能较高，但数据丢失风险较大。仅适用于数据重要性极低的场景。</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>\n<p><strong><code v-pre>write</code> 操作：</strong></p>\n<ul>\n<li>会触发 <strong>延迟写</strong> 机制。</li>\n<li><code v-pre>Linux</code> 在内核中提供页面缓冲区，用来提升硬盘 <code v-pre>IO</code> 性能</li>\n<li><code v-pre>write</code> 操作在数据写入系统缓冲区后立即返回，数据同步到硬盘依赖系统调度机制（如缓冲区写满或达到特定时间周期）</li>\n<li>在数据同步到硬盘之前，如果系统发生故障或宕机，缓冲区内的数据将丢失</li>\n</ul>\n</li>\n<li>\n<p><strong><code v-pre>fsync</code> 操作：</strong></p>\n<ul>\n<li>针对单个文件操作，执行强制硬盘同步</li>\n<li><code v-pre>fsync</code> 会阻塞当前操作，直到数据写入到硬盘为止</li>\n</ul>\n</li>\n</ul>\n<p>在大多数场景下，推荐使用 <code v-pre>everysec</code> 配置，以获得较好的数据安全性和系统性能平衡。</p>\n<h6 id=\"_3-7-2-2-3-触发重写\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-2-3-触发重写\"><span>3.7.2.2.3.触发重写</span></a></h6>\n<p>3.7.2.2.3.1.手动触发</p>\n<p>手动触发 <code v-pre>AOF</code> 重写可以通过执行 <code v-pre>BGREWRITEAOF</code> 命令。</p>\n<div class=\"language-bash line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"bash\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-bash\"><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis-cli</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> BGREWRITEAOF</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>该命令会在后台执行 <code v-pre>AOF</code> 文件重写操作，将当前数据库状态保存到新的 <code v-pre>AOF</code> 文件中。</p>\n<p>3.7.2.2.3.2.自动触发</p>\n<p><code v-pre>AOF</code> 重写也可以根据以下两个参数自动触发：</p>\n<ul>\n<li><code v-pre>auto-aof-rewrite-min-size</code>：该参数表示触发 <code v-pre>AOF</code> 重写时，<code v-pre>AOF</code> 文件的最小大小。默认值为 <code v-pre>64MB</code>。当 <code v-pre>AOF</code> 文件的大小超过这个最小值时，<code v-pre>Redis</code> 会考虑是否进行自动重写。</li>\n<li><code v-pre>auto-aof-rewrite-percentage</code>：该参数表示当前 <code v-pre>AOF</code> 文件大小相对于上次重写时的增长百分比。只有当 <code v-pre>AOF</code> 文件的大小增加超过这个百分比时，才会触发自动重写。默认值为 <code v-pre>100%</code>。</li>\n</ul>\n<h5 id=\"_3-7-2-3-aof-的实现原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-3-aof-的实现原理\"><span>3.7.2.3.AOF 的实现原理</span></a></h5>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241120221238022.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>所有的写入命令会追加到 <code v-pre>aof_buf</code>（缓冲区）中</li>\n<li><code v-pre>AOF</code> 缓冲区根据对应的策略向硬盘进行同步操作</li>\n<li>随着 <code v-pre>AOF</code> 文件增大，需要定期对 <code v-pre>AOF</code> 文件进行等价重写，以达到压缩目的</li>\n<li>当 <code v-pre>Redis</code> 服务器启动时，可以加载 <code v-pre>AOF</code> 文件进行数据恢复</li>\n</ol>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：随着命令不断写入 <code v-pre>AOF</code>，文件会越来越大。为了解决这个问题，<code v-pre>Redis</code> 引入了 <code v-pre>AOF</code> 重写机制来压缩文件体积。<code v-pre>AOF</code> 文件重写是将 <code v-pre>Redis</code> 进程内的数据转换为写命令，并同步到新的 <code v-pre>AOF</code> 文件。重写后的 <code v-pre>AOF</code> 为什么可以变小？主要有以下理由：</p>\n<ul>\n<li><strong>超时数据的去除</strong> 进程内已超时的数据不会再写入文件，避免了过期数据的冗余存储</li>\n<li><strong>无效命令的删除</strong> 旧的 <code v-pre>AOF</code> 文件中可能包含无效命令（如 <code v-pre>del</code>、<code v-pre>hdel</code>、<code v-pre>srem</code> 等）。在重写过程中，这些命令会被删除，只保留数据的最终版本</li>\n<li><strong>多条写操作合并</strong> 多条相似的写操作可以合并为一条命令。例如，<code v-pre>lpush list a</code>、<code v-pre>lpush list b</code>、<code v-pre>lpush list c</code> 可以合并为 <code v-pre>lpush list a b c</code>，从而减少冗余操作</li>\n</ul>\n</div>\n<p>此外还有一个重写的原理，您也可以简单看一看。</p>\n<figure><img src=\"@source/4.业务服务/3.缓存服务/assets/image-20241121083647145.png\" alt=\"\" tabindex=\"0\" loading=\"lazy\"><figcaption></figcaption></figure>\n<ol>\n<li>\n<p>执行 <code v-pre>AOF</code> 重写请求</p>\n<ul>\n<li>如果当前进程正在执行 <code v-pre>AOF</code> 重写，请求不执行</li>\n<li>如果当前进程正在执行 <code v-pre>bgsave</code> 操作，重写命令延迟到 <code v-pre>bgsave</code> 完成之后再执行</li>\n</ul>\n</li>\n<li>\n<p>父进程执行 <code v-pre>fork</code> 创建子进程</p>\n</li>\n<li>\n<p>重写过程：</p>\n<ul>\n<li>主进程 <code v-pre>fork</code> 之后，继续响应其他命令。所有修改操作写入 <code v-pre>AOF</code> 缓冲区，并根据 <code v-pre>appendfsync</code> 策略同步到硬盘，保证旧 <code v-pre>AOF</code> 文件机制正确</li>\n<li>子进程只有 <code v-pre>fork</code> 之前的所有内存信息，父进程中需要将 <code v-pre>fork</code> 之后这段时间的修改操作写入 <code v-pre>AOF</code> 重写缓冲区中</li>\n</ul>\n</li>\n<li>\n<p>子进程根据内存快照，将命令合并到新的 <code v-pre>AOF</code> 文件中</p>\n</li>\n<li>\n<p>子进程完成重写：</p>\n<ul>\n<li>新文件写入后，子进程发送信号给父进程</li>\n<li>父进程把 <code v-pre>AOF</code> 重写缓冲区内临时保存的命令追加到新 <code v-pre>AOF</code> 文件中</li>\n<li>用新 <code v-pre>AOF</code> 文件替换旧 <code v-pre>AOF</code> 文件</li>\n</ul>\n</li>\n</ol>\n<h5 id=\"_3-7-2-4-aof-的优势劣势\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-7-2-4-aof-的优势劣势\"><span>3.7.2.4.AOF 的优势劣势</span></a></h5>\n<ul>\n<li>\n<p>优势：</p>\n<ul>\n<li><strong>数据更精确</strong>：<code v-pre>AOF</code> 会记录每个写命令，可以达到更高的数据持久化精度。例如，假设 <code v-pre>Redis</code> 崩溃了，你可能丢失不到几秒钟的数据（这取决于 <code v-pre>appendfsync</code> 策略）。</li>\n<li><strong>持久化策略灵活</strong>：<code v-pre>AOF</code> 提供三种同步策略 (<code v-pre>always</code>, <code v-pre>everysec</code>, <code v-pre>no</code>)，可以根据需求在持久化精度和性能之间做平衡。</li>\n<li><strong>支持持久化恢复</strong>：<code v-pre>AOF</code> 文件可以通过重放命令恢复数据，保证数据一致性。</li>\n</ul>\n</li>\n<li>\n<p>劣势：</p>\n<ul>\n<li>\n<p><strong>文件较大</strong>：由于每个写命令都被记录，<code v-pre>AOF</code> 文件的大小可能会比 <code v-pre>RDB</code> 大很多。</p>\n</li>\n<li>\n<p><strong>性能开销</strong>：<code v-pre>AOF</code> 会增加额外的写入操作，尤其是 <code v-pre>appendfsync always</code> 策略会频繁同步磁盘，导致性能下降。</p>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：<code v-pre>Redis</code> 两种方案的使用</p>\n<ul>\n<li><code v-pre>RDB</code> 高性能，底持久，磁盘多容量，慢速度</li>\n<li><code v-pre>AOF</code> 低性能，高持久，磁盘少容量，快速度</li>\n</ul>\n</div>\n<h3 id=\"_3-8-业务操作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-业务操作\"><span>3.8.业务操作</span></a></h3>\n<h4 id=\"_3-8-1-事务\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-1-事务\"><span>3.8.1.事务</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合原子执行多个操作，只能单次启动。</p>\n</div>\n<p>由于 <code v-pre>Redis</code> 的实现是单线程的，对比 <code v-pre>MySQL</code> 来说，<code v-pre>Redis</code> 事务要简单很多。</p>\n<ul>\n<li>弱化的原子性：虽然也是把一系列操作绑定为一组，但是操作失败时，无法回滚，因此原子性比较弱。</li>\n<li>不保证一致性：<span style=\"text-emphasis:filled red;\">这点待补充...</span></li>\n<li>不需要隔离性：<code v-pre>MySQL</code> 需要给多个同时执行的事务设置隔离性，但是由于 <code v-pre>Redis</code> 是单线程的，这导致 <code v-pre>Redis</code> 无需设置隔离性，只要保证自己的每条操作都是原子的即可。</li>\n<li>不需要持久性：这不代表 <code v-pre>Redis</code> 不需要做持久化，或没有持久化功能，而是 <code v-pre>Redis</code> 的事务不需要自己考虑持久化的问题，这个问题交给 <code v-pre>redis-server</code> 自己的 <code v-pre>RDB/AOF</code> 持久化机制。</li>\n</ul>\n<p>总结来看仅仅是打包了一组指令，避免被其他客户端 <strong>加塞</strong> 而已。</p>\n<p><code v-pre>Redis</code> 事务其实是在服务器上搞了一个 <strong>事务队列</strong>. 每次客户端在事务中进行一个操作, 都会把命令先发给服务器, 放到事务队列中（但并不会立刻执行），而是会在真正收到 <code v-pre>EXEC</code> 命令之后, 才真正执行队列中的所有操作。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 操作一个简单的事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开启事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MULTI</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 执行指令(其实还没执行)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 表示命令已加入事务队列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k3</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 完成事务(提醒可以执行)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EXEC</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 也可以使用 DISCARD 放弃事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) OK</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>不过在对同一个键的操作上，并且客户端开始编写事务的情况下，其他客户端先提交事务（或者直接执行指令时），还是会出现一些问题，这个时候会使用 <code v-pre>watch/unwatch</code> 来监控键值的版本号（就是一个整数而已），版本号冲突就立刻停止执行。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 假设两个客户端几乎同时开始编写事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 1 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 开始监视键 k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">watch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 开始事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MULTI</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 将修改 k1 和 k2 作为事务的一部分, 但尚未执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 此时 k1 的版本号为 0, 记录该版本号, 操作被排队, 但没有提交</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1000</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">QUEUED</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k2 的修改操作也被加入队列, 尚未执行</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 尚未执行 EXEC, 事务仍在队列中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 2 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 2 执行修改 k1 操作, 修改 k1 的值, 并将其版本号更改为 1(相当于提前提交了只有一条指令的事务)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 200</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OK</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # 客户端 2 成功修改了 k1 的值, 服务器上的版本号变为 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># >>> begin: 客户端 1 >>></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 客户端 1 执行 EXEC, 提交事务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EXEC</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> # 由于版本号不一致, 事务被取消, 未执行任何命令</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查 k1 的最终值, 应该是客户端 2 提交的修改</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"200\"</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k1 的最终值是 200, 表明客户端 2 修改成功</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 检查 k2 的最终值, 因为客户端 1 的事务没有成功提交, 所以 k2 未被设置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> k2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">nil</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  # k2 并没有被修改, 返回 nil</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># &#x3C;&#x3C;&#x3C; end &#x3C;&#x3C;&#x3C;</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-8-2-脚本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-2-脚本\"><span>3.8.2.脚本</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合原子执行多个操作，可以复用启动。</p>\n</div>\n<p><code v-pre>Redis</code> 支持执行 <code v-pre>Lua</code> 脚本，关于 <code v-pre>Lua</code>，您可以可以 <a href=\"https://www.lua.org/\" target=\"_blank\" rel=\"noopener noreferrer\">前往 Lua 官网查看大概的情况</a>，使用 <code v-pre>Lua</code> 的原因主要是</p>\n<ul>\n<li>为了将多个操作封装为原子操作，确保操作原子执行</li>\n<li>支持脚本缓存，可以减少因为数据传输引起的网络开销</li>\n<li><code v-pre>Lua</code> 本身也支持一些复杂的数据操作能力，避开 <code v-pre>Redis</code> 内部只有简单计算的缺点，也不必传递给客户端（对于 <code v-pre>Redis</code> 服务端来说客户端）浪费计算时间的问题再进行计算</li>\n<li>对于较多的 <code v-pre>Redis</code> 操作，可以直接使用 <code v-pre>Lua</code> 脚本优化操作，由于 <code v-pre>Redis</code> 对 <code v-pre>Lua</code> 脚本做过优化，可以原生执行 <code v-pre>Redis</code> 的代码</li>\n</ul>\n<p>怎么抉择什么时候使用 <code v-pre>Lua</code> 和 <code v-pre>Cpp</code> 呢？</p>\n<ul>\n<li>需要事务原子操作时</li>\n<li>需要减少网络开销时</li>\n<li>重复执行相同操作时</li>\n<li>避免在客户端计算时（对于 <code v-pre>Redis</code> 的客户端）</li>\n</ul>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 使用 Redis 的 Lua 脚本缓存机制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SCRIPT</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> LOAD</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return ARGV[1] + ARGV[2]</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\"53c370cb7894e73f9aaf94627c0506c428b5cc97\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">127.0.0.1:6379</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">> </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">EVALSHA</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 53c370cb7894e73f9aaf94627c0506c428b5cc97</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">integer</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> 5</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_3-8-3-管道\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-8-3-管道\"><span>3.8.3.管道</span></a></h4>\n<div class=\"hint-container important\">\n<p class=\"hint-container-title\">重要</p>\n<p>补充：适合本地执行多个操作，通常由库实现</p>\n</div>\n<p><code v-pre>Pipeline</code> 用来：</p>\n<ul>\n<li><strong>发送多个 Redis 命令</strong> <code v-pre>Redis</code> 客户端会将多个命令批量发送到服务器，而不是逐条发送</li>\n<li><strong>读取所有命令的结果</strong> 客户端一次性读取所有响应，减少网络往返时间</li>\n</ul>\n<p>实际上<code v-pre>Redis</code> 本身没有管道的相关操作，但是对于大部分的客户端是有实现管道操作的，让多条指令能一次性发送到 <code v-pre>Redis</code> 中，保证多条指令的执行结果如同在 <code v-pre>redis-cli</code> 中是一样的（因此就理解为和在 <code v-pre>Redis</code> 服务器命令行本地中输入执行多条命令是一样的就可以）。</p>\n<p>但是需要强调的是，管道不是原子的，完全只是为了压缩多条指令带来的多个 <code v-pre>RTT(往返时间)</code> 而已，把多个指令请求合并，减少网络开支。</p>\n<h3 id=\"_3-9-通信协议\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-9-通信协议\"><span>3.9.通信协议</span></a></h3>\n<p>待补充...</p>\n<h3 id=\"_3-10-第三方库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-第三方库\"><span>3.10.第三方库</span></a></h3>\n<h4 id=\"_3-10-1-cpp-客户端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-cpp-客户端\"><span>3.10.1.Cpp 客户端</span></a></h4>\n<h5 id=\"_3-10-1-1-redispp-的安装\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-1-redispp-的安装\"><span>3.10.1.1.Redispp 的安装</span></a></h5>\n<p>这里使用 <a href=\"https://github.com/sewenew/redis-plus-plus\" target=\"_blank\" rel=\"noopener noreferrer\">redis-plus-plus 库</a> 来操作 <code v-pre>Redis</code> 的使用，<code v-pre>redis-plus-plus</code> 是基于 <code v-pre>C</code>语 言实现的 <code v-pre>hiredis</code>实现的，先使用 <code v-pre>sudo apt install libhiredis-dev</code>快速安装 <code v-pre>Redis</code> 开发工具，然后 <code v-pre>git clone https://github.com/sewenew/redis-plus-plus.git</code> 克隆该库进行安装。</p>\n<div class=\"language-shell line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"shell\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-shell\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 编译和安装</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 安装开发工具包</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> libhiredis-dev</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 克隆源代码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> git</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> clone</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> https://github.com/sewenew/redis-plus-plus.git</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 编译源代码, 然后进行安装</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> redis-plus-plus</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">$</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mkdir</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> cmake</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> ..</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> make</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> make</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>接下来请您直接 <a href=\"https://github.com/sewenew/redis-plus-plus/tree/master?tab=readme-ov-file#api-reference\" target=\"_blank\" rel=\"noopener noreferrer\">查看官方文档 API 文档</a> 来学习使用 <code v-pre>Redispp</code>，官方文档写得非常详细。</p>\n<h5 id=\"_3-10-1-2-redispp-的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-1-2-redispp-的使用\"><span>3.10.1.2.Redispp 的使用</span></a></h5>\n<p>这里结合官方文档简单快速的编写程序来做实验。</p>\n<div class=\"language-cpp line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"cpp\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// main.cpp</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">#</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sw/redis++/redis++.h</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">using</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> namespace</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> sw</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    try</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 链接 Redis 实例 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> redis </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">tcp://127.0.0.1:6379</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 单前数据库清空操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">flushdb</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === String 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">del</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 可以提前删除不需要的键</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 设置键值对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> val </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 获取键值对</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">expire</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">chrono</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">seconds</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">20</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 设置过期时间(以秒为单位)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // redis.pexpire(\"string\", std::chrono::milliseconds(20000));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 20 秒</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === List 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vec </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">aaa</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bbb</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ccc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">abc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">bac</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">cab</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lrange</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Set 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_set</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> set </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">smembers</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sismember</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">))</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1 exists</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1 not exists</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Zset 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_map</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> scores </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">m3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zadd</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> scores</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> scores</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 获取带分数的有序集合结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double>></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                UnboundedInterval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;double></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">{}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset_result (with scores):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> zset_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 获取不带分数的有序集合结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                BoundedInterval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">>(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> BoundType</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">CLOSED</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">),</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意 BoundType::CLOSED 表示闭区间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">without_score (no scores):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> without_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> double>></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">zrangebyscore</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zset</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                BoundedInterval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">>(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1.3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> BoundType</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OPEN</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">),</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意 BoundType::LEFT_OPEN 表示开区间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">                std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">with_score (open interval):</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> with_score</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === Hash 操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">make_pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 注意这里做了更新操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">unordered_map</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> m </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        };</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hmset</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">clear</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 清空, 以获取到新的数据</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hgetall</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 打印结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">pair </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> m</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">first</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pair</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">second</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 也可以只获取到值而去除字段</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">hmget</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">hash</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">field1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> vals</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 脚本操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这个脚本非常简单, 它仅返回 1, 并没有与 Redis 数据库进行任何交互</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> num </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">eval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return 1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> num </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这段代码执行一个简单的 Lua 脚本 return 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // eval&#x3C;long long> 表示将脚本的返回值转换为 long long 类型</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 脚本返回 1, 即返回一个数字 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // {} 表示没有键(KEYS), {} 表示没有传入参数(ARGV)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 该脚本将返回两个元素 1 和 2, 并将其作为字符串存储在 nums 向量中</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">eval</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return {ARGV[1], ARGV[2]}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> nums</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> v </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 这段代码执行 Lua 脚本 \"return {ARGV[1], ARGV[2]}\", 该脚本返回一个包含 ARGV[1] 和 ARGV[2] 两个元素的数组</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // ARGV[1] 和 ARGV[2] 分别对应传入的 {\"1\", \"2\"} 参数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 通过 std::back_inserter(nums) 将返回的结果插入到 nums 向量中</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 脚本操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hash_val </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">script_load</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">return ARGV[1] + ARGV[2]</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hash_val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">evalsha</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">hash_val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 执行复杂脚本并且查看过期时间</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mset_with_ttl_script </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> R\"(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            local len = #KEYS</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            if (len == 0 or len + 1 ~= #ARGV) then return 0 end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            local ttl = tonumber(ARGV[len + 1])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            if (not ttl or ttl &#x3C;= 0) then return 0 end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            for i = 1, len do redis.call(\"SET\", KEYS[i], ARGV[i], \"EX\", ttl) end</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">            return 1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">        )\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> keys </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> args </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">val-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">60</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">eval</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mset_with_ttl_script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> args</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> args</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        sleep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 故意等 5 秒后再打印过期时间</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl0 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl1 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl2 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-2</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ttl3 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pttl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key-3</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // pttl 是指微妙时间(这个键是之前设置的)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">TTL: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">to_string</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ttl3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> seconds</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 使用管道来本地操作多条指令</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> pipe </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">pipeline</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> pipe_replies </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-value</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rename</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">new-my-key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">rpush</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">b</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">c</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">lrange</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                                .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">exec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> set_cmd_result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;bool></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第一条命令结果(布尔)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> get_cmd_result </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第二条命令结果(字符)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;void></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第三条命令结果</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        pipe_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 读取第四条命令结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SET command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">set_cmd_result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">?</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Success</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> :</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Failure</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">has_value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">())</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">GET command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_cmd_result </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">GET command result: Key not found</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">RENAME command result: Success (no return value)</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">LRANGE command result: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> lrange_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 事物操作 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tx </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">transaction</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tx_replies </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">incr</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">incr</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mget</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">{</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num0</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">num1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">                            .</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">exec</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">();</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 提交事物</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_0 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_1 </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">get</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;long</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> long></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 使用 OptionalString 的目的是避免空值</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        tx_replies</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr_result_0: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_0 </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">incr_result_1: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> incr_result_1 </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mget_cmd_result</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 原生执行 Redis 指令 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 可以使用多个参数执行</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> get_name </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">command</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CLIENT</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">SETNAME</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">my-redis-cli</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 大小写均可</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        get_name </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">command</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">OptionalString</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">client</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">getname</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">get_name </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">command</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sort</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">alpha</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">desc</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // ALPHA 是指按照字母排序, desc 是逆向排序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sorted_list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> item </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 也可以使用初始化列表参数</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sort_cmd_str </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">sort</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">list</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">ALPHA</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">command</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">sort_cmd_str</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">begin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> sort_cmd_str</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">end</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(),</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">back_inserter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">sorted_list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // === 集群控制 ===</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 如果您运行了多个 Redis 实例, 就可以利用多个实例的创建, 快速管理另外一个 Redis 实例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> redis_cluster </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> RedisCluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">tcp://127.0.0.1:7000</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        redis_cluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">value</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">        // 因此对于这个新实例来说, 也是相同的操作</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">        auto</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> value </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> redis_cluster</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">key</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">            std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">val </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> catch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Error </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">e</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">&#x3C;&#x3C;</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Error: </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> e</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">what</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> &#x3C;&#x3C;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">::</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>当然，您可以继续查阅文档，官方也有提供 <code v-pre>Doxygen</code> 注释，您可以尝试生成一份来阅读。</p>\n<p>还有一些其他 <code v-pre>API</code> 细节，这里简单概览一下文档支持的大部分功能，就不做详细的解读了...</p>\n<ul>\n<li>连接</li>\n<li>发送指令</li>\n<li>异常</li>\n<li>通用命令界面</li>\n<li>发布订阅</li>\n<li>管道</li>\n<li>事物</li>\n<li>集群</li>\n<li>哨兵</li>\n<li>流</li>\n<li>模块</li>\n<li>异步接口</li>\n<li>协程接口</li>\n</ul>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>警告：部分后续提及，少部分功能未完全实现。</p>\n</div>\n<h4 id=\"_3-10-2-java-客户端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-10-2-java-客户端\"><span>3.10.2.Java 客户端</span></a></h4>\n<p><code v-pre>Spring boot</code> 可以集成 <code v-pre>Redis</code> 进行使用（内置 <code v-pre>Jedis</code>），待补充...</p>\n<h2 id=\"_4-组件深入\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-组件深入\"><span>4.组件深入</span></a></h2>\n<h2 id=\"_5-组件原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-组件原理\"><span>5.组件原理</span></a></h2>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n> [!IMPORTANT]\n>\n> 补充：\n>\n> 接下来，可以 [根据 Redis 官方的快速学习手册进行学习](https://redis.io/docs/latest/get-started/)：\n>\n> -   [Redis 作为内存中数据类型存储快速入门](https://redis.io/docs/latest/develop/get-started/data-store/)，并且还需要 [阅读 Redis 中的数据类型](https://redis.io/docs/latest/develop/data-types/)，每一个数据类型都可以有对应的文档\n> -   [Redis 作为文档数据库快速入门](https://redis.io/docs/latest/develop/get-started/document-database/)（但是必须额外下载 `Redis Stack`）\n> -   [Redis 作为矢量数据库快速入门](https://redis.io/docs/latest/develop/get-started/vector-database/)（但是必须额外下载 `Redis Stack`，并且您必须学习过机器学习）\n>\n> 这几个文档还是非常简单易读的，非常推荐（和本系列一起阅读更佳）。\n>\n> 如果觉得文档太难看懂，可以看看 [别人搬运的尚硅谷 Redis 教程(非正版...)](https://www.bilibili.com/video/BV1UnY5ehE4b?vd_source=c92c89dbfcf9cc30c48086469621f35b&spm_id_from=333.788.videopod.episodes)。\n\n## 1.组件简介\n\n`Redis` 是一种开源的内存数据库，用于存储数据结构，例如字符串、哈希表、列表、集合、有序集合等。它被设计为快速、灵活，并支持多种数据结构的操作。`Redis` 通常用作缓存、消息代理、会话存储等用途。它支持多种编程语言，并有许多客户端库可供开发者使用。Redis 也有持久化选项，可以将数据保存到磁盘上，以便在重启时恢复数据。\n\n`Redis` 所有数据都是存放在内存中的，把数据放在内存中是 `Redis` 速度快的最主要原因。另外 `Redis` 是 ⽤ `C` 语 ⾔ 实现的，⼀ 般来说 `C` 语 ⾔ 实现的最终程序会更快。另外 `Redis` 一开始采用的是单线程，预防了多线程可能产 ⽣ 的竞争问题。不够后面的 `Redis` 在 `6.0` 版本引 ⼊ 了多线程机制，但主要也是在处理 ⽹ 络和 `IO`，不涉及到数据命令，即命令的执行仍然采 ⽤ 了单线程模式。\n\n从网络角度上，`Redis` 还使用了 `IO` 多路复用的方式，实际上就是 `ET` 模式的 `epoll`（`Redis` 的核心任务主要是操作内存的数据结构，不会吃很多的 `CPU` 资源）。\n\n另外，`Redis` 的很多核心功能都是比较简单的逻辑，简单逻辑就代表简单执行，就会非常快速。\n\n`Redis` 相对于传统的关系型数据库（如 `MySQL`）或自定义内存中的变量有一些优势，这些优势可能导致选择 `Redis`：\n\n1. **性能快速**：这里的性能快速是和 `MySQL` 进行对比。\n\n   (1)`Redis` 是一个基于内存的数据库，因此读写速度非常快，适合需要快速响应的应用场景，如缓存系统或计数器（因此常常是 `MySQL` 的一个替代方案，但是存储容量没有 `MySQL` 多，不过有一种方案就是两者同时结合使用，热点数据使用 `Redis`，其余数据使用 `MySQL`）。\n\n2. **数据结构**：`Redis` 支持丰富的数据结构，如字符串、哈希表、列表、集合、有序集合、`GEO(地理信息定位)`...，这使得它可以更灵活地存储和操作数据，而不仅仅局限于关系型数据库的表结构（和 `MySQL` 关系数据库不同，`Redis` 是基于键值对来组织数据的，是一种典型的非关系型数据库）。\n\n3. **可编程的**：可以使用命令行操作 `Redis`，也可以使用编程语言脚本的方式批量执行一些操作（主要使用 `Lua`，也是一种较火的语言）。\n\n4. **可拓展性**：可以使用 `C/C++、Rust` 来为 `Redis` 功能做拓展（本质是安装动态链接库，类似 `.so/.dll` 等），例如支持更多数据结构和更多交互命令。\n\n5. **持久化数据**：虽然 `Redis` 是基于内存的，但它提供了持久化选项，可以将数据定期写入磁盘，确保数据不会因为系统崩溃而丢失。并且也有两种持久化方案，`RDB` 和 `AOF`，前者是基于快照数据的持久化，后者是基于日志数据的持久化。\n\n6. **水平拓展**：`Redis` 支持主从复制和集群模式，可以在多个主机部署多个节点。\n\n7. **高可用性**：多个节点上可以复制数据（备份/冗余），提高系统的可用性和容错能力，从节点就相当于主节点的备份。\n\n8. **原子操作**：`Redis` 支持原子操作，能够保证多个操作的原子性，避免了多线程或多进程并发操作数据时可能出现的竞态条件。\n\n9. **客户端语言多**：客户端可以支持的语言非常多，包括但不限于 `Cpp, Java, Python, Node.js...`，使用起来非常简单。\n\n10. **主从复制功能**：提供了复制功能，实现了多个相同数据的 `Redis` 副本。\n\n11. **高可用**：提供了哨兵机制，保证 `Redis` 的故障发现和故障自动转移。\n\n总的来说，`Redis` 适用于需要高性能、低延迟、丰富数据结构和高可用性的应用场景，如缓存、实时数据分析、会话存储等。虽然在某些情况下使用传统的关系型数据库或自定义内存变量也可以实现类似的功能，但 `Redis` 提供了更好的性能和更丰富的功能。\n\n进程间通信，如果是单机，就需要通过管道或者共享内存等机制来传递数据。而如果涉及到多台主机，就会涉及到网络通信。而 `Redis` 就是基于网络把内存中数据交给别的进程甚至是其他主机中进程来使用，并且一般是基于分布式系统的。\n\n`Redis` 经常会被作为：\n\n- 存储数据的非关系实时数据库（具有更低的存储和更高的效率）\n\n- 使用 `session` 配合 `cookie` 实现会话管理...\n\n- 消息队列消息中间件（这里不是进程通信中的消息队列），是网络中的生产者消费者模型（知名的消息队列就有 `RabbitMQ、Kafka、RocketMQ` 等，不过 `Redis` 的不常使用，多是顺带方便才使用）\n\n  >   [!IMPORTANT]\n  >\n  >   补充：`Redis` 一开始是作为消息中间件（消息队列）的一个生产者-消费者模型解决方案，但是这种类似的解决方案已经有更优的方案了。\n\n但是也不是没有缺点的，比如在数据量大的场景中无法使用，受限于内存空间存储空间不大等。\n\n## 2.组件部署\n\n[依照 Redis 官方文档即可下载 Redis](https://redis.io/docs/latest/operate/oss_and_stack/install/install-stack/apt/)。\n\n```shell\n# 安装 Redis\n$ sudo apt-get install lsb-release curl gpg # 以下指令可能过时, 推荐您看官方文档\n$ curl -fsSL https://packages.redis.io/gpg | sudo gpg --dearmor -o /usr/share/keyrings/redis-archive-keyring.gpg\n$ sudo chmod 644 /usr/share/keyrings/redis-archive-keyring.gpg\n$ echo \"deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/redis.list\n$ sudo apt-get update\n$ sudo apt-get install redis\n\n```\n\n`Redis` 也有经典的 `CS` 模式，因此需要启动服务。\n\n```shell\n# 启动 Redis\n$ sudo systemctl enable redis-server\n$ sudo systemctl start redis-server\n\n```\n\n测试是否安装成功。\n\n```shell\n# 测试 Redis\n$ redis-cli\n127.0.0.1:6379> ping\nPONG\n\n```\n\n>   [!IMPORTANT]\n>\n>   补充：`6379` 是 `Redis` 默认的服务端程序运行端口号。\n\n>   [!IMPORTANT]\n>\n>   补充：`Redis` 官方其实是不推荐在 `Windows` 下使用 `Redis` 的，但是我们有些时候会在 `Windows` 下进行测试，因此就可以尝试在 [这个页面下安装 Redis](https://github.com/MicrosoftArchive/redis/releases)，对于简单的测试已经足够了。\n\n## 3.组件基础\n\n### 3.1.登录退出\n\n登录方式和 `MySQL` 是一样的，可以在命令行使用客户端登录的方式，也可以只执行单条的命令，我们可以简单试试启动 `Redis` 的客户端。\n\n```shell\n# Redis 的登录和退出\n# 直接使用客户端登录并且使用\n$ redis-cli -h 0.0.0.0 -p 6379\n\n0.0.0.0:6379> ping\nPONG # WebSocket 协议中, PING 和 PONG 是一种心跳机制, 服务器或客户端可以发送 PING, 而接收方会响应 PONG, 以确保连接存活\n\n0.0.0.0:6379> set key hello\nOK\n\n0.0.0.0:6379> get key\n\"hello\"\n\n0.0.0.0:6379> exit # 退出 Redis\n\n# 在命令行中只执行一次 Redis 的指令\n$ redis-cli -h 0.0.0.0 -p 6379 ping\nPONG\n\n```\n\n>   [!WARNING]\n>\n>   注意：`Redis` 其实在实际开发中是不会暴露给外界访问的，我们这里只不过是为了方便把配置文件改为 `0.0.0.0`，如果您只在本机操作 `redis` 则默认使用的是 `127.0.0.1` 地址，并且默认 `6379` 端口，此时可以直接省略 `-h` 和 `-p` 直接登录。\n\n### 3.2.指令教程\n\n我们先再来学几个指令尝尝鲜，这些指令在后面用到的概率也非常高，另外 `Redis` 的指令也可以无视对大小写。\n\n#### 3.2.1.基础指令\n\n##### 3.2.1.1.SET, GET, DEL\n\n`set, get, del` 这三个指令非常简单，就是设置（修改）、获取、删除键值对。\n\n```shell\n# 使用 set, get, del\n0.0.0.0:6379> set my_key \"hello\"\nOK\n\n0.0.0.0:6379> get my_key\n\"hello\"\n\n0.0.0.0:6379> del my_key\n(integer) 1\n\n0.0.0.0:6379> get my_key\n(nil)\n```\n\n>   [!IMPORTANT]\n>\n>   补充：实际上还有更加方便可用的变种指令\n>\n>   -   `setex <key_name> <seconds> <key_value>` 可以直接使用秒作为单位设置 `key` 的过期时间\n>   -   `setpx <key_name> <milliseconds> <key_value>` 可以直接使用毫秒作为单位设置 `key` 的过期时间\n>   -   `setnx <key_name> <key_value>` 只在 `key` 不存在时才进行设置，即如果 `key` 之前已经存在，不执行设置\n>   -   `setxx <key_name> <key_value>` 只在 `key` 存在时才进行设置，即如果 `key` 之前不存在，不执行设置\n>   -   `mset <key_name_1> <key_value_1> <key_name_2> <key_value_2> ...` 一次设置多个键值对\n>   -   `mget key_name_1 key_name_2` 一次获取多个键值\n>   -   另外 `del` 本身就支持删除多个键值对...\n>\n>   这种一次性设置的指令通常会更受欢迎，因为可以减缓一些网络 `IO` 的代价。\n\n##### 3.2.1.2.KEYS, EXISTS, SCAN\n\n`keys` 指令可以根据一定的样式，或者匹配模式来查询对应的 `key` 值，查询的复杂度是 $O(n)$，而 `exists` 则可以查询 `key` 存在的个数，时间复杂度是 $O(1)$。\n\n```shell\n# 使用 keys, exists\n0.0.0.0:6379> mset key_1 \"hello\" key_2 \"limou\" # 这个是 set 的升级版, 可以一次设置多个 key-value 对\nOK\n\n0.0.0.0:6379> keys * # 查询所有 k-v 值\n1) \"key_2\"\n2) \"backup1\"\n3) \"backup3\"\n4) \"backup4\"\n5) \"key_1\"\n6) \"backup2\"\n\n0.0.0.0:6379> keys key_? # 查询 key_1 key_2 key_y 等 k-v 值\n1) \"key_2\"\n2) \"key_1\"\n\n0.0.0.0:6379> keys k* # 查询 k2ey key_2 kkkkey key_1 等 k-v 值\n1) \"key_2\"\n2) \"key_1\"\n\n0.0.0.0:6379> keys key_[13] # 查询 key_1 key_3 这两个 k-v 值\n1) \"key_1\"\n\n0.0.0.0:6379> keys key_[^1] # 查询除了 key_1 以外的所有 key_2 key_w key_0 等 k-v 值\n1) \"key_2\"\n\n0.0.0.0:6379> keys key_[0-3] # 查询 key_1 key_2 key_3 这三个 k-v 值\n1) \"key_2\"\n2) \"key_1\"\n\n0.0.0.0:6379> exists key_1 # 查找符合 key_1 的个数\n(integer) 1\n\n0.0.0.0:6379> exists key_1 key_2 # 查找符合 key_1, key_2 的个数\n(integer) 2\n\n```\n\n>   [!CAUTION]\n>\n>   警告：`keys` 的时间复杂度比较大，一般在实际工程中会直接禁用这个命令，否者一旦 `Redis` 在有大量的指令时，就会出现“卡住”的情况，这和 `Redis` 的架构设计本身是有关系的，后面再说...\n\n还有一个比较高效的增量扫描 `scan` 指令，放回的数据是分批量的，即便是在单线程的情况下，也可以非阻塞返回大规模数据集，不会对 `Redis` 有很大的性能影响。\n\n```shell\n# 使用 scan\n127.0.0.1:6379> scan 0 match \"key_*\" count 100 ## 0 代表游标, 是扫描的起始位置, 表示从当前 Redis 键空间\n1) \"0\" ## 这里是因为数据量不大, 直接返回新的游标为 0 表示扫描完成, 如果数据量大会得到新的游标\n2) 1) \"key_2\"\n   2) \"key_1\"\n```\n\n可以看到 `keys` 是扫描整个键值空间，但是 `scan` 可以由用户指定游标进行增量扫描。\n\n>   [!IMPORTANT]\n>\n>   补充：`Redis` 也是有关于数据库的概念的，也就是 `Redis` 键空间。\n\n##### 3.2.1.3.EXPIRE, TTL\n\n`expire` 为指定的 `key` 值添加秒级的过期时间，返回 `1` 表示设置成功，返回 `0` 表示设置失败，并且可以对同一个 `key` 值反复使用达到修改过期时间的目的。而 ` TTL` 则可以获取指定 `key` 值的过去时间，单位也是秒级，其返回值为 `任意数字` 表示距离过期时间所剩的秒数，`-1` 表示没有关联过期时间，`-2` 表示 `key` 不存在。\n\n```shell\n# 使用 expire, ttl\n0.0.0.0:6379> set key 100\nOK\n\n0.0.0.0:6379> get key\n\"100\"\n\n0.0.0.0:6379> expire key 5 # 设置 key 的过期时间\n(integer) 1\n\n0.0.0.0:6379> get key # 每一秒获取一次\n\"100\"\n\n0.0.0.0:6379> get key\n\"100\"\n\n0.0.0.0:6379> get key\n\"100\"\n\n0.0.0.0:6379> get key\n\"100\"\n\n0.0.0.0:6379> get key\n\"100\"\n\n0.0.0.0:6379> get key\n(nil)\n\n0.0.0.0:6379> ttl key # 查看已经不存在的 key\n(integer) -2\n\n0.0.0.0:6379> set key 100 # 重新设置一个 key 值\nOK\n\n0.0.0.0:6379> set other_key 20 # 再设置另外一个 key 值\nOK\n\n0.0.0.0:6379> expire key 10 # 为第一个 key 设置过期时间\n(integer) 1\n\n0.0.0.0:6379> ttl key # 查看第一个 key 剩余的过期时间\n(integer) 7\n\n0.0.0.0:6379> ttl key # 查看第一个 key 剩余的过期时间\n(integer) 4\n\n0.0.0.0:6379> ttl other_key # 试图查看另外一个没有设置过期时间的 key 的剩余过期时间\n(integer) -1\n\n0.0.0.0:6379> set key 100 # 再次重新设置 key 值\nOK\n\n0.0.0.0:6379> get key # 正常获取\n\"100\"\n\n0.0.0.0:6379> expire key 100000 # 设置比较大的过期时间\n(integer) 1\n\n0.0.0.0:6379> ttl key # 查看剩余的过期时间\n(integer) 99994\n\n0.0.0.0:6379> expire key 10 # 重新设置过期时间\n(integer) 1\n\n0.0.0.0:6379> ttl key # 检查现在的过期时间\n(integer) 9\n\n```\n\n>   [!IMPORTANT]\n>\n>   补充：实际上 `expire, ttl` 都有支持毫秒版本的 `pexpire, pttl`，使用方法类似。\n\n##### 3.2.1.4.TYPE\n\n`type` 也很简单，可以返回 `key` 值的数据类型，返回值有 `none, string, list, set, zset, hash, stream...` 其实就对应后面数据类型。\n\n```shell\n# 使用 type\n0.0.0.0:6379> set key 100\nOK\n\n0.0.0.0:6379> get key\n\"100\"\n\n0.0.0.0:6379> type key\nstring\n\n```\n\n##### 3.2.1.5.INCR, INCRBY, DECR, DECRBY, INCRBYFLOAR\n\n`incr` 可以用来给一个字符串类型的实数进行 `+1` 操作，哪怕这个 `key` 值之前不存在，也会从 `0` 开始加起。`incrby` 也是类似，但是加上用户指定的整数值（注意只能是整数），不存在时，该 `key` 也是从 `0` 开始加起。而 `decr` 和 `decrby` 和前面两者类似，只不过是变成减而已。\n\n>   [!IMPORTANT]\n>\n>   补充：顺口一提上述关于 `...by` 的指令都可以使用负数作为操作数。\n\n对于浮点数来说，只使用一个指令 `incrbyfloat` 就够了，功能也是类似的，加减使用正负实数调控就行。\n\n```shell\n# 使用 incr, incrby, decr, decrby, incrbyfloat\n# incr\n0.0.0.0:6379> exists mykey\n(integer) 0\n\n0.0.0.0:6379> incr mykey\n(integer) 1\n\n0.0.0.0:6379> exists mykey\n(integer) 1\n\n0.0.0.0:6379> get mykey\n\"1\"\n\n0.0.0.0:6379> incr mykey\n(integer) 2\n\n0.0.0.0:6379> incr mykey\n(integer) 3\n\n0.0.0.0:6379> incr mykey\n(integer) 4\n\n0.0.0.0:6379> get mykey\n\"4\"\n\n# incrby\n0.0.0.0:6379> incrby mykey 5\n(integer) 9\n\n# decr\n0.0.0.0:6379> decr mykey\n(integer) 8\n\n# decrby\n0.0.0.0:6379> decrby mykey 7\n(integer) 1\n\n# incrbyfloat\n0.0.0.0:6379> incrbyfloat mykey 5.6\n\"9.6\"\n0.0.0.0:6379> incrbyfloat mykey -3.10.33\n\"-0.73\"\n```\n\n##### 3.2.1.6.APPEND, GETRANGE, SETRANGE, STRLEN\n\n还可以对字符串进行操作，这些也比较简单...\n\n```shell\n# 使用 append, getrange, setrange, strlen\n0.0.0.0:6379> set mykey \"hello\" # 设置初始字符串值到键 mykey\nok\n\n0.0.0.0:6379> get mykey # 获取键 mykey 的值\n\"hello\"\n\n0.0.0.0:6379> append mykey \" world\" # 向 mykey 键追加字符串 \" world\"\n(integer) 11\n\n0.0.0.0:6379> get mykey # 获取追加后的 mykey 值\n\"hello world\"\n\n0.0.0.0:6379> getrange mykey 0 4 # 获取 mykey 值中从索引 0 到 4 的子串\n\"hello\"\n\n0.0.0.0:6379> getrange mykey 6 10 # 获取 mykey 值中从索引 6 到 10 的子串\n\"world\"\n\n0.0.0.0:6379> setrange mykey 6 \"redis\" # 设置 mykey 中从索引 6 开始的新值为 \"redis\"\n(integer) 11\n\n0.0.0.0:6379> get mykey # 获取 setrange 操作后的 mykey 值\n\"hello redis\"\n\n0.0.0.0:6379> strlen mykey # 获取 mykey 字符串的长度\n(integer) 11\n\n```\n\n>   [!IMPORTANT]\n>\n>   补充：这些指令都很简单，如果您需要了解更多，可以 [前往 Redis 的官网中查看](https://redis.io/docs/latest/develop/get-started/)，不过由于我们使用 `Redis` 的大部分场景都是在代码中直接进行编程（除了一些运维人员、测试人员可能需要非常了解进行必要的检查以外），因此没有必要了解得特别细（除非需要使用）...\n\n#### 3.2.2.模块指令\n\n除了基础的对于数据类型的操作指令，还有一些不同模块的指令，有需要再进行学习，不过这里先列出来：\n\n> [!CAUTION]\n>\n> 警告：模块默认不直接内嵌到 `redis service` 中，因此需要您下载 `Redis` 的拓展 `Redis Stack` 才能使用。\n>\n> ```shell\n> # 安装 Redis Stack\n> # 停止传统的 Redis 服务\n> $ sudo systemctl stop redis\n> \n> # 检查是否停止 Redis 服务\n> $ redis-cli\n> Could not connect to Redis at 127.0.0.1:6379: Connection refused\n> not connected> exit\n> \n> # 开始安装 Redis Stack\n> $ sudo apt-get install lsb-release curl gpg\n> \n> $ curl -fsSL https://packages.redis.io/gpg | sudo gpg --dearmor -o /usr/share/keyrings/redis-archive-keyring.gpg\n> \n> $ sudo chmod 644 /usr/share/keyrings/redis-archive-keyring.gpg\n> \n> $ echo \"deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/redis.list\n> \n> \n> $ sudo apt-get update\n> $ sudo apt-get install redis-stack-server\n> \n> # 由于我使用的是 Ubuntu24.04(这个时候比较新), 因此我需要使用二进制进行下载, 而无法使用包管理安装...\n> \n> # 在 https://redis.io/downloads/#redis-stack-downloads 底部获取你所需要的安装链接\n> \n> $ wget https://packages.redis.io/redis-stack/redis-stack-server-7.4.0-v1.jammy.x86_64.tar.gz\n> \n> $ mv redis-stack-server-7.4.0-v1 redis-stack-server\n> \n> $ sh redis-stack-server/bin/redis-stack-server\n> # 此时就会启动输出...您可以开始测试是否已运行该服务...\n> \n> # 打开另外一个终端开始测试\n> $ redis-cli\n> 127.0.0.1:6379> MODULE LIST\n> 1) 1) \"name\"\n>    2) \"RedisCompat\"\n>    3) \"ver\"\n>    4) (integer) 1\n>    5) \"path\"\n>    6) \"/home/ljp/temp/redis-stack-server/lib/rediscompat.so\"\n>    7) \"args\"\n>    8) (empty array)\n> 2) 1) \"name\"\n>    2) \"redisgears_2\"\n>    3) \"ver\"\n>    4) (integer) 20020\n>    5) \"path\"\n>    6) \"/home/ljp/temp/redis-stack-server/lib/redisgears.so\"\n>    7) \"args\"\n>    8) 1) \"v8-plugin-path\"\n>       2) \"/home/ljp/temp/redis-stack-server/lib/libredisgears_v8_plugin.so\"\n> 3) 1) \"name\"\n>    2) \"search\"\n>    3) \"ver\"\n>    4) (integer) 21005\n>    5) \"path\"\n>    6) \"/home/ljp/temp/redis-stack-server/lib/redisearch.so\"\n>    7) \"args\"\n>    8) 1) \"MAXSEARCHRESULTS\"\n>       2) \"10000\"\n>       3) \"MAXAGGREGATERESULTS\"\n>       4) \"10000\"\n> 4) 1) \"name\"\n>    2) \"bf\"\n>    3) \"ver\"\n>    4) (integer) 20802\n>    5) \"path\"\n>    6) \"/home/ljp/temp/redis-stack-server/lib/redisbloom.so\"\n>    7) \"args\"\n>    8) (empty array)\n> 5) 1) \"name\"\n>    2) \"ReJSON\"\n>    3) \"ver\"\n>    4) (integer) 20803\n>    5) \"path\"\n>    6) \"/home/ljp/temp/redis-stack-server/lib/rejson.so\"\n>    7) \"args\"\n>    8) (empty array)\n> 6) 1) \"name\"\n>    2) \"timeseries\"\n>    3) \"ver\"\n>    4) (integer) 11202\n>    5) \"path\"\n>    6) \"/home/ljp/temp/redis-stack-server/lib/redistimeseries.so\"\n>    7) \"args\"\n>    8) (empty array)\n> \n> # 有比较多的回显就是配置成功了\n> \n> ```\n\n##### 3.2.2.1.RediSearch(`FT`)\n\n主要用于全文搜索和数据索引功能，核心命令如：\n   - `FT.CREATE`、`FT.ADD`、`FT.SEARCH`：创建索引、添加文档、搜索查询\n   - `FT.AGGREGATE`：执行聚合查询\n   - `FT.DROPINDEX`、`FT.SYNUPDATE` 等\n\n##### 3.2.2.2.RedisJSON(`JSON`)\n\n`RedisJSON` 模块用于在 `Redis` 中存储和操作 `JSON` 数据类型，核心命令如：\n\n   - `JSON.SET`：设置 `JSON` 数据\n   - `JSON.GET`：获取 `JSON` 数据\n   - `JSON.DEL`：删除 `JSON` 键\n   - `JSON.MGET`：从多个键中获取 `JSON` 值\n\n##### 3.2.2.3.RedisGraph(`GRAPH`)\n   RedisGraph 提供了图数据库功能，用于图数据的存储和查询，核心命令如：\n   - `GRAPH.QUERY`：使用 `Cypher` 查询语言执行查询。\n   - `GRAPH.PROFILE`：分析查询性能。\n   - `GRAPH.DELETE`：删除图。\n\n##### 3.2.2.4.Redis TimeSeries(`TS`)\n`RedisTimeSeries` 是用于存储和分析时间序列数据的模块，核心命令如：\n\n   - `TS.CREATE`：创建时间序列\n   - `TS.ADD`：添加时间序列数据点\n   - `TS.RANGE`、`TS.MRANGE`：查询时间范围内的数据\n   - `TS.ALTER`：修改时间序列元数据\n\n##### 3.2.2.5.RedisAI(`AI`)\n`RedisAI` 用于在 `Redis` 中运行机器学习模型，支持 `TensorFlow, PyTorch, ONNX...` 模型，核心命令如：\n\n   - `AI.MODELSET`：加载机器学习模型\n   - `AI.MODELRUN`：运行机器学习模型\n   - `AI.SCRIPTSET`：设置自定义脚本\n   - `AI.TENSORSET` 和 `AI.TENSORGET`：处理张量数据\n\n##### 3.2.2.6.RedisBloom(`BF`, `CF`, `CMS`, `TOPK`)\n`RedisBloom` 提供了`布隆过滤器, 计数最小堆, Cuckoo Filter, TopK...` 等数据类型，适合处理大数据集合。\n\n   - **布隆过滤器** (`BF`)：`BF.ADD`、`BF.EXISTS`\n   - **Cuckoo Filter** (`CF`)：`CF.ADD`、`CF.EXISTS`\n   - **Count-Min Sketch** (`CMS`)：`CMS.INCRBY`、`CMS.QUERY`\n   - **TopK**：`TOPK.ADD`、`TOPK.QUERY`\n\n这些模块可以根据场景进行组合使用，以增强 `Redis` 数据库的功能，从而更高效地处理搜索、图数据、时间序列分析和机器学习任务。\n\n> [!IMPORTANT]\n>\n> 补充：由于有需要我补充这部分内容。\n>\n> ```shell\n> # 使用 RediSearch 和 RedisJSON 的相关指令\n> 0.0.0.0:6379> FT.CREATE \\ # 设置添加索引\n> idx:bicycle \\ # 设置索引名称\n> ON JSON \\ # 表示针对 JSON 的索引\n> PREFIX 1 bicycle: \\ # 仅对具有 \"bicycle:\" 前缀的键创建索引(这里的数字代表可以设置多个前缀)\n> SCORE 1.0 \\ # 为该索引设置评分(用于索引之间进行评分比较)\n> SCHEMA \\ # 后面定义字段的模式\n> $.brand AS brand TEXT WEIGHT 1.0 \\\n> $.model AS model TEXT WEIGHT 1.0 \\\n> $.description AS description TEXT WEIGHT 1.0 \\\n> $.price AS price NUMERIC \\\n> $.condition AS condition \\\n> TAG SEPARATOR \",\" # 设置标签, 用于分割不同 JSON 对象\n> # 完整一行指令为 FT.CREATE idx:bicycle ON JSON PREFIX 1 bicycle: SCORE 1.0 SCHEMA $.brand AS brand TEXT WEIGHT 1.0 $.model AS model TEXT WEIGHT 1.0 $.description AS description TEXT WEIGHT 1.0 $.price AS price NUMERIC $.condition AS condition TAG SEPARATOR \",\"\n> OK\n> \n> # 上述描述的就是一个 JSON 对象的集合\n> # {\n> #   \"bicycle:xxx\": {\n> #     \"brand\": \"\",\n> #     \"model\": \"\",\n> #     \"description\": \"\",\n> #     \"price\": 0,\n> #     \"condition\": \"\"\n> #   },\n> # }\n> \n> # 可以使用 FT.INFO idx:bicycle 查看配置结果\n> \n> # 设置 \"键名-JSON:\" 对\n> 0.0.0.0:6379> JSON.SET \\\n> \"bicycle:0\" \\\n> \".\" \\ # 存储在根处, 也可以是只设置字段\n> \"{\\\"brand\\\": \\\"Velorim\\\", \\\"model\\\": \\\"Jigger\\\", \\\"price\\\": 270, \\\"description\\\": \\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\\\u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\", \\\"condition\\\": \\\"new\\\"}\"\n> # 完整指令为 JSON.SET \"bicycle:0\" \".\" \"{\\\"brand\\\": \\\"Velorim\\\", \\\"model\\\": \\\"Jigger\\\", \\\"price\\\": 270, \\\"description\\\": \\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\\\u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\", \\\"condition\\\": \\\"new\\\"}\"\n> \n> # 获取键对应 JSON 的某个字段\n> 0.0.0.0:6379> JSON.GET bicycle:0 $.brand $.price\n> \"{\\\"$.brand\\\":[\\\"Velorim\\\"],\\\"$.price\\\":[270]}\"\n> \n> # 更新键对应 JSON 的某个字段\n> 0.0.0.0:6379> JSON.SET bicycle:1234 $ '{\"price\": 600}'\n> \n> # 查卡键对应 JSON 的所有字段‘\n> 0.0.0.0:6379> JSON.GET bicycle:0\n> \"{\\\"brand\\\":\\\"Velorim\\\",\\\"model\\\":\\\"Jigger\\\",\\\"price\\\":270,\\\"description\\\":\\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\",\\\"condition\\\":\\\"new\\\"}\"\n> \n> # 不过我们使用的是 JSON.GET, 如果使用 FT.SEARCH 还能用于执行基于全文索引的搜索查询, 它结合了索引、评分、排序和过滤功能, 可以用于复杂的搜索操作...\n> \n> # 使用 FT 的查询\n> 0.0.0.0:6379> FT.SEARCH \"idx:bicycle\" \"*\" LIMIT 0 10\n> 1) (integer) 1\n> 2) \"bicycle:0\"\n> 3) 1) \"$\"\n>    2) \"{\\\"brand\\\":\\\"Velorim\\\",\\\"model\\\":\\\"Jigger\\\",\\\"price\\\":270,\\\"description\\\":\\\"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\xe2\\x80\\x99 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\\\",\\\"condition\\\":\\\"new\\\"}\"\n> \n> ```\n>\n> 更多待补充...\n\n#### 3.2.3.自定指令\n\n除了已有的基础指令和模块指令，还可以使用 `Lua` 脚本代码编写出用户自己定义的指令，待补充...\n\n### 3.3.数据类型\n\n#### 3.3.1.数据类型分类\n\n知道前面的基础指令后，就可以知道 `Redis` 是一个跨语言的大号键值对存储数据库，但是除了简单的字符类型以外，键位对应的值还可以是其他数据类型，主要的数据类型有一下六种。\n\n-   **字符 String** 最基本的数据类型，支持二进制安全的字符串\n-   **列表 List** 按插入顺序存储的字符串列表，支持从两端推入和弹出操作\n-   **无权集合 Set** 无序无权字符串集合，不允许重复元素\n-   **带权集合 Zset** 有序有权字符串集合，保留集合无序不可重复的特点，但每个成员都有一个与之关联的分数（是允许重复的浮点数），并可以按分数排序\n-   **键值集合 Hash** 键值对的集合，适用于存储对象的字段和对应的值，也可以叫哈希，这意味着键对应的值也可以是一系列键值对（有点套娃）\n-   **空值 None** 当键值对不存在时的一种特殊类型\n\n>   [!IMPORTANT]\n>\n>   补充：也有一些比较高级的类型，有很多是字符类型演变而来。\n>\n>   -   **位图 bitmap** 可以看作是一种压缩的数据类型，按位存储数据\n>   -   **地理位置 geospatial** 用于存储地理位置数据并进行地理空间查询\n>   -   **流 stream** 用于存储和管理日志数据、消息队列等类型的数据，流的条目按时间戳进行排序\n>   -   **基数 HyperLogLog** 用于统计某个数据流中不重复元素的数量（如果您的需求是要 **存储所有的元素并进行操作**，那么 `Set` 是合适的选择；如果您只是需要 **估算独立元素的数量**，且不关心精确值，那么 `Hyper LogLog` 会更高效）\n>   -   ...\n\n>   [!IMPORTANT]\n>\n>   补充：流的存在，使得 `Redis` 可以简单充当一个消息队列，但是这不是 `Redis` 的主要应用场景。不过这可以作为中小型项目的消息队列组件，尤其是在已经引入 `Redis` 时，可以快速把 `Redis` 作为消息队列，减低系统复杂度。\n\n#### 3.3.2.外部数据类型\n\n##### 3.3.2.1.String 的基本操作\n\n```shell\n# String\n0.0.0.0:6379> set mystring \"hello\"\nOK\n\n0.0.0.0:6379> type mystring\nstring\n\n```\n\n##### 3.3.2.2.List 的基本操作\n\n```shell\n# List\n0.0.0.0:6379> lpush mylist \"item1\"\n(integer) 1\n\n0.0.0.0:6379> lpush mylist \"item2\"\n(integer) 2\n\n0.0.0.0:6379> lpush mylist \"item3\"\n(integer) 3\n\n0.0.0.0:6379> lrange mylist 0 -1 # 查询列表所有元素, 0 表示最先一个元素, -1 表示最后一个元素\n1) \"item3\"\n2) \"item2\"\n3) \"item1\"\n0.0.0.0:6379> lrange mylist 1 1 # 查询 mylist [1] 处的元素\n1) \"item2\"\n0.0.0.0:6379> type mylist\nlist\n\n# 除此以外还有阻塞版本的指令, 例如 blpop 和 brpop\n# 在有数据的情况下行为与 lpop 和 rpop 一致\n# 但无数据的情况下 lpop 和 rpop 会立刻返回 nil, 客户端呈现请求阻塞状态, 且期间 Redis 可以继续执行其他指令, 如果超出设定的 timeout 也会返回 nil\n\n```\n\n##### 3.3.2.3.Set 的基本操作\n\n```shell\n# Set\n0.0.0.0:6379> sadd myset \"member1\"\n(integer) 1\n\n0.0.0.0:6379> sadd myset \"member2\"\n(integer) 1\n\n0.0.0.0:6379> sadd myset \"member3\"\n(integer) 1\n\n0.0.0.0:6379> smembers myset\n1) \"member3\"\n2) \"member2\"\n3) \"member1\"\n\n0.0.0.0:6379> sismember myset \"member1\"\n(integer) 1\n\n0.0.0.0:6379> sismember myset \"member4\"\n(integer) 0 # 表示不存在这个元素\n\n0.0.0.0:6379> type myset\nset\n\n# Redis 除了支持增删查改的基础操作, 也支持交集(sinterstore/sinter)、并集(sunionstore/sunion)、差集(sdiffstore/sdiff)\n```\n\n##### 3.3.2.4.Zset 的基本操作\n\n```shell\n# Zset\n# 添加\n0.0.0.0:6379> zadd myzset 3 \"member3\"\n(integer) 1 # 添加成功个数\n\n0.0.0.0:6379> zadd myzset 2 \"member2\"\n(integer) 1\n\n0.0.0.0:6379> zadd myzset 1 \"member1\"\n(integer) 1\n\n# 查询\n0.0.0.0:6379> zcrd myzset\n(integer) 3 # zset 的元素个数\n\n0.0.0.0:6379> zrange myzset 0 -1\n1) \"member1\"\n2) \"member2\"\n3) \"member3\"\n\n0.0.0.0:6379> zrank myzset \"member2\" # 查找是否存在元素并且返回排名\n(integer) 1\n\n0.0.0.0:6379> zrank myzset \"member3\"\n(integer) 2\n\n0.0.0.0:6379> zrank myzset \"member1\"\n(integer) 0\n\n0.0.0.0:6379> type myzset\nzset\n\n# 除此以外还有一些额外的选项\n# ZADD key [XX | NX]: 仅仅⽤于更新已经存在的元素, 不会添加新元素; 仅⽤于添加新元素，不会更新已经存在的元素\n# ZADD key [GT | LT]: Greater Than, 表示“大于”, 通常用于范围查询中, 表示取值大于某个指定的值; Less Than, 表示“小于”, 通常用于范围查询中, 表示取值小于某个指定的值\n# ZADD key [CH]: 默认情况下, ZADD 返回的是本次添加的元素个数, 但指定这个选项之后, 就会还包含本次更新的元素的个数\n# ZADD key [INCR]: 此时命令类似 ZINCRBY 的效果, 将元素的分数加上指定的分数, 此时只能指定⼀个元素和分数\n\n# 也支持集合, 并且是聚合集合\n\n```\n\n>   [!IMPORTANT]\n>\n>   补充：`ZINTERSTORE` 是 `Redis` 的一个命令，用于对多个有序集合（`ZSET`）进行交集操作，并将结果存储到指定的目标集合中。具体来说，`ZINTERSTORE` 会计算多个有序集合的交集，并根据权重和聚合方式合并它们的分数，然后将结果保存在指定的目标集合中。\n>\n>   ```shell\n>   # 聚合搜索\n>   0.0.0.0:6379> zinterstore destination numkeys key [key ...] [weights weight [weight ...]] [aggregate <sum | min | max>]\n>   # (1) destination: 目标集合的名称，交集的结果将存储在这个集合中\n>   # (2) numkeys: 输入的有序集合的数量(key 的数量)\n>   # (3) key [key ...]: 参与交集操作的多个有序集合的键名\n>   # (4) weights weight [weight ...]: 可选参数, 指定每个集合的权重(默认权重为 1), 如果提供了权重, Redis 会按权重计算每个集合中的元素分数\n>   # (5) aggregate <sum | min | max>: 可选参数, 指定合并多个集合元素时如何聚合它们的分数\n>   \t# sum 表示分数相加(默认)\n>   \t# mim 表示取最小值\n>   \t# max 表示取最大值\n>   ```\n\n##### 3.3.2.5.Hash 的基本操作\n\n```shell\n# Hash\n0.0.0.0:6379> hset myhash field1 \"value1\"\n(integer) 1\n\n0.0.0.0:6379> hset myhash field2 \"value2\"\n(integer) 1\n\n0.0.0.0:6379> hset myhash field3 \"value3\"\n(integer) 1\n\n0.0.0.0:6379> hkeys myhash # 获取哈希中的所有字段\n1) \"field1\"\n2) \"field2\"\n3) \"field3\"\n\n0.0.0.0:6379> hvals myhash # 获取哈希中的所有值\n1) \"value1\"\n2) \"value2\"\n3) \"value3\"\n\n0.0.0.0:6379> hexists myhash field2 # 检查某个字段是否存在于哈希中\n(integer) 1\n\n0.0.0.0:6379> type myhash\nhash\n\n```\n\n>   [!IMPORTANT]\n>\n>   补充：`Redis` 内部的哈希通常被称为 `field-value` 对，这主要是为了和 `Readis` 本身的 `key-value` 做区分。\n\n> [!IMPORTANT]\n>\n> 补充：使用 `HGETALL` 获取哈希元素个数过多时，就有可能阻塞 `Redis`，这种情况下可以使用 `HSCAN` 扫描指令。\n\n##### 3.3.2.6.None 的基本操作\n\n```shell\n# None\n0.0.0.0:6379> type non_existing_key\nnone\n\n```\n\n#### 3.3.3.高级数据类型\n\n下面补充一些高级数据类型的使用。\n\n##### 3.3.3.1.Bitmap\n\n```shell\n# Bitmap\n0.0.0.0:6379> setbit mybitmap 7 1 # 设置第 7 位为 1\n(integer) 0\n\n0.0.0.0:6379> setbit mybitmap 2 1 # 设置第 2 位为 1\n(integer) 0\n\n0.0.0.0:6379> getbit mybitmap 7 # 查看第 7 位设置的比特值\n(integer) 1\n\n0.0.0.0:6379> getbit mybitmap 6 # 查看第 7 位设置的比特值\n(integer) 0\n\n0.0.0.0:6379> bitcount mybitmap # 统计位图中总共有多少个设置为 1 的比特位\n(integer) 2\n\n```\n\n##### 3.3.3.2.Geospatial\n\n```shell\n# Geospatial\n0.0.0.0:6379> geoadd myplaces 13.361389 38.115556 \"Palermo\" # 设置一个地理位置, 这里设置了经纬度和地名\n(integer) 1\n\n0.0.0.0:6379> geoadd myplaces 15.087269 37.502669 \"Catania\"\n(integer) 1\n\n0.0.0.0:6379> geopos myplaces \"Palermo\" # 查询某个位置的经纬度\n1) 1) \"13.36138933897018433\"\n   2) \"38.11555639549629859\"\n\n0.0.0.0:6379> geodist myplaces \"Palermo\" \"Catania\" km # 查询两个地点之间的距离, 以 km 单位\n\"166.2742\"\n\n0.0.0.0:6379> georadius myplaces 15 37 100 km # 查询以经纬度 15, 37 为中心, 半径为 100km 的所有地名\n1) \"Catania\"\n\n```\n\n##### 3.3.3.3.Stream\n\n```shell\n# Stream\n# 添加流\n0.0.0.0:6379> xadd \\ # 添加流的指令\n              mystream \\ # 设置流的名称\n              * \\ # * 代表由 Redis 自己生成时间戳\n              name \"limou\" age 18 # 代表流存储的数据\n\"1723358298361-0\"\n# 每条消息都有一个唯一的 ID, 这个 ID 由两部分组成, 使用 - 分隔\n# 第一部分是一个时间戳(毫秒级), 表示消息被写入流的时间\n# 第二部分是一个序列号, 用来区分同一时间戳下的不同消息(为了区分同时间戳)\n\n0.0.0.0:6379> xadd mystream * name \"eimou\" age 10\n\"1723358303994-0\"\n\n0.0.0.0:6379> xadd mystream * name \"gimou\" age 20\n\"1723358311147-0\"\n\n# 查询流\n0.0.0.0:6379> keys *\n1) \"mystream\"\n0.0.0.0:6379> xread count 3 streams mystream 0 # 0 表示从流的开始读取所有的消息\n1) 1) \"mystream\"\n   2) 1) 1) \"1723358298361-0\"\n         2) 1) \"name\"\n            2) \"limou\"\n            3) \"age\"\n            4) \"18\"\n      2) 1) \"1723358303994-0\"\n         2) 1) \"name\"\n            2) \"eimou\"\n            3) \"age\"\n            4) \"10\"\n      3) 1) \"1723358311147-0\"\n         2) 1) \"name\"\n            2) \"gimou\"\n            3) \"age\"\n            4) \"20\"\n\n0.0.0.0:6379> xread count 3 streams mystream $ # $ 表示从最新的数据开始读取所有的消息\n(nil)\n\n0.0.0.0:6379> xread count 3 streams mystream 1723358311147-0 # 直接使用流 ID 查询就是读取该 ID 之后的所有消息\n(nil)\n\n0.0.0.0:6379> xread count 3 streams mystream 1723358303994-0\n1) 1) \"mystream\"\n   2) 1) 1) \"1723358311147-0\"\n         2) 1) \"name\"\n            2) \"gimou\"\n            3) \"age\"\n            4) \"20\"\n\n0.0.0.0:6379> xread count 3 streams mystream 1723358298361-0\n1) 1) \"mystream\"\n   2) 1) 1) \"1723358303994-0\"\n         2) 1) \"name\"\n            2) \"eimou\"\n            3) \"age\"\n            4) \"10\"\n      2) 1) \"1723358311147-0\"\n         2) 1) \"name\"\n            2) \"gimou\"\n            3) \"age\"\n            4) \"20\"\n# 这种情况下是直接消费数据的, 并且数据不会因为消费消失\n\n```\n\n##### 3.3.3.4.HyperLogLog\n\n```shell\n# HyperLogLog\n0.0.0.0:6379> PFADD ip_set \\\n                \"192.168.0.1\" \\\n                \"192.168.0.2\" \\\n                \"192.168.0.3\" \\\n                \"192.168.0.1\" \\ # 这个是重复的 IP 地址\n                \"192.168.0.4\" \\\n                \"192.168.0.5\" # 完整指令为 PFADD ip_set \"192.168.0.1\" \"192.168.0.2\" \"192.168.0.3\" \"192.168.0.1\" \"192.168.0.4\" \"192.168.0.5\"\n(integer) 1\n\n0.0.0.0:6379> PFCOUNT ip_set\n(integer) 5\n```\n\n>   [!IMPORTANT]\n>\n>   补充：不知道您有没有发现很相当大的一部分数据类型是由 `string` 这个类型衍生出来的，因此如果需要细学其他的类型，就必须先对 `string` 有足够的理解，首先您至少需要知道几件事：\n>\n>   -   所有的键名类型都是字符类型\n>   -   字符串类型的键值可以单纯是（但是一个字符串的最大值不能是 `512MB`）：\n>       -   字符串\n>       -   一般格式的 `JSON`\n>       -   一般格式的 `XML`\n>       -   数字\n>       -   二进制流\n>\n>   -   `Redis` 内部存储的字符串是完全按照二进制流的形式保存的，所以不需要处理字符集编码，客户端传入的是什么字符集就存储什么\n\n#### 3.3.4.内部数据类型\n\n实际上 `Redis` 针对每一种数据类型都有自己的底层内部编码实现，而且是多种实现，这样 `Redis` 就会根据合适的场景选择合适的内部编码，例如下表（除去空类型剩下的五个类型）。\n\n| **数据类型** | **内部编码**                                   |\n| ------------ | ---------------------------------------------- |\n| String       | `raw(>=39byte), int(8 byte), embstr(<=39byte)` |\n| List         | `linkedlist, ziplist`                          |\n| Set          | `hashtable, intset`                            |\n| Zset         | `skiplist, ziplist`                            |\n| Hash         | `hashtable, ziplist`                           |\n\n>   [!IMPORTANT]\n>\n>   补充：我们可以通过 `object encoding 键名` 查询此时键的内部编码。\n\n`Redis` 这样设计有两个好处：\n\n-   方便 `Redis` 未来改进内部编码，而对外的数据类型和命令没有任何影响，这样可以开发出更优秀的内部编码\n-   多种内部编码实现可以在不同场景下发挥各自的优势，例如 `ziplist` 比较节省内存，但是在列表元素比较较多的情况下，性能会下降，这时候 `Redis` 会根据配置选项将列表类型的内部实现转换为 `linkedlist`，整个过程用户是全无感知的\n\n##### 3.3.4.1.String 的内部编码\n\n尤其是字符串类型，内部编码至少有三种，`Redis` 会自动根据当前的值来决定使用哪一种内部编码进行实现。\n\n-   **int(8byte 的长整型)**\n\n-   **embstr(<= 39byte 的字符串)**\n\n-   **raw(> 39byte 的字符串)**\n\n```shell\n# 查看 string 内部编码的变化\n0.0.0.0:6379> set key 123\nOK\n\n0.0.0.0:6379> object encoding key\n\"int\"\n\n0.0.0.0:6379> set key limou\nOK\n\n0.0.0.0:6379> object encoding key\n\"embstr\"\n\n0.0.0.0:6379> set key limou343434343434343434343434343434343434343434343434343434343434\nOK\n\n0.0.0.0:6379> object encoding key\n\"raw\"\n```\n\n##### 3.3.4.2.List 的内部编码\n\n-   **ziplist(压缩列表)**：下面两个条件同时满足时\n\n    -   列表元素个数小于 `list-max-ziplist-entries` 配置（默认 `512` 个）\n    -   列表元素长度小于 `list-max-ziplist-value` 配置（默认 `64` 字节）\n\n    `Redis` 会使用压缩列表（`ziplist`）作为列表的内部编码方式，从而减少内存消耗\n\n-   **linkedlist(链表)**：当哈希类型无法满足 `ziplist` 的条件时，`Redis` 会使⽤ `hashtable` 作为哈希的内部实现，`Redis` 会选择使用 `linkedlist` 作为列表的内部实现。\n\n##### 3.3.4.3.Set 的内部编码\n\n-   **intset(整数集合)**：\n\n    -   集合元素的个数小于 `set-max-intset-entries` 配置（默认最大 `512` 个元素）\n    -   集合元素值都是整数\n\n    `Redis` 会使用 `intset` 作为集合的内部实现，`intset` 是一个专门优化整数集合的压缩结构，可以显著减少内存使用。\n\n-   **hashtable(哈希表)**：当列表类型无法满足 `intset` 的条件时，`Redis` 会使用 `hashtable` 作为集合的内部实现。`hashtable` 提供了高效的插入、查找和删除操作，适用于较大的集合。\n\n##### 3.3.4.4.Zset 的内部编码\n\n-   **ziplist(压缩列表)**：\n\n    - 集合元素的个数小于 `zset-max-ziplist-entries` 配置（默认 `128` 个）\n    - 每个元素的值都小于 `zset-max-ziplist-value` 配置（默认 `64` 字节）\n\n    `Redis` 会⽤ `ziplist` 来作为有序集合的内部实现，`ziplist` 可以有效减少内存消耗\n\n-   **skiplist(跳表)**：当 `ziplist` 条件不满足时，有序集合会使用 `skiplist` 作为内部实现，因为此时 `ziplist` 的操作效率会下降。\n\n##### 3.3.4.5.Hash 的内部编码\n\n哈希本身的内部编码变化也值得我们关注，内部的编码实现至少有两种 `ziplist(压缩列表), hashtable(哈希表)`，这就比字符串要复杂一些。\n\n- **ziplist(压缩列表)**：下面两个条件同时满足时\n  \n  - 哈希元素个数小于 `hash-max-ziplist-entries` 配置（默认 `512` 个）\n  - 哈希元素值都小于 `hash-max-ziplist-value` 配置（默认 `64` 字节）\n  \n  `Redis` 会使⽤ `ziplist` 作为哈希的内部实现，`ziplist` 使用更加紧凑的结构实现多个元素的连续存储，所以在节省内存方面比 `hashtable` 更加优秀。\n  \n- **hashtable(哈希表)**：当哈希类型无法满足 `ziplist` 的条件时，`Redis` 会使⽤ `hashtable` 作为哈希的内部实现，因为此时 `ziplist` 的读写效率会下降，而 `hashtable` 的读写时间复杂度为 `O(1)`。\n\n```shell\n# 查看 Hash 内部编码的变化(略)\n```\n\n##### 3.3.4.6.None 的内部编码\n\n待补充...\n\n#### 3.3.4.数据类型原理\n\n待补充...\n\n### 3.4.渐进遍历\n\n`Redis` 提供了 `SCAN` 命令，允许用户以渐进式的方式进行键的遍历，避免了阻塞操作，适用于遍历大量数据的场景。\n\n```shell\nSCAN cursor [MATCH pattern] [COUNT count] [TYPE type]\n# cursor: 游标，初始值为 `0`，返回的游标值指示下次扫描的位置。\n# MATCH pattern: 可选参数，用于过滤键名，支持模式匹配（类似于 `glob` 模式）。\n# COUNT count: 可选参数，建议每次返回的元素数量。并不是严格的数量限制，实际返回数量可能会有所不同。\n# TYPE type: 可选参数，指定键的类型（如 `string`, `list`, `set`, `zset`, `hash` 等）。\n```\n\n`SCAN` 命令的时间复杂度是常数时间 $O(1)$，但遍历大数据集时，实际的时间复杂度会受到 `MATCH` 和 `COUNT` 参数的影响。\n\n```bash\nredis 127.0.0.1:6379> scan 0\n1) \"17\"\n2) 1) \"key:12\"\n   2) \"key:8\"\n   3) \"key:4\"\n   4) \"key:14\"\n   5) \"key:16\"\n   6) \"key:17\"\n   7) \"key:15\"\n   8) \"key:10\"\n   9) \"key:3\"\n   10) \"key:7\"\n   11) \"key:1\"\n\nredis 127.0.0.1:6379> scan 17\n1) \"0\"\n2) 1) \"key:5\"\n   2) \"key:18\"\n   3) \"key:0\"\n   4) \"key:2\"\n   5) \"key:19\"\n   6) \"key:13\"\n   7) \"key:6\"\n   8) \"key:9\"\n   9) \"key:11\"\n```\n\n`Redis` 还为不同数据类型提供了相应的 `SCAN` 命令变种，功能与 `SCAN` 基本类似：\n\n- **hscan**: 用于扫描哈希类型的数据。\n- **sscan**: 用于扫描集合类型的数据。\n- **zscan**: 用于扫描有序集合类型的数据。\n\n它们的语法和使用方式与 `SCAN` 相同，只是针对特定类型的数据进行扫描。\n\n```bash\nhscan key cursor [MATCH pattern] [COUNT count]\nsscan key cursor [MATCH pattern] [COUNT count]\nzscan key cursor [MATCH pattern] [COUNT count]\n```\n\n>   [!CAUTION]\n>\n>   警告：`scan` 在使用过程中也有值得注意的地方。\n>\n>   - **渐进性遍历**：`SCAN` 命令是渐进式的，它不会一次性返回所有数据，而是通过多次调用来遍历数据。每次返回部分数据，并返回一个游标，指示下一次扫描的位置。\n>\n>   - **遍历期间的数据变化**：在扫描期间，如果 `Redis` 数据发生变化（例如增加、修改或删除键），可能会导致以下问题：\n>\n>       - **重复遍历**：某些键可能会被扫描多次\n>       - **遗漏数据**：某些键可能会被遗漏\n>\n>       因此，在使用 `SCAN` 命令时，开发者应考虑到数据可能会在遍历过程中发生变化的情况。\n\n### 3.5.键值空间\n\n与 `MySQL` 等关系型数据库不同的是，`Redis` 没有表、字段这种命名空间，而且也没有对键名有强制要求（除了不能使用一些特殊字符）。但设计合理的键名，有利于防止键冲突和项目的可维护性，比较推荐的方式是使用 ==\"业务名:对象名:唯一标识:属性\"== 作为键名。例如 `MySQL` 的数据库名为 `vs`，用户表名为 `user_info`，那么对应的键 `name` 可以使用 `\"vs:user_info:6379:name\"` 来表示，如果当前 `Redis` 只会被⼀个业务使用，可以省略业务名 `\"vs:\"`。\n\n>   [!WARNING]\n>\n>   注意：键名过长也会影响到 `Redis` 的性能。\n\n>   [!CAUTION]\n>\n>   警告：`Redis` 中虽然支持持多数据库，但随着版本的升级，其实不是特别建议使⽤多数据库特性。如果真的需要完全隔离的两套键值对，更好的做法是维护多个 `Redis` 实例，而不是在⼀个 `Redis` 实例中维护多数据库。这是因为本身 `Redis` 并没有为多数据库提供太多的特性，其次无论是否有多个数据库，`Redis` 都是使用单线程模型，所以彼此之间还是需要排队等待命令的执行。同时多数据库还会让开发、调试和运维⼯作变得复杂。所以实践中，始终使用数据库 `0` 其实是⼀个很好的选择。\n\n>   [!CAUTION]\n>\n>   警告：`flushdb/flushall` 命令用于清除数据库，区别在于 `flushdb` 只清除当前数据库，`flushall` 会清理所有数据库（这些行为很接近删库）。\n\n### 3.6.设计架构\n\n实际上 `Redis` 采用的是单线程的架构，但是为什么采用单线程还能这么快呢？主要原因如下：\n\n-   纯内存访问，这是最重要的一点，工作环境和 `MySQL` 等持久化数据库完全不一样\n-   非阻塞 `IO` 模型，底层用 `epoll` 的 `ET` 模式，无论时连接、读写、关闭都被转化为事件来处理，因此不会在网络 `IO` 上浪费太多时间\n-   单线程模型，无论客户端如何操作，在微观上一定时存在时间差的，因此就避免了线程切换开销的问题和并发加锁的问题\n\n`Redis` 的这种特性，导致 `Redis` 只能作用于快速执行场景的热数据，一旦某个操作过长，就会导致严重延时的响应，这对 `Redis` 服务几乎是致命的。\n\n### 3.7.的持久化\n\n#### 3.7.1.RDB\n\n##### 3.7.1.1.RDB 的简单介绍\n\n`Redis` 的 **RDB(Redis Database)** 持久化机制是将当前内存中的数据生成快照并保存到磁盘的过程。`RDB` 是一种高效的持久化方式，但它有可能丢失短时间内的数据更新。\n\n转储的 `RDB` ⽂件保存在 `dir` 配置指定的目录下（默认 `/var/lib/redis/`），⽂件名通过 `dbfilename` 配置（默认 `dump.rdb`）指定。可以通过执行 `config set dir {newDir}` 和 `config set dbfilename {newFilename}` 运行期间动态执行，当下次运行时 `RDB` ⽂件会保存到新目录。\n\n`Redis` 默认采⽤ `LZF` 算法对⽣成的 `RDB` ⽂件做压缩处理，压缩后的文件远远小于内存大小，默认开启，可以通过参数 `config set rdbcompression {yes|no}` 动态修改。\n\n>   [!IMPORTANT]\n>\n>   补充：虽然压缩 `RDB` 会消耗 `CPU`，但可以大幅降低文件的体积，方便保存到硬盘或通过网络发送到 **从节点**，因此建议开启。\n\n##### 3.7.1.2.RDB 的触发机制\n\n###### 3.7.1.2.1.手动触发\n\n*   `save`：在执行 `save` 命令时，`Redis` 会阻塞当前服务器，直到 `RDB` 过程完成为止。对于大规模数据集会导致长时间的阻塞，因此在实际使用中很少采用。\n*   `bgsave`：执行 `bgsave` 命令时，`Redis` 通过 `fork` 创建一个子进程来处理 `RDB` 持久化，主进程不会被阻塞，持久化任务由子进程处理。`RDB` 完成后，子进程会自动结束，主进程继续处理其他请求。\n\n###### 3.7.1.2.2.自动触发\n\n除了手动触发，`Redis` 还支持以下几种自动触发的机制：\n\n*   `save`：通过配置文件中的 `save m n` 指令，`Redis` 会在每隔 `m` 秒内数据集发生了 `n` 次修改时，自动触发 `RDB` 持久化\n*   从节点复制操作：当 `Redis` 的 **从节点** 进行全量复制时，主节点会自动执行 `RDB` 持久化，并将生成的 `RDB` 文件内容发送给从节点\n*   `shutdown`：当执行 `shutdown` 命令关闭 `Redis` 时，`Redis` 会自动执行 `RDB` 持久化，确保数据的持久性\n\n##### 3.7.1.3.RDB 的实现原理\n\n![](./assets/image-20241120211127863.png)\n\n1.   执行 `bgsave` 后父进程检查是否有其他的持久化子进程在执行持久化操作\n2.   父进程通过 `fork` 创建持久化子进程，`fork` 的过程中父进程会轻微阻塞，通过 `info stats` 命令查看 `latest_fork_usec` 选项，可以获取最近一次 `fork` 操作的耗时，单位为微秒\n3.   `bgsave` 命令返回并释放父进程，继续处理请求\n4.   子进程执行 `RDB` 持久化操作，根据父进程内存生成老师快照文件，完成并原子化替换原始的 `RDB` 文件，执行 `lastsave` 命令就可以获取最后一次生成 `RDB` 的时间，对应 `info` 统计的 `rdb_last_save_time` 选项\n5.   子进程发送信号通知父进程操作完成，父进程更新统计信息\n\n##### 3.7.1.4.RDB 的优势劣势\n\n-   `RDB` 文件是一个紧凑压缩的二进制文件，代表 `Redis` 在某个时间点上的数据快照 `RDB` 非常适用于备份、全量复制等场景。例如，每 `6` 小时执行 `bgsave` 备份，并把 `RDB` 文件复制到远程机器或者文件系统（如 `HDFS`）用于灾备。而 `Redis` 加载 `RDB` 恢复数据的速度远快于 `AOF` 的方式。\n-   `RDB` 方式无法做到实时持久化或秒级持久化，因为 `bgsave` 每次执行都要进行 `fork` 创建子进程，这属于重量级操作，频繁执行成本过高。另外，由于 `RDB` 文件使用特定的二进制格式保存，随着 `Redis` 版本演进，`RDB` 格式可能发生变化，存在兼容性风险。\n\n#### 3.7.2.AOF\n\n##### 3.7.2.1.AOF 的简单介绍\n\n`Redis` 的 **AOF(Append Only File)** 持久化机制，以独立日志的方式记录每次写命令，重启时再重新执行 `AOF` 文件中的命令以达到恢复数据的目的。`AOF` 的主要作用是解决了数据持久化的实时性问题，目前已经成为 `Redis` 持久化的主流方式。\n\n##### 3.7.2.2.AOF 的触发机制\n\n###### 3.7.2.2.1.启用持久\n\n默认 `AOF` 是不开启的，需要配置设置 `appendonly yes` 才可以打开，`AOF` ⽂件名通过 `appendfilename` 配置（默认是 `appendonly.aof`）设置。保存目录同 `RDB` 持久化方式一直，也是通过 `dir` 配置来指定。\n\n`AOF` 开启后，写命令也会被写入到缓存中，写入的持久化内容是以文本协议格式进行的。例如，`set hello world` 这条命令在 `AOF` 缓冲区会追加如下文本：\n\n```shell\n*3\\r\\n$3\\r\\nset\\r\\n$5\\r\\nhello\\r\\n$5\\r\\nworld\\r\\n\n```\n\n这里遵循了 `Redis` 协议格式。`Redis` 选择文本协议的原因主要包括：\n\n- **兼容性**：文本协议具有较好的跨平台兼容性。\n- **实现简单**：文本协议易于理解和实现。\n- **可读性**：文本格式直观，便于调试和查看。\n\n在 `AOF` 过程中，需要一个名为 `aof_buf` 的缓冲区。`Redis` 使用单线程响应命令，如果每次写 `AOF` 文件都直接同步到硬盘，会导致性能下降，因为每次操作都涉及到 `IO` 读写，这比内存读写要慢。通过先写入缓冲区，可以有效减少 `IO` 次数。同时，`Redis` 提供了多种缓冲区同步策略，允许用户根据实际需求进行性能和数据持久性的平衡。\n\n###### 3.7.2.2.2.同步策略\n\n`Redis` 提供了多种 `AOF` 缓冲区同步文件策略，通过参数 `appendfsync` 控制。不同值的含义如下：\n\n| 可配置值   | 说明                                                         | 建议                                                         |\n| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| `always`   | 命令写入 `aof_buf` 后调用 `fsync` 同步，完成后返回。         | 每次写入都同步 `AOF` 文件，数据安全性最高。但是性能非常差，在一般的 `SATA` 硬盘上，只能支持约几百 `TPS` 的写入量。因此除非数据极其重要，否则不建议配置。 |\n| `everysec` | 命令写入 `aof_buf` 后只执行 `write` 操作，不进行 `fsync`。每秒由同步线程进行 `fsync`。 | 默认配置，也是推荐配置。命令写入 `aof_buf` 后立即返回，由同步线程每秒执行一次 `fsync`。兼顾数据安全性和性能，理论上最多丢失 `1` 秒的数据。 |\n| `no`       | 命令写入 `aof_buf` 后只执行 `write` 操作，由操作系统控制 `fsync` 频率。 | 操作系统自行决定同步策略，性能较高，但数据丢失风险较大。仅适用于数据重要性极低的场景。 |\n\n- **`write` 操作：**  \n    - 会触发 **延迟写** 机制。\n    - `Linux` 在内核中提供页面缓冲区，用来提升硬盘 `IO` 性能\n    - `write` 操作在数据写入系统缓冲区后立即返回，数据同步到硬盘依赖系统调度机制（如缓冲区写满或达到特定时间周期）\n    - 在数据同步到硬盘之前，如果系统发生故障或宕机，缓冲区内的数据将丢失\n\n- **`fsync` 操作：**  \n    - 针对单个文件操作，执行强制硬盘同步\n    - `fsync` 会阻塞当前操作，直到数据写入到硬盘为止\n\n在大多数场景下，推荐使用 `everysec` 配置，以获得较好的数据安全性和系统性能平衡。\n\n###### 3.7.2.2.3.触发重写\n\n3.7.2.2.3.1.手动触发\n\n手动触发 `AOF` 重写可以通过执行 `BGREWRITEAOF` 命令。\n\n```bash\nredis-cli BGREWRITEAOF\n```\n\n该命令会在后台执行 `AOF` 文件重写操作，将当前数据库状态保存到新的 `AOF` 文件中。\n\n3.7.2.2.3.2.自动触发\n\n`AOF` 重写也可以根据以下两个参数自动触发：\n\n-   `auto-aof-rewrite-min-size`：该参数表示触发 `AOF` 重写时，`AOF` 文件的最小大小。默认值为 `64MB`。当 `AOF` 文件的大小超过这个最小值时，`Redis` 会考虑是否进行自动重写。\n-   `auto-aof-rewrite-percentage`：该参数表示当前 `AOF` 文件大小相对于上次重写时的增长百分比。只有当 `AOF` 文件的大小增加超过这个百分比时，才会触发自动重写。默认值为 `100%`。\n\n##### 3.7.2.3.AOF 的实现原理\n\n![](./assets/image-20241120221238022.png)\n\n1. 所有的写入命令会追加到 `aof_buf`（缓冲区）中\n2. `AOF` 缓冲区根据对应的策略向硬盘进行同步操作\n3. 随着 `AOF` 文件增大，需要定期对 `AOF` 文件进行等价重写，以达到压缩目的\n4. 当 `Redis` 服务器启动时，可以加载 `AOF` 文件进行数据恢复\n\n>   [!IMPORTANT]\n>\n>   补充：随着命令不断写入 `AOF`，文件会越来越大。为了解决这个问题，`Redis` 引入了 `AOF` 重写机制来压缩文件体积。`AOF` 文件重写是将 `Redis` 进程内的数据转换为写命令，并同步到新的 `AOF` 文件。重写后的 `AOF` 为什么可以变小？主要有以下理由：\n>\n>   -   **超时数据的去除** 进程内已超时的数据不会再写入文件，避免了过期数据的冗余存储\n>   -   **无效命令的删除** 旧的 `AOF` 文件中可能包含无效命令（如 `del`、`hdel`、`srem` 等）。在重写过程中，这些命令会被删除，只保留数据的最终版本\n>   -   **多条写操作合并** 多条相似的写操作可以合并为一条命令。例如，`lpush list a`、`lpush list b`、`lpush list c` 可以合并为 `lpush list a b c`，从而减少冗余操作\n\n此外还有一个重写的原理，您也可以简单看一看。\n\n![](./assets/image-20241121083647145.png)\n\n1. 执行 `AOF` 重写请求\n   - 如果当前进程正在执行 `AOF` 重写，请求不执行\n   - 如果当前进程正在执行 `bgsave` 操作，重写命令延迟到 `bgsave` 完成之后再执行\n\n2. 父进程执行 `fork` 创建子进程\n\n3. 重写过程：\n   -   主进程 `fork` 之后，继续响应其他命令。所有修改操作写入 `AOF` 缓冲区，并根据 `appendfsync` 策略同步到硬盘，保证旧 `AOF` 文件机制正确\n   -   子进程只有 `fork` 之前的所有内存信息，父进程中需要将 `fork` 之后这段时间的修改操作写入 `AOF` 重写缓冲区中\n\n4. 子进程根据内存快照，将命令合并到新的 `AOF` 文件中\n\n5. 子进程完成重写：\n   -   新文件写入后，子进程发送信号给父进程\n   -   父进程把 `AOF` 重写缓冲区内临时保存的命令追加到新 `AOF` 文件中\n   -   用新 `AOF` 文件替换旧 `AOF` 文件\n\n##### 3.7.2.4.AOF 的优势劣势\n\n-   优势：\n\n    -   **数据更精确**：`AOF` 会记录每个写命令，可以达到更高的数据持久化精度。例如，假设 `Redis` 崩溃了，你可能丢失不到几秒钟的数据（这取决于 `appendfsync` 策略）。\n    -   **持久化策略灵活**：`AOF` 提供三种同步策略 (`always`, `everysec`, `no`)，可以根据需求在持久化精度和性能之间做平衡。\n    -   **支持持久化恢复**：`AOF` 文件可以通过重放命令恢复数据，保证数据一致性。\n\n-   劣势：\n\n    *   **文件较大**：由于每个写命令都被记录，`AOF` 文件的大小可能会比 `RDB` 大很多。\n\n    *   **性能开销**：`AOF` 会增加额外的写入操作，尤其是 `appendfsync always` 策略会频繁同步磁盘，导致性能下降。\n\n>   [!IMPORTANT]\n>\n>   补充：`Redis` 两种方案的使用\n>\n>   -   `RDB` 高性能，底持久，磁盘多容量，慢速度\n>   -   `AOF` 低性能，高持久，磁盘少容量，快速度\n\n### 3.8.业务操作\n\n#### 3.8.1.事务\n\n> [!IMPORTANT]\n>\n> 补充：适合原子执行多个操作，只能单次启动。\n\n由于 `Redis` 的实现是单线程的，对比 `MySQL` 来说，`Redis` 事务要简单很多。\n\n-   弱化的原子性：虽然也是把一系列操作绑定为一组，但是操作失败时，无法回滚，因此原子性比较弱。\n-   不保证一致性：<span style=\"text-emphasis:filled red;\">这点待补充...</span>\n-   不需要隔离性：`MySQL` 需要给多个同时执行的事务设置隔离性，但是由于 `Redis` 是单线程的，这导致 `Redis` 无需设置隔离性，只要保证自己的每条操作都是原子的即可。\n-   不需要持久性：这不代表 `Redis` 不需要做持久化，或没有持久化功能，而是 `Redis` 的事务不需要自己考虑持久化的问题，这个问题交给 `redis-server` 自己的 `RDB/AOF` 持久化机制。\n\n总结来看仅仅是打包了一组指令，避免被其他客户端 **加塞** 而已。\n\n`Redis` 事务其实是在服务器上搞了一个 **事务队列**. 每次客户端在事务中进行一个操作, 都会把命令先发给服务器, 放到事务队列中（但并不会立刻执行），而是会在真正收到 `EXEC` 命令之后, 才真正执行队列中的所有操作。\n\n```shell\n# 操作一个简单的事务\n# 开启事务\n127.0.0.1:6379> MULTI\nOK\n\n# 执行指令(其实还没执行)\n127.0.0.1:6379> set k1 1\nQUEUED # 表示命令已加入事务队列\n127.0.0.1:6379> set k2 2\nQUEUED\n127.0.0.1:6379> set k3 3\nQUEUED\n\n# 完成事务(提醒可以执行)\n127.0.0.1:6379> EXEC # 也可以使用 DISCARD 放弃事务\n1) OK\n2) OK\n3) OK\n\n```\n\n不过在对同一个键的操作上，并且客户端开始编写事务的情况下，其他客户端先提交事务（或者直接执行指令时），还是会出现一些问题，这个时候会使用 `watch/unwatch` 来监控键值的版本号（就是一个整数而已），版本号冲突就立刻停止执行。\n\n```shell\n# 假设两个客户端几乎同时开始编写事务\n# >>> begin: 客户端 1 >>>\n# 客户端 1 开始监视键 k1\n127.0.0.1:6379> watch k1\nOK\n\n# 客户端 1 开始事务\n127.0.0.1:6379> MULTI\nOK\n\n# 客户端 1 将修改 k1 和 k2 作为事务的一部分, 但尚未执行\n127.0.0.1:6379> set k1 100\nQUEUED  # 此时 k1 的版本号为 0, 记录该版本号, 操作被排队, 但没有提交\n\n127.0.0.1:6379> set k2 1000\nQUEUED  # k2 的修改操作也被加入队列, 尚未执行\n\n# 客户端 1 尚未执行 EXEC, 事务仍在队列中\n# <<< end <<<\n\n# >>> begin: 客户端 2 >>>\n# 客户端 2 执行修改 k1 操作, 修改 k1 的值, 并将其版本号更改为 1(相当于提前提交了只有一条指令的事务)\n127.0.0.1:6379> set k1 200\nOK  # 客户端 2 成功修改了 k1 的值, 服务器上的版本号变为 1\n# <<< end <<<\n\n# >>> begin: 客户端 1 >>>\n# 客户端 1 执行 EXEC, 提交事务\n127.0.0.1:6379> EXEC\n(nil) # 由于版本号不一致, 事务被取消, 未执行任何命令\n\n# 检查 k1 的最终值, 应该是客户端 2 提交的修改\n127.0.0.1:6379> get k1\n\"200\"  # k1 的最终值是 200, 表明客户端 2 修改成功\n\n# 检查 k2 的最终值, 因为客户端 1 的事务没有成功提交, 所以 k2 未被设置\n127.0.0.1:6379> get k2\n(nil)  # k2 并没有被修改, 返回 nil\n# <<< end <<<\n\n```\n\n#### 3.8.2.脚本\n\n> [!IMPORTANT]\n>\n> 补充：适合原子执行多个操作，可以复用启动。\n\n`Redis` 支持执行 `Lua` 脚本，关于 `Lua`，您可以可以 [前往 Lua 官网查看大概的情况](https://www.lua.org/)，使用 `Lua` 的原因主要是\n\n- 为了将多个操作封装为原子操作，确保操作原子执行\n- 支持脚本缓存，可以减少因为数据传输引起的网络开销\n- `Lua` 本身也支持一些复杂的数据操作能力，避开 `Redis` 内部只有简单计算的缺点，也不必传递给客户端（对于 `Redis` 服务端来说客户端）浪费计算时间的问题再进行计算\n- 对于较多的 `Redis` 操作，可以直接使用 `Lua` 脚本优化操作，由于 `Redis` 对 `Lua` 脚本做过优化，可以原生执行 `Redis` 的代码\n\n怎么抉择什么时候使用 `Lua` 和 `Cpp` 呢？\n\n- 需要事务原子操作时\n- 需要减少网络开销时\n- 重复执行相同操作时\n- 避免在客户端计算时（对于 `Redis` 的客户端）\n\n```shell\n# 使用 Redis 的 Lua 脚本缓存机制\n127.0.0.1:6379> SCRIPT LOAD \"return ARGV[1] + ARGV[2]\"\n\"53c370cb7894e73f9aaf94627c0506c428b5cc97\"\n127.0.0.1:6379> EVALSHA 53c370cb7894e73f9aaf94627c0506c428b5cc97 0 2 3\n(integer) 5\n\n```\n\n#### 3.8.3.管道\n\n> [!IMPORTANT]\n>\n> 补充：适合本地执行多个操作，通常由库实现\n\n`Pipeline` 用来：\n\n- **发送多个 Redis 命令** `Redis` 客户端会将多个命令批量发送到服务器，而不是逐条发送\n- **读取所有命令的结果** 客户端一次性读取所有响应，减少网络往返时间\n\n实际上`Redis` 本身没有管道的相关操作，但是对于大部分的客户端是有实现管道操作的，让多条指令能一次性发送到 `Redis` 中，保证多条指令的执行结果如同在 `redis-cli` 中是一样的（因此就理解为和在 `Redis` 服务器命令行本地中输入执行多条命令是一样的就可以）。\n\n但是需要强调的是，管道不是原子的，完全只是为了压缩多条指令带来的多个 `RTT(往返时间)` 而已，把多个指令请求合并，减少网络开支。\n\n### 3.9.通信协议\n\n待补充...\n\n### 3.10.第三方库\n\n#### 3.10.1.Cpp 客户端\n\n##### 3.10.1.1.Redispp 的安装\n\n这里使用 [redis-plus-plus 库](https://github.com/sewenew/redis-plus-plus) 来操作 `Redis` 的使用，`redis-plus-plus` 是基于 `C`语 言实现的 `hiredis`实现的，先使用 `sudo apt install libhiredis-dev`快速安装 `Redis` 开发工具，然后 `git clone https://github.com/sewenew/redis-plus-plus.git` 克隆该库进行安装。\n\n```shell\n# 编译和安装\n# 安装开发工具包\n$ sudo apt install libhiredis-dev\n\n# 克隆源代码\n$ git clone https://github.com/sewenew/redis-plus-plus.git\n\n# 编译源代码, 然后进行安装\n$ cd redis-plus-plus\n$ mkdir build && cd build && cmake .. && make && sudo make install\n\n```\n\n接下来请您直接 [查看官方文档 API 文档](https://github.com/sewenew/redis-plus-plus/tree/master?tab=readme-ov-file#api-reference) 来学习使用 `Redispp`，官方文档写得非常详细。\n\n##### 3.10.1.2.Redispp 的使用\n\n这里结合官方文档简单快速的编写程序来做实验。\n\n```cpp\n// main.cpp\n#include <iostream>\n#include <vector>\n#include <string>\n#include <sw/redis++/redis++.h>\n\nusing namespace sw::redis;\n\nint main() {\n    try {\n        // === 链接 Redis 实例 ===\n        auto redis = Redis(\"tcp://127.0.0.1:6379\");\n\n        // === 单前数据库清空操作 ===\n        redis.flushdb();\n\n        // === String 操作 ===\n        redis.del(\"string\"); // 可以提前删除不需要的键\n        redis.set(\"string\", \"val\"); // 设置键值对\n        const auto val = redis.get(\"string\"); // 获取键值对\n        if (val) {\n            std::cout << *val << std::endl;\n        }\n\n        redis.expire(\"string\", std::chrono::seconds(20)); // 设置过期时间(以秒为单位)\n        // redis.pexpire(\"string\", std::chrono::milliseconds(20000)); // 20 秒\n\n        // === List 操作 ===\n        std::vector<std::string> vec = {\"aaa\", \"bbb\", \"ccc\"};\n        redis.rpush(\"list\", vec.begin(), vec.end());\n        redis.rpush(\"list\", {\"abc\", \"bac\", \"cab\"});\n        vec.clear(); // 清空, 以获取到新的数据\n\n        redis.lrange(\"list\", 0, -1, std::back_inserter(vec));\n        for (const auto& v : vec) {\n            std::cout << v << std::endl;\n        }\n\n        // === Set 操作 ===\n        redis.sadd(\"set\", \"m1\");\n        std::unordered_set<std::string> set = {\"m2\", \"m3\"};\n        redis.sadd(\"set\", set.begin(), set.end());\n        redis.sadd(\"set\", {\"m2\", \"m3\"});\n        set.clear(); // 清空, 以获取到新的数据\n\n        redis.smembers(\"set\", std::inserter(set, set.begin()));\n        if (redis.sismember(\"set\", \"m1\")) {\n            std::cout << \"m1 exists\" << std::endl;\n        } else {\n            std::cout << \"m1 not exists\" << std::endl;\n        }\n\n        // === Zset 操作 ===\n        redis.zadd(\"zset\", \"m1\", 1.3);\n        std::unordered_map<std::string, double> scores = {\n            {\"m2\", 2.3},\n            {\"m3\", 4.5}\n        };\n        redis.zadd(\"zset\", scores.begin(), scores.end());\n\n        // 获取带分数的有序集合结果\n        std::vector<std::pair<std::string, double>> zset_result;\n        redis.zrangebyscore(\"zset\",\n                UnboundedInterval<double>{},\n                std::back_inserter(zset_result));\n\n        std::cout << \"zset_result (with scores):\" << std::endl;\n        for (const auto& item : zset_result) {\n            std::cout << item.first << \": \" << item.second << std::endl;\n        }\n\n        // 获取不带分数的有序集合结果\n        std::vector<std::string> without_score;\n        redis.zrangebyscore(\"zset\",\n                BoundedInterval<double>(1.3, 4.5, BoundType::CLOSED), // 注意 BoundType::CLOSED 表示闭区间\n                std::back_inserter(without_score));\n\n        std::cout << \"\\nwithout_score (no scores):\" << std::endl;\n        for (const auto& item : without_score) {\n            std::cout << item << std::endl;\n        }\n\n        std::vector<std::pair<std::string, double>> with_score;\n        redis.zrangebyscore(\"zset\",\n                BoundedInterval<double>(1.3, 4.5, BoundType::OPEN), // 注意 BoundType::LEFT_OPEN 表示开区间\n                std::back_inserter(with_score));\n\n        std::cout << \"\\nwith_score (open interval):\" << std::endl;\n        for (const auto& item : with_score) {\n            std::cout << item.first << \": \" << item.second << std::endl;\n        }\n\n        // === Hash 操作 ===\n        redis.hset(\"hash\", \"field0\", \"val\");\n        redis.hset(\"hash\", std::make_pair(\"field0\", \"val0\")); // 注意这里做了更新操作\n        std::unordered_map<std::string, std::string> m = {\n            {\"field1\", \"val1\"},\n            {\"field2\", \"val2\"}\n        };\n        redis.hmset(\"hash\", m.begin(), m.end());\n        m.clear(); // 清空, 以获取到新的数据\n\n        redis.hgetall(\"hash\", std::inserter(m, m.begin()));\n\n        // 打印结果\n        for (const auto &pair : m) {\n            std::cout << pair.first << \": \" << pair.second << std::endl;\n        }\n\n        // 也可以只获取到值而去除字段\n        std::vector<OptionalString> vals;\n        redis.hmget(\"hash\", {\"field0\", \"field1\"}, std::back_inserter(vals));\n\n        for (const auto &v : vals) {\n            std::cout << *v << std::endl;\n        }\n\n        // === 脚本操作 ===\n        // 这个脚本非常简单, 它仅返回 1, 并没有与 Redis 数据库进行任何交互\n        auto num = redis.eval<long long>(\"return 1\", {}, {});\n        std::cout << num << std::endl;\n        // 这段代码执行一个简单的 Lua 脚本 return 1\n        // eval<long long> 表示将脚本的返回值转换为 long long 类型\n        // 脚本返回 1, 即返回一个数字 1\n        // {} 表示没有键(KEYS), {} 表示没有传入参数(ARGV)\n\n        // 该脚本将返回两个元素 1 和 2, 并将其作为字符串存储在 nums 向量中\n        std::vector<std::string> nums;\n        redis.eval(\"return {ARGV[1], ARGV[2]}\", {}, {\"1\", \"2\"}, std::back_inserter(nums));\n        for (const auto& v : nums) {\n            std::cout << v << std::endl;\n        }\n        // 这段代码执行 Lua 脚本 \"return {ARGV[1], ARGV[2]}\", 该脚本返回一个包含 ARGV[1] 和 ARGV[2] 两个元素的数组\n        // ARGV[1] 和 ARGV[2] 分别对应传入的 {\"1\", \"2\"} 参数\n        // 通过 std::back_inserter(nums) 将返回的结果插入到 nums 向量中\n\n        // === 脚本操作 ===\n        auto hash_val = redis.script_load(\"return ARGV[1] + ARGV[2]\");\n        std::cout << hash_val << std::endl;\n        auto result = redis.evalsha<long long>(hash_val, {}, {\"2\", \"3\"});\n        std::cout << \"Result: \" << result << std::endl;\n\n        // 执行复杂脚本并且查看过期时间\n        auto mset_with_ttl_script = R\"(\n            local len = #KEYS\n            if (len == 0 or len + 1 ~= #ARGV) then return 0 end\n            local ttl = tonumber(ARGV[len + 1])\n            if (not ttl or ttl <= 0) then return 0 end\n            for i = 1, len do redis.call(\"SET\", KEYS[i], ARGV[i], \"EX\", ttl) end\n            return 1\n        )\";\n        auto keys = {\"key-1\", \"key-2\", \"key-3\"};\n        std::vector<std::string> args = {\"val-1\", \"val-2\", \"val-3\", \"60\"};\n        redis.eval<long long>(mset_with_ttl_script, keys.begin(), keys.end(), args.begin(), args.end());\n        sleep(5); // 故意等 5 秒后再打印过期时间\n\n        auto ttl0 = redis.pttl(\"string\"); // pttl 是指微妙时间(这个键是之前设置的)\n        auto ttl1 = redis.pttl(\"key-1\"); // pttl 是指微妙时间(这个键是之前设置的)\n        auto ttl2 = redis.pttl(\"key-2\"); // pttl 是指微妙时间(这个键是之前设置的)\n        auto ttl3 = redis.pttl(\"key-3\"); // pttl 是指微妙时间(这个键是之前设置的)\n\n        std::cout << \"TTL: \" << std::to_string(ttl0) << \" seconds\\n\";\n        std::cout << \"TTL: \" << std::to_string(ttl1) << \" seconds\\n\";\n        std::cout << \"TTL: \" << std::to_string(ttl2) << \" seconds\\n\";\n        std::cout << \"TTL: \" << std::to_string(ttl3) << \" seconds\\n\";\n\n        // 使用管道来本地操作多条指令\n        auto pipe = redis.pipeline();\n        auto pipe_replies = pipe.set(\"my-key\", \"my-value\")\n                                .get(\"my-key\")\n                                .rename(\"my-key\", \"new-my-key\")\n                                .rpush(\"my-list\", {\"a\", \"b\", \"c\"})\n                                .lrange(\"my-list\", 0, -1)\n                                .exec();\n\n        auto set_cmd_result = pipe_replies.get<bool>(0); // 读取第一条命令结果(布尔)\n        auto get_cmd_result = pipe_replies.get<OptionalString>(1); // 读取第二条命令结果(字符)\n        pipe_replies.get<void>(2); // 读取第三条命令结果\n        std::vector<std::string> lrange_cmd_result;\n        pipe_replies.get(4, back_inserter(lrange_cmd_result)); // 读取第四条命令结果\n\n        std::cout << \"SET command result: \" << (set_cmd_result ? \"Success\" : \"Failure\") << \"\\n\";\n        if (get_cmd_result.has_value()) {\n            std::cout << \"GET command result: \" << *get_cmd_result << \"\\n\";\n        } else {\n            std::cout << \"GET command result: Key not found\\n\";\n        }\n        std::cout << \"RENAME command result: Success (no return value)\\n\";\n        std::cout << \"LRANGE command result: \";\n        for (const auto& item : lrange_cmd_result) {\n            std::cout << item << \" \";\n        }\n        std::cout << \"\\n\";\n\n        // === 事物操作 ===\n        auto tx = redis.transaction();\n        auto tx_replies = tx.incr(\"num0\")\n                            .incr(\"num1\")\n                            .mget({\"num0\", \"num1\"})\n                            .exec(); // 提交事物\n\n        auto incr_result_0 = tx_replies.get<long long>(0);\n        auto incr_result_1 = tx_replies.get<long long>(1);\n        std::vector<OptionalString> mget_cmd_result; // 使用 OptionalString 的目的是避免空值\n        tx_replies.get(2, back_inserter(mget_cmd_result));\n\n        std::cout << \"incr_result_0: \" << incr_result_0 << '\\n';\n        std::cout << \"incr_result_1: \" << incr_result_1 << '\\n';\n\n        for (const auto& item : mget_cmd_result) {\n            std::cout << *item << \" \";\n        }\n\n        // === 原生执行 Redis 指令 ===\n        // 可以使用多个参数执行\n        auto get_name = redis.command<OptionalString>(\"CLIENT\", \"SETNAME\", \"my-redis-cli\"); // 大小写均可\n        get_name = redis.command<OptionalString>(\"client\", \"getname\");\n        if (get_name) {\n            std::cout << *get_name << std::endl;\n        }\n\n        std::vector<std::string> sorted_list;\n        redis.command(\"sort\", \"list\", \"alpha\", \"desc\", std::back_inserter(sorted_list)); // ALPHA 是指按照字母排序, desc 是逆向排序\n        std::cout << \"sorted_list\" << std::endl;\n        for (const auto& item : sorted_list) {\n            std::cout << item << std::endl;\n        }\n\n        // 也可以使用初始化列表参数\n        auto sort_cmd_str = {\"sort\", \"list\", \"ALPHA\"};\n        redis.command(sort_cmd_str.begin(), sort_cmd_str.end(), std::back_inserter(sorted_list));\n\n        // === 集群控制 ===\n        // 如果您运行了多个 Redis 实例, 就可以利用多个实例的创建, 快速管理另外一个 Redis 实例\n        auto redis_cluster = RedisCluster(\"tcp://127.0.0.1:7000\");\n        redis_cluster.set(\"key\", \"value\");\n\n        // 因此对于这个新实例来说, 也是相同的操作\n        auto value = redis_cluster.get(\"key\");\n        if (value) {\n            std::cout << *val << std::endl;\n        }\n    } catch (const Error &e) {\n        std::cerr << \"Error: \" << e.what() << std::endl;\n    }\n    return 0;\n}\n\n```\n\n当然，您可以继续查阅文档，官方也有提供 `Doxygen` 注释，您可以尝试生成一份来阅读。\n\n还有一些其他 `API` 细节，这里简单概览一下文档支持的大部分功能，就不做详细的解读了...\n\n- 连接\n- 发送指令\n- 异常\n- 通用命令界面\n- 发布订阅\n- 管道\n- 事物\n- 集群\n- 哨兵\n- 流\n- 模块\n- 异步接口\n- 协程接口\n\n> [!WARNING]\n>\n> 警告：部分后续提及，少部分功能未完全实现。\n\n#### 3.10.2.Java 客户端\n\n`Spring boot` 可以集成 `Redis` 进行使用（内置 `Jedis`），待补充...\n\n## 4.组件深入\n\n## 5.组件原理","excerpt":"","includedFiles":[],"tasklistId":0,"title":"","headers":[{"level":2,"title":"1.组件简介","slug":"_1-组件简介","link":"#_1-组件简介","children":[]},{"level":2,"title":"2.组件部署","slug":"_2-组件部署","link":"#_2-组件部署","children":[]},{"level":2,"title":"3.组件基础","slug":"_3-组件基础","link":"#_3-组件基础","children":[{"level":3,"title":"3.1.登录退出","slug":"_3-1-登录退出","link":"#_3-1-登录退出","children":[]},{"level":3,"title":"3.2.指令教程","slug":"_3-2-指令教程","link":"#_3-2-指令教程","children":[]},{"level":3,"title":"3.3.数据类型","slug":"_3-3-数据类型","link":"#_3-3-数据类型","children":[]},{"level":3,"title":"3.4.渐进遍历","slug":"_3-4-渐进遍历","link":"#_3-4-渐进遍历","children":[]},{"level":3,"title":"3.5.键值空间","slug":"_3-5-键值空间","link":"#_3-5-键值空间","children":[]},{"level":3,"title":"3.6.设计架构","slug":"_3-6-设计架构","link":"#_3-6-设计架构","children":[]},{"level":3,"title":"3.7.的持久化","slug":"_3-7-的持久化","link":"#_3-7-的持久化","children":[]},{"level":3,"title":"3.8.业务操作","slug":"_3-8-业务操作","link":"#_3-8-业务操作","children":[]},{"level":3,"title":"3.9.通信协议","slug":"_3-9-通信协议","link":"#_3-9-通信协议","children":[]},{"level":3,"title":"3.10.第三方库","slug":"_3-10-第三方库","link":"#_3-10-第三方库","children":[]}]},{"level":2,"title":"4.组件深入","slug":"_4-组件深入","link":"#_4-组件深入","children":[]},{"level":2,"title":"5.组件原理","slug":"_5-组件原理","link":"#_5-组件原理","children":[]}]}}
