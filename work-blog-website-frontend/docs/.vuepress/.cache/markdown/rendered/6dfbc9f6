{"content":"<blockquote>\n<p>索引可以提高海量数据库的性能（不加内存，不改程序，不调 <code v-pre>sql</code>），只需要执行正确的 <code v-pre>create index</code> ，查询速度就可能提高成百上千倍。</p>\n<p>但查询速度的提高是以插入、更新、删除的速度作为代价的，这些写操作增加了大量的 <code v-pre>IO</code>。</p>\n</blockquote>\n<p>上述这段话还有很多是我们体会不到的，继续往下看。</p>\n<p>我们先记住，<code v-pre>MySQL</code> 的服务器进程，所有的 <code v-pre>CURD</code> 都是在内存中进行的，索引也是这样，在内存中一定存在某种数据结构。</p>\n<p>而优化算法的因素主要有两个：</p>\n<ul>\n<li>组织数据的方法（例如：顺序表改写为二树树表）</li>\n<li>算法的设计本身（例如：顺序查找改为二分查找）</li>\n</ul>\n<p>而索引就是针对第一个方式对数据做优化，让查询速度变快，我们可以见一见什么叫索引。</p>\n<ol>\n<li>\n<p>先建立一个 <code v-pre>.sql</code> 文件，该文件可以创建大批量的随机数：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 待补充</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p>使用 <code v-pre>ALTER TABLE table_name ADD INDEX(字段);</code> 添加索引</p>\n</li>\n<li>\n<p>比较不带索引和带上索引的查询速度差异...</p>\n</li>\n</ol>\n<h1 id=\"_2-磁盘和-mysql\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-磁盘和-mysql\"><span>2.磁盘和 MySQL</span></a></h1>\n<p>之前在 <code v-pre>Linux</code> 里学习了文件 <code v-pre>IO</code>，里面有提到磁盘的结构和抽象，而 <code v-pre>MySQl</code> 也可以看作是一种特殊的文件系统。</p>\n<p><code v-pre>MySQL</code> 层下不是直接对接硬盘，而是对接操作系统，通过调用操作系统来进行文件管理。</p>\n<p><code v-pre>MySQL</code> 的 <code v-pre>IO</code> 次数更加频繁，因此为了提高基本的 <code v-pre>IO</code> 效率，<code v-pre>MySQL</code> 进行 <code v-pre>IO</code> 的基本单位是 <code v-pre>16KB</code>（系统文件是用 <code v-pre>4KB</code> 的逻辑块来查找，而磁盘是 <code v-pre>512byte</code> 来读取）。</p>\n<p>这 <code v-pre>16KB</code> 的 <code v-pre>IO</code> 操作实际上是向操作系统提出来的。</p>\n<p>这刚好和 <code v-pre>InnoDB</code> 引擎的大小一样：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 查看大小</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">global</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> status</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">innodb_page_size</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| Variable_name    | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Value</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| Innodb_page_size | </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16384</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">01</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>因此可以衍生出以下思考：</p>\n<ul>\n<li>\n<p>对于 <code v-pre>MySQL</code> 来说，数据文件都是以 <code v-pre>page=16KB</code> 为单位在磁盘中保存的</p>\n</li>\n<li>\n<p><code v-pre>MySQL</code> 的 <code v-pre>CURD</code> 都需要通过 <code v-pre>CPU</code> 计算，因此就必须要 <code v-pre>CPU</code> 参与，进一步就需要内存参与，要通过操作系统接口，把数据从磁盘移动到内存中</p>\n</li>\n<li>\n<p>磁盘和内存的交互就是一种 <code v-pre>IO</code> 操作，<code v-pre>IO</code> 的基本单位就是 <code v-pre>page</code></p>\n</li>\n<li>\n<p>而为了更好在内存中操作和提高效率（导致效率低下的主要矛盾是 <code v-pre>IO</code> 次数而不是一次 <code v-pre>IO</code> 大小），<code v-pre>MySQl</code> 向内存申请了一个较大的 <code v-pre>Buffer Pool=128M</code> 内存空间，来进行各种缓存，以便提高命中率，减少大量的系统和磁盘交互的次数</p>\n</li>\n<li>\n<p><code v-pre>MySQL</code> 内部会存在大量的 <code v-pre>page</code>，因此就需要对 <code v-pre>page</code> 先描述再组织，然后用一定的数据结构连接起来，因此就是 <code v-pre>MySQl</code> 对 <code v-pre>page</code> 进行了建模</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/698589b9e2ce7350e19fa9a9f44ed7f.png\" alt=\"698589b9e2ce7350e19fa9a9f44ed7f\" tabindex=\"0\" loading=\"lazy\"><figcaption>698589b9e2ce7350e19fa9a9f44ed7f</figcaption></figure>\n</li>\n</ul>\n<h1 id=\"_3-索引的原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-索引的原理\"><span>3.索引的原理</span></a></h1>\n<p>经过前面的对比和铺垫，接下来我们就可以来深入了解索引的原理了，首先创建一个 <code v-pre>user</code> 表：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 创建 user 表</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> if</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> not</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> exists</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 一定要添加主键（会默认生成主键索引）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     age </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">     name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">02</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">       Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: user</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CREATE</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> TABLE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">user</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  PRIMARY KEY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) ENGINE</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">InnoDB </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">DEFAULT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CHARSET</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">latin1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">dimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">26</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">iimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">36</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">56</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | age | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">56</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | pimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">26</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | iimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | limou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | dimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">36</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | eimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们发现，我向具有主键的表中插入时，数据会自动进行排序。实际上插入一条记录就是插入某个数据结构，而查找也是在查找某个数据结构，那什么结构比较适用用 <code v-pre>MySQL</code> 这样需要大量查找的数据库呢？</p>\n<p>如果单纯使用链表来链接各种数据结构，就会导致顺序查找，进而降低查找效率。</p>\n<p>那我们能不能引入树状结构呢（树状结构很适合查找）？肯定是可以的，因此我们引入 <strong>页内目录</strong> 的概念，这是一种空间换时间的做法（把本来用于存储记录的空间拿来存储目录），先查找对应的目录，再查找记录，效率会大大提高。</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/29c5dc3ef69feeab2f31a4479263af0.png\" alt=\"29c5dc3ef69feeab2f31a4479263af0\" tabindex=\"0\" loading=\"lazy\"><figcaption>29c5dc3ef69feeab2f31a4479263af0</figcaption></figure>\n<p>因此加上主键变成有序的原因就是为了页内目录做服务（书籍页码的有序，是为了更高效使用书籍目录来查询对应的书页），只有有序了才能方便分类进不同的目录。</p>\n<p>但是 <code v-pre>page</code> 彼此之间还是线性的，一旦数据库的数据变大起来就会自动创建多个 <code v-pre>page</code> 来存储数据，此时要找到跨度比较大的数据，也需要大量的线性遍历（一旦一个数据再数据库的最后一页，那就需要加载所有的页进内存来遍历查找）。</p>\n<p>因此如果将一个原本存储目录和记录的页，用来指向多个页（页本身也有编号），也同样可以使用树来优化查找速度。</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/b6fd85519d2e3632cab872755cea83d.png\" alt=\"b6fd85519d2e3632cab872755cea83d\" tabindex=\"0\" loading=\"lazy\"><figcaption>b6fd85519d2e3632cab872755cea83d</figcaption></figure>\n<p>而整个结构就是 <code v-pre>B+</code> 树，但是不是所有的索引都会使用 <code v-pre>B+</code> 树，也有使用哈希的。有了 <code v-pre>B+</code> 树就可以提高查找数据：</p>\n<ol>\n<li>一次淘汰更多的数据，线性查找一次只能淘汰一个数据（只需要加载一个根节点，找到局部的 <code v-pre>B+</code> 树，减少了 <code v-pre>IO</code> 次数）</li>\n<li>在这颗树上，只有叶子节点才保有数据，而非叶子节点只有目录项（可以存储更多目录项）</li>\n</ol>\n<blockquote>\n<p>注意：概念里的大部分 <code v-pre>B+</code> 树只有根节点之间才有链式链接。</p>\n</blockquote>\n<p>那如果我们没有主键呢？<code v-pre>MySQL</code> 也会这么组织一个数据表，因为 <code v-pre>MySQL</code> 默认会生成一个隐藏列，这个列默认就是主键，会根据这个隐藏主键来组织数据表。</p>\n<p>所以设置索引之前，只会根据这个默认主键来构造 <code v-pre>B+</code> 树，但是索引后会根据设置的列来构建 <code v-pre>B+</code> 树。前后是两颗 <code v-pre>B+</code> 树，根据不同的列来构建，只有搜索格子对应的列时，才会使用对应的 <code v-pre>B+</code> 来查找，如果对应列没有 <code v-pre>B+</code> 树，那就只能遍历数据表来查找数据。</p>\n<p>在 <code v-pre>MySQl</code> 中，选择这种树状数据结构，对于范围查找会更加快速。</p>\n<p>至此，建立索引，就是建立一个方便查询的树状数据结构。</p>\n<blockquote>\n<p>补充：为什么不选择其他数据结构？</p>\n<ul>\n<li>链表：线性遍历</li>\n<li>二叉搜索树：遇到很多节点时退化为线性结构</li>\n<li><code v-pre>AVL</code> 和 <code v-pre>RB</code>：虽然保证了平衡，但是由于只有左右节点，但是树的整体有可能过高，同层数据量较少</li>\n<li><code v-pre>hash</code>：理论上是可以，搜索时间复杂度是 <code v-pre>O(1)</code>，但是在范围查找的场景下有致命的缺陷，但是不排除有这种实现</li>\n<li><code v-pre>B</code> 树：理论上是可以， <code v-pre>B</code> 的路径节点也会保存数据，叶子节点不会进行线性链接（这意味着路径节点里的数据变多，但是目录变少，导致树的高度可能偏高，最终导致 <code v-pre>IO</code> 的加载次数可能变多，一般 <code v-pre>IO</code> 的成本较高）</li>\n</ul>\n</blockquote>\n<h1 id=\"_4-索引的分类\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-索引的分类\"><span>4.索引的分类</span></a></h1>\n<ul>\n<li>\n<p><strong>聚簇索引</strong>：将所有的数据存储在叶子节点的存储引擎对应的就是 <code v-pre>Inno DB</code> 默认的存储结构（用户数据和索引数据存放再一起）</p>\n</li>\n<li>\n<p><strong>非聚簇索引</strong>：而 <code v-pre>MyISAM</code> 同样也是使用 <code v-pre>B+</code> 树结构，但是叶子节点不再存放数据，而是存储数据的地址（用户数据和索引数据存放在两处）</p>\n</li>\n</ul>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 查看聚簇索引和非聚簇索引的区别</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest( id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ) engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">innodb; # 其实之前建表都是默认使用 InnoDB 的存储引擎，但是我们写明这一点</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">03</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># pwd </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">var</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lib</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">limou_database</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># ls</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">db</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">opt</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">frm</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">ibd</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">drop</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest( id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ) engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM; </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">02</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># pwd </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">var</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lib</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">limou_database</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># ls</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">db</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">opt</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">frm</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">MYD</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">MYI</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>对比就可以看到：</p>\n<ul>\n<li>如果使用 <code v-pre>innodb</code> 引擎，就会存在三个文件，其中 <code v-pre>.frm</code> 就是数据表本身的结构，而 <code v-pre>.ibd</code> 就是数据和索引结构</li>\n<li>如果使用 <code v-pre>MyISAM</code> 引擎，就会存在四个文件，其中 <code v-pre>.frm</code> 就是数据表本身的结构，而 <code v-pre>.MYD</code> 就是数据，<code v-pre>.MYI</code> 就是索引结构</li>\n</ul>\n<p>如果我们在主键索引的基础上，又建立了普通索引，也会重新构造一个 <code v-pre>B+</code> 树，但是叶子节点不会存储所有的数据（浪费空间），而是存储对应数据的主键，然后根据这个主键再次回到主索引的 <code v-pre>B+</code> 树中，根据主键来搜寻完整的列记录（也叫“回表查询”）。</p>\n<h1 id=\"_5-索引的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-索引的使用\"><span>5.索引的使用</span></a></h1>\n<h2 id=\"_5-1-主键索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-1-主键索引\"><span>5.1.主键索引</span></a></h2>\n<ol>\n<li>在创建表的同时，设置某一列为 <code v-pre>primary key</code> 即可自动建立主键索引（可以在列定义中，也可以在表创建语法的最后指定某列）</li>\n<li>或者创建表后，使用语法 <code v-pre>ALTER TABLE table_name ADD INDEX(field_name);</code> 即可创建主键索引</li>\n</ol>\n<p>可以使用 <code v-pre>SHOW KEY FROM table_name</code> 或 <code v-pre>SHOW INDEX/KEY FROM table_name</code> 或 <code v-pre>DESC table_name</code> 来查看索引设定</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">       Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CREATE</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> TABLE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mtest</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  PRIMARY KEY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) ENGINE</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">DEFAULT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CHARSET</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">latin1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> SHOW </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INDEX</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest # 表名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 是否非唯一性 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 索引名称，默认叫“主键”</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id # 索引对应表中的某一列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE # 索引类型，就是 B</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 树</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>而使用 <code v-pre>ALTER TABLE table_name DROP PRIMARY KEY;</code> 则可以删除索引。</p>\n<h2 id=\"_5-2-普通索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-2-普通索引\"><span>5.2.普通索引</span></a></h2>\n<p>实际上如果在创建表的同时添加 <code v-pre>QUIQUE</code> 属性，或者创建后使用 <code v-pre>ALTER TABLE table_name ADD UNIQUE(field_name);</code> 时，也会创建唯一索引，和主键索引的区别就是可以不可以为空的问题。</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> alter</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">add</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> unique</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Records: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Duplicates: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Warnings: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">index</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>而删除唯一索引就是使用 <code v-pre>ALTER TABLE table_name DROP INDEX key_name;</code> 或者 <code v-pre>DROP INDEX index_name ON table_name;</code>，而如果是其他指定的普通索引，也是一样的删除方法（这是因为唯一索引也是一种特殊的普通索引）。</p>\n<p>而普通索引的建立方法在一开始有提到过，就是：</p>\n<ul>\n<li><code v-pre>ALTER TABLE table_name ADD INDEX(field_name);</code></li>\n<li>或者在创建数据表的时候在末尾加上 <code v-pre>INDEX(field_name);</code></li>\n<li>也可以使用 <code v-pre>CREAT INDEX [index_new_name] on table_name(field_name);</code> 并且可以重命名普通索引的索引名称</li>\n</ul>\n<p>最后，普通索引的删除方法和唯一约束是一样的。</p>\n<p>普通索引还可以使用多个列来构成（也就是“复合索引”），这样构建的索引仍旧是一棵 <code v-pre>B+</code> 树，使用 <code v-pre>SHOW INDEX FROM table_name</code> 就会查找到两行信息，但是索引名字都一样，只是对应列不一样。</p>\n<p>复合索引有多个 <code v-pre>key</code> 值，查找一个 <code v-pre>key</code> 时，如果想要查找的数据本身就是另外一个 <code v-pre>key</code> 值，那么其实无需进行回表查询，直接返回 <code v-pre>key</code> 值就行，如果时还有查询其他记录的其他数据，就需要返回主键进行一次回表查询（不过这个过程无需用户操作，<code v-pre>MySQL</code> 会自动进行，这种情况也叫做“索引覆盖问题”，覆盖的是主键）。</p>\n<p>但是查找过程中需要给定最左边的字段，而不能给其他的字段，这是 <code v-pre>MySQL</code> 的索引最做匹配原则（原因是按照从左到右的顺序匹配的）。</p>\n<blockquote>\n<p>补充：一般来说  (1)唯一性太差的 (2)更新过于频繁的 (3)根本不会出现在 <code v-pre>WHERE</code> 子句中用来查询的 字段最好不要作为索引，容易导致索引结构被频繁修改。</p>\n</blockquote>\n<h2 id=\"_5-3-全文索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-3-全文索引\"><span>5.3.全文索引</span></a></h2>\n<p>我们之前提到的索引，都是使用比较短的数据来构建 <code v-pre>B+</code> 树的，但是有些时候会存储较长的文本数据，这个时候一般使用全文索引（<code v-pre>FULLTEXT</code>），不过 <code v-pre>MySQL</code> 的全文索引要求搜索引擎必须是 <code v-pre>MyISAM</code>，并且默认的全文索引只支持英文的而不支持中文（但是插件 <code v-pre>sphinx</code> 的中文版支持中文全文索引）。</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 尝试使用全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)建表的同时设置全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> unsigned auto_increment </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    title </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">200</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    body </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">text</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">fulltext</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(title,body) # 全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">01</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles (title,body) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL Tutorial</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">DBMS stands for DataBase ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">How To Use MySQL Well</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">After you went through a ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Optimizing MySQL</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">In this tutorial we will show ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1001 MySQL Tricks</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1. Never run mysqld as root. 2. ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL vs. YourSQL</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">In the following database comparison ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL Security</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">When configured properly, MySQL ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Records: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Duplicates: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Warnings: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)查看表的索引信息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">index</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: YES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FULLTEXT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: body</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: YES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FULLTEXT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)使用模糊匹配</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> body </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%database%</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">; # 但是这里是普通搜索，实际上没有使用到全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | title             | body                                     |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL Tutorial    | DBMS stands </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DataBase</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ...             |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL vs. YourSQL | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">In</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> the </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">following</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> database</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> comparison ... |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)查看 MySQL 语句对应的执行计划</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> explain </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> body </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%database%</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">           id: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  select_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SIMPLE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles # 要操作的数据表</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   partitions: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         type</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: ALL # 这次查询的方式是全部遍历</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">possible_keys: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">          key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 值表示没有应用索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      key_len: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">          ref: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     filtered: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">67</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        Extra: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Using</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> where</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> warning (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> match</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (title,body) against (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">database</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | title             | body                                     |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL vs. YourSQL | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">In</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> the </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">following</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> database</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> comparison ... |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL Tutorial    | DBMS stands </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DataBase</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ...             |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> explain </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> match</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (title,body) against (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">database</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">           id: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  select_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SIMPLE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   partitions: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         type</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">fulltext</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">possible_keys: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">          key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: title # 以 title 作为索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      key_len: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">          ref: const</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     filtered: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">100</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        Extra: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Using</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> where</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> warning (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>","env":{"base":"/","filePath":"/home/ljp/git/work/work-blog-website/work-blog-website-frontend/docs/4.业务服务/2.存储服务/008_ljp_2024_02_28_索引.md","filePathRelative":"4.业务服务/2.存储服务/008_ljp_2024_02_28_索引.md","frontmatter":{"title":"008_limou_2024_02_28_mysql_索引","createTime":"2025/04/09 13:05:15","permalink":"/article/1hvzcwp7/"},"sfcBlocks":{"template":{"type":"template","content":"<template><blockquote>\n<p>索引可以提高海量数据库的性能（不加内存，不改程序，不调 <code v-pre>sql</code>），只需要执行正确的 <code v-pre>create index</code> ，查询速度就可能提高成百上千倍。</p>\n<p>但查询速度的提高是以插入、更新、删除的速度作为代价的，这些写操作增加了大量的 <code v-pre>IO</code>。</p>\n</blockquote>\n<p>上述这段话还有很多是我们体会不到的，继续往下看。</p>\n<p>我们先记住，<code v-pre>MySQL</code> 的服务器进程，所有的 <code v-pre>CURD</code> 都是在内存中进行的，索引也是这样，在内存中一定存在某种数据结构。</p>\n<p>而优化算法的因素主要有两个：</p>\n<ul>\n<li>组织数据的方法（例如：顺序表改写为二树树表）</li>\n<li>算法的设计本身（例如：顺序查找改为二分查找）</li>\n</ul>\n<p>而索引就是针对第一个方式对数据做优化，让查询速度变快，我们可以见一见什么叫索引。</p>\n<ol>\n<li>\n<p>先建立一个 <code v-pre>.sql</code> 文件，该文件可以创建大批量的随机数：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 待补充</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p>使用 <code v-pre>ALTER TABLE table_name ADD INDEX(字段);</code> 添加索引</p>\n</li>\n<li>\n<p>比较不带索引和带上索引的查询速度差异...</p>\n</li>\n</ol>\n<h1 id=\"_2-磁盘和-mysql\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-磁盘和-mysql\"><span>2.磁盘和 MySQL</span></a></h1>\n<p>之前在 <code v-pre>Linux</code> 里学习了文件 <code v-pre>IO</code>，里面有提到磁盘的结构和抽象，而 <code v-pre>MySQl</code> 也可以看作是一种特殊的文件系统。</p>\n<p><code v-pre>MySQL</code> 层下不是直接对接硬盘，而是对接操作系统，通过调用操作系统来进行文件管理。</p>\n<p><code v-pre>MySQL</code> 的 <code v-pre>IO</code> 次数更加频繁，因此为了提高基本的 <code v-pre>IO</code> 效率，<code v-pre>MySQL</code> 进行 <code v-pre>IO</code> 的基本单位是 <code v-pre>16KB</code>（系统文件是用 <code v-pre>4KB</code> 的逻辑块来查找，而磁盘是 <code v-pre>512byte</code> 来读取）。</p>\n<p>这 <code v-pre>16KB</code> 的 <code v-pre>IO</code> 操作实际上是向操作系统提出来的。</p>\n<p>这刚好和 <code v-pre>InnoDB</code> 引擎的大小一样：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 查看大小</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">global</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> status</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">innodb_page_size</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| Variable_name    | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Value</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| Innodb_page_size | </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16384</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">01</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>因此可以衍生出以下思考：</p>\n<ul>\n<li>\n<p>对于 <code v-pre>MySQL</code> 来说，数据文件都是以 <code v-pre>page=16KB</code> 为单位在磁盘中保存的</p>\n</li>\n<li>\n<p><code v-pre>MySQL</code> 的 <code v-pre>CURD</code> 都需要通过 <code v-pre>CPU</code> 计算，因此就必须要 <code v-pre>CPU</code> 参与，进一步就需要内存参与，要通过操作系统接口，把数据从磁盘移动到内存中</p>\n</li>\n<li>\n<p>磁盘和内存的交互就是一种 <code v-pre>IO</code> 操作，<code v-pre>IO</code> 的基本单位就是 <code v-pre>page</code></p>\n</li>\n<li>\n<p>而为了更好在内存中操作和提高效率（导致效率低下的主要矛盾是 <code v-pre>IO</code> 次数而不是一次 <code v-pre>IO</code> 大小），<code v-pre>MySQl</code> 向内存申请了一个较大的 <code v-pre>Buffer Pool=128M</code> 内存空间，来进行各种缓存，以便提高命中率，减少大量的系统和磁盘交互的次数</p>\n</li>\n<li>\n<p><code v-pre>MySQL</code> 内部会存在大量的 <code v-pre>page</code>，因此就需要对 <code v-pre>page</code> 先描述再组织，然后用一定的数据结构连接起来，因此就是 <code v-pre>MySQl</code> 对 <code v-pre>page</code> 进行了建模</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/698589b9e2ce7350e19fa9a9f44ed7f.png\" alt=\"698589b9e2ce7350e19fa9a9f44ed7f\" tabindex=\"0\" loading=\"lazy\"><figcaption>698589b9e2ce7350e19fa9a9f44ed7f</figcaption></figure>\n</li>\n</ul>\n<h1 id=\"_3-索引的原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-索引的原理\"><span>3.索引的原理</span></a></h1>\n<p>经过前面的对比和铺垫，接下来我们就可以来深入了解索引的原理了，首先创建一个 <code v-pre>user</code> 表：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 创建 user 表</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> if</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> not</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> exists</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 一定要添加主键（会默认生成主键索引）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     age </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">     name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">02</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">       Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: user</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CREATE</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> TABLE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">user</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  PRIMARY KEY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) ENGINE</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">InnoDB </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">DEFAULT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CHARSET</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">latin1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">dimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">26</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">iimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">36</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">56</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | age | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">56</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | pimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">26</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | iimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | limou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | dimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">36</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | eimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们发现，我向具有主键的表中插入时，数据会自动进行排序。实际上插入一条记录就是插入某个数据结构，而查找也是在查找某个数据结构，那什么结构比较适用用 <code v-pre>MySQL</code> 这样需要大量查找的数据库呢？</p>\n<p>如果单纯使用链表来链接各种数据结构，就会导致顺序查找，进而降低查找效率。</p>\n<p>那我们能不能引入树状结构呢（树状结构很适合查找）？肯定是可以的，因此我们引入 <strong>页内目录</strong> 的概念，这是一种空间换时间的做法（把本来用于存储记录的空间拿来存储目录），先查找对应的目录，再查找记录，效率会大大提高。</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/29c5dc3ef69feeab2f31a4479263af0.png\" alt=\"29c5dc3ef69feeab2f31a4479263af0\" tabindex=\"0\" loading=\"lazy\"><figcaption>29c5dc3ef69feeab2f31a4479263af0</figcaption></figure>\n<p>因此加上主键变成有序的原因就是为了页内目录做服务（书籍页码的有序，是为了更高效使用书籍目录来查询对应的书页），只有有序了才能方便分类进不同的目录。</p>\n<p>但是 <code v-pre>page</code> 彼此之间还是线性的，一旦数据库的数据变大起来就会自动创建多个 <code v-pre>page</code> 来存储数据，此时要找到跨度比较大的数据，也需要大量的线性遍历（一旦一个数据再数据库的最后一页，那就需要加载所有的页进内存来遍历查找）。</p>\n<p>因此如果将一个原本存储目录和记录的页，用来指向多个页（页本身也有编号），也同样可以使用树来优化查找速度。</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/b6fd85519d2e3632cab872755cea83d.png\" alt=\"b6fd85519d2e3632cab872755cea83d\" tabindex=\"0\" loading=\"lazy\"><figcaption>b6fd85519d2e3632cab872755cea83d</figcaption></figure>\n<p>而整个结构就是 <code v-pre>B+</code> 树，但是不是所有的索引都会使用 <code v-pre>B+</code> 树，也有使用哈希的。有了 <code v-pre>B+</code> 树就可以提高查找数据：</p>\n<ol>\n<li>一次淘汰更多的数据，线性查找一次只能淘汰一个数据（只需要加载一个根节点，找到局部的 <code v-pre>B+</code> 树，减少了 <code v-pre>IO</code> 次数）</li>\n<li>在这颗树上，只有叶子节点才保有数据，而非叶子节点只有目录项（可以存储更多目录项）</li>\n</ol>\n<blockquote>\n<p>注意：概念里的大部分 <code v-pre>B+</code> 树只有根节点之间才有链式链接。</p>\n</blockquote>\n<p>那如果我们没有主键呢？<code v-pre>MySQL</code> 也会这么组织一个数据表，因为 <code v-pre>MySQL</code> 默认会生成一个隐藏列，这个列默认就是主键，会根据这个隐藏主键来组织数据表。</p>\n<p>所以设置索引之前，只会根据这个默认主键来构造 <code v-pre>B+</code> 树，但是索引后会根据设置的列来构建 <code v-pre>B+</code> 树。前后是两颗 <code v-pre>B+</code> 树，根据不同的列来构建，只有搜索格子对应的列时，才会使用对应的 <code v-pre>B+</code> 来查找，如果对应列没有 <code v-pre>B+</code> 树，那就只能遍历数据表来查找数据。</p>\n<p>在 <code v-pre>MySQl</code> 中，选择这种树状数据结构，对于范围查找会更加快速。</p>\n<p>至此，建立索引，就是建立一个方便查询的树状数据结构。</p>\n<blockquote>\n<p>补充：为什么不选择其他数据结构？</p>\n<ul>\n<li>链表：线性遍历</li>\n<li>二叉搜索树：遇到很多节点时退化为线性结构</li>\n<li><code v-pre>AVL</code> 和 <code v-pre>RB</code>：虽然保证了平衡，但是由于只有左右节点，但是树的整体有可能过高，同层数据量较少</li>\n<li><code v-pre>hash</code>：理论上是可以，搜索时间复杂度是 <code v-pre>O(1)</code>，但是在范围查找的场景下有致命的缺陷，但是不排除有这种实现</li>\n<li><code v-pre>B</code> 树：理论上是可以， <code v-pre>B</code> 的路径节点也会保存数据，叶子节点不会进行线性链接（这意味着路径节点里的数据变多，但是目录变少，导致树的高度可能偏高，最终导致 <code v-pre>IO</code> 的加载次数可能变多，一般 <code v-pre>IO</code> 的成本较高）</li>\n</ul>\n</blockquote>\n<h1 id=\"_4-索引的分类\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-索引的分类\"><span>4.索引的分类</span></a></h1>\n<ul>\n<li>\n<p><strong>聚簇索引</strong>：将所有的数据存储在叶子节点的存储引擎对应的就是 <code v-pre>Inno DB</code> 默认的存储结构（用户数据和索引数据存放再一起）</p>\n</li>\n<li>\n<p><strong>非聚簇索引</strong>：而 <code v-pre>MyISAM</code> 同样也是使用 <code v-pre>B+</code> 树结构，但是叶子节点不再存放数据，而是存储数据的地址（用户数据和索引数据存放在两处）</p>\n</li>\n</ul>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 查看聚簇索引和非聚簇索引的区别</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest( id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ) engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">innodb; # 其实之前建表都是默认使用 InnoDB 的存储引擎，但是我们写明这一点</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">03</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># pwd </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">var</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lib</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">limou_database</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># ls</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">db</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">opt</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">frm</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">ibd</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">drop</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest( id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ) engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM; </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">02</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># pwd </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">var</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lib</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">limou_database</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># ls</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">db</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">opt</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">frm</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">MYD</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">MYI</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>对比就可以看到：</p>\n<ul>\n<li>如果使用 <code v-pre>innodb</code> 引擎，就会存在三个文件，其中 <code v-pre>.frm</code> 就是数据表本身的结构，而 <code v-pre>.ibd</code> 就是数据和索引结构</li>\n<li>如果使用 <code v-pre>MyISAM</code> 引擎，就会存在四个文件，其中 <code v-pre>.frm</code> 就是数据表本身的结构，而 <code v-pre>.MYD</code> 就是数据，<code v-pre>.MYI</code> 就是索引结构</li>\n</ul>\n<p>如果我们在主键索引的基础上，又建立了普通索引，也会重新构造一个 <code v-pre>B+</code> 树，但是叶子节点不会存储所有的数据（浪费空间），而是存储对应数据的主键，然后根据这个主键再次回到主索引的 <code v-pre>B+</code> 树中，根据主键来搜寻完整的列记录（也叫“回表查询”）。</p>\n<h1 id=\"_5-索引的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-索引的使用\"><span>5.索引的使用</span></a></h1>\n<h2 id=\"_5-1-主键索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-1-主键索引\"><span>5.1.主键索引</span></a></h2>\n<ol>\n<li>在创建表的同时，设置某一列为 <code v-pre>primary key</code> 即可自动建立主键索引（可以在列定义中，也可以在表创建语法的最后指定某列）</li>\n<li>或者创建表后，使用语法 <code v-pre>ALTER TABLE table_name ADD INDEX(field_name);</code> 即可创建主键索引</li>\n</ol>\n<p>可以使用 <code v-pre>SHOW KEY FROM table_name</code> 或 <code v-pre>SHOW INDEX/KEY FROM table_name</code> 或 <code v-pre>DESC table_name</code> 来查看索引设定</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">       Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CREATE</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> TABLE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mtest</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  PRIMARY KEY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) ENGINE</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">DEFAULT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CHARSET</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">latin1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> SHOW </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INDEX</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest # 表名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 是否非唯一性 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 索引名称，默认叫“主键”</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id # 索引对应表中的某一列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE # 索引类型，就是 B</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 树</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>而使用 <code v-pre>ALTER TABLE table_name DROP PRIMARY KEY;</code> 则可以删除索引。</p>\n<h2 id=\"_5-2-普通索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-2-普通索引\"><span>5.2.普通索引</span></a></h2>\n<p>实际上如果在创建表的同时添加 <code v-pre>QUIQUE</code> 属性，或者创建后使用 <code v-pre>ALTER TABLE table_name ADD UNIQUE(field_name);</code> 时，也会创建唯一索引，和主键索引的区别就是可以不可以为空的问题。</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> alter</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">add</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> unique</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Records: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Duplicates: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Warnings: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">index</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>而删除唯一索引就是使用 <code v-pre>ALTER TABLE table_name DROP INDEX key_name;</code> 或者 <code v-pre>DROP INDEX index_name ON table_name;</code>，而如果是其他指定的普通索引，也是一样的删除方法（这是因为唯一索引也是一种特殊的普通索引）。</p>\n<p>而普通索引的建立方法在一开始有提到过，就是：</p>\n<ul>\n<li><code v-pre>ALTER TABLE table_name ADD INDEX(field_name);</code></li>\n<li>或者在创建数据表的时候在末尾加上 <code v-pre>INDEX(field_name);</code></li>\n<li>也可以使用 <code v-pre>CREAT INDEX [index_new_name] on table_name(field_name);</code> 并且可以重命名普通索引的索引名称</li>\n</ul>\n<p>最后，普通索引的删除方法和唯一约束是一样的。</p>\n<p>普通索引还可以使用多个列来构成（也就是“复合索引”），这样构建的索引仍旧是一棵 <code v-pre>B+</code> 树，使用 <code v-pre>SHOW INDEX FROM table_name</code> 就会查找到两行信息，但是索引名字都一样，只是对应列不一样。</p>\n<p>复合索引有多个 <code v-pre>key</code> 值，查找一个 <code v-pre>key</code> 时，如果想要查找的数据本身就是另外一个 <code v-pre>key</code> 值，那么其实无需进行回表查询，直接返回 <code v-pre>key</code> 值就行，如果时还有查询其他记录的其他数据，就需要返回主键进行一次回表查询（不过这个过程无需用户操作，<code v-pre>MySQL</code> 会自动进行，这种情况也叫做“索引覆盖问题”，覆盖的是主键）。</p>\n<p>但是查找过程中需要给定最左边的字段，而不能给其他的字段，这是 <code v-pre>MySQL</code> 的索引最做匹配原则（原因是按照从左到右的顺序匹配的）。</p>\n<blockquote>\n<p>补充：一般来说  (1)唯一性太差的 (2)更新过于频繁的 (3)根本不会出现在 <code v-pre>WHERE</code> 子句中用来查询的 字段最好不要作为索引，容易导致索引结构被频繁修改。</p>\n</blockquote>\n<h2 id=\"_5-3-全文索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-3-全文索引\"><span>5.3.全文索引</span></a></h2>\n<p>我们之前提到的索引，都是使用比较短的数据来构建 <code v-pre>B+</code> 树的，但是有些时候会存储较长的文本数据，这个时候一般使用全文索引（<code v-pre>FULLTEXT</code>），不过 <code v-pre>MySQL</code> 的全文索引要求搜索引擎必须是 <code v-pre>MyISAM</code>，并且默认的全文索引只支持英文的而不支持中文（但是插件 <code v-pre>sphinx</code> 的中文版支持中文全文索引）。</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 尝试使用全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)建表的同时设置全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> unsigned auto_increment </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    title </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">200</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    body </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">text</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">fulltext</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(title,body) # 全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">01</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles (title,body) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL Tutorial</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">DBMS stands for DataBase ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">How To Use MySQL Well</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">After you went through a ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Optimizing MySQL</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">In this tutorial we will show ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1001 MySQL Tricks</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1. Never run mysqld as root. 2. ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL vs. YourSQL</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">In the following database comparison ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL Security</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">When configured properly, MySQL ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Records: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Duplicates: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Warnings: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)查看表的索引信息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">index</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: YES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FULLTEXT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: body</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: YES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FULLTEXT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)使用模糊匹配</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> body </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%database%</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">; # 但是这里是普通搜索，实际上没有使用到全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | title             | body                                     |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL Tutorial    | DBMS stands </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DataBase</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ...             |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL vs. YourSQL | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">In</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> the </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">following</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> database</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> comparison ... |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)查看 MySQL 语句对应的执行计划</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> explain </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> body </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%database%</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">           id: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  select_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SIMPLE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles # 要操作的数据表</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   partitions: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         type</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: ALL # 这次查询的方式是全部遍历</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">possible_keys: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">          key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 值表示没有应用索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      key_len: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">          ref: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     filtered: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">67</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        Extra: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Using</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> where</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> warning (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> match</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (title,body) against (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">database</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | title             | body                                     |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL vs. YourSQL | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">In</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> the </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">following</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> database</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> comparison ... |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL Tutorial    | DBMS stands </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DataBase</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ...             |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> explain </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> match</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (title,body) against (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">database</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">           id: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  select_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SIMPLE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   partitions: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         type</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">fulltext</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">possible_keys: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">          key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: title # 以 title 作为索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      key_len: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">          ref: const</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     filtered: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">100</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        Extra: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Using</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> where</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> warning (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></template>","contentStripped":"<blockquote>\n<p>索引可以提高海量数据库的性能（不加内存，不改程序，不调 <code v-pre>sql</code>），只需要执行正确的 <code v-pre>create index</code> ，查询速度就可能提高成百上千倍。</p>\n<p>但查询速度的提高是以插入、更新、删除的速度作为代价的，这些写操作增加了大量的 <code v-pre>IO</code>。</p>\n</blockquote>\n<p>上述这段话还有很多是我们体会不到的，继续往下看。</p>\n<p>我们先记住，<code v-pre>MySQL</code> 的服务器进程，所有的 <code v-pre>CURD</code> 都是在内存中进行的，索引也是这样，在内存中一定存在某种数据结构。</p>\n<p>而优化算法的因素主要有两个：</p>\n<ul>\n<li>组织数据的方法（例如：顺序表改写为二树树表）</li>\n<li>算法的设计本身（例如：顺序查找改为二分查找）</li>\n</ul>\n<p>而索引就是针对第一个方式对数据做优化，让查询速度变快，我们可以见一见什么叫索引。</p>\n<ol>\n<li>\n<p>先建立一个 <code v-pre>.sql</code> 文件，该文件可以创建大批量的随机数：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 待补充</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p>使用 <code v-pre>ALTER TABLE table_name ADD INDEX(字段);</code> 添加索引</p>\n</li>\n<li>\n<p>比较不带索引和带上索引的查询速度差异...</p>\n</li>\n</ol>\n<h1 id=\"_2-磁盘和-mysql\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-磁盘和-mysql\"><span>2.磁盘和 MySQL</span></a></h1>\n<p>之前在 <code v-pre>Linux</code> 里学习了文件 <code v-pre>IO</code>，里面有提到磁盘的结构和抽象，而 <code v-pre>MySQl</code> 也可以看作是一种特殊的文件系统。</p>\n<p><code v-pre>MySQL</code> 层下不是直接对接硬盘，而是对接操作系统，通过调用操作系统来进行文件管理。</p>\n<p><code v-pre>MySQL</code> 的 <code v-pre>IO</code> 次数更加频繁，因此为了提高基本的 <code v-pre>IO</code> 效率，<code v-pre>MySQL</code> 进行 <code v-pre>IO</code> 的基本单位是 <code v-pre>16KB</code>（系统文件是用 <code v-pre>4KB</code> 的逻辑块来查找，而磁盘是 <code v-pre>512byte</code> 来读取）。</p>\n<p>这 <code v-pre>16KB</code> 的 <code v-pre>IO</code> 操作实际上是向操作系统提出来的。</p>\n<p>这刚好和 <code v-pre>InnoDB</code> 引擎的大小一样：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 查看大小</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">global</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> status</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">innodb_page_size</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| Variable_name    | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Value</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| Innodb_page_size | </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16384</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">------------------+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">01</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>因此可以衍生出以下思考：</p>\n<ul>\n<li>\n<p>对于 <code v-pre>MySQL</code> 来说，数据文件都是以 <code v-pre>page=16KB</code> 为单位在磁盘中保存的</p>\n</li>\n<li>\n<p><code v-pre>MySQL</code> 的 <code v-pre>CURD</code> 都需要通过 <code v-pre>CPU</code> 计算，因此就必须要 <code v-pre>CPU</code> 参与，进一步就需要内存参与，要通过操作系统接口，把数据从磁盘移动到内存中</p>\n</li>\n<li>\n<p>磁盘和内存的交互就是一种 <code v-pre>IO</code> 操作，<code v-pre>IO</code> 的基本单位就是 <code v-pre>page</code></p>\n</li>\n<li>\n<p>而为了更好在内存中操作和提高效率（导致效率低下的主要矛盾是 <code v-pre>IO</code> 次数而不是一次 <code v-pre>IO</code> 大小），<code v-pre>MySQl</code> 向内存申请了一个较大的 <code v-pre>Buffer Pool=128M</code> 内存空间，来进行各种缓存，以便提高命中率，减少大量的系统和磁盘交互的次数</p>\n</li>\n<li>\n<p><code v-pre>MySQL</code> 内部会存在大量的 <code v-pre>page</code>，因此就需要对 <code v-pre>page</code> 先描述再组织，然后用一定的数据结构连接起来，因此就是 <code v-pre>MySQl</code> 对 <code v-pre>page</code> 进行了建模</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/698589b9e2ce7350e19fa9a9f44ed7f.png\" alt=\"698589b9e2ce7350e19fa9a9f44ed7f\" tabindex=\"0\" loading=\"lazy\"><figcaption>698589b9e2ce7350e19fa9a9f44ed7f</figcaption></figure>\n</li>\n</ul>\n<h1 id=\"_3-索引的原理\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-索引的原理\"><span>3.索引的原理</span></a></h1>\n<p>经过前面的对比和铺垫，接下来我们就可以来深入了解索引的原理了，首先创建一个 <code v-pre>user</code> 表：</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 创建 user 表</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> if</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> not</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> exists</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 一定要添加主键（会默认生成主键索引）</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     age </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">     name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> );</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">02</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">       Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: user</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CREATE</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> TABLE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">user</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  PRIMARY KEY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) ENGINE</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">InnoDB </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">DEFAULT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CHARSET</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">latin1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">limou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">dimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">26</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">iimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">36</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">eimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> insert into</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user (id, age, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">56</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">pimou</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> user;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | age | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">56</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | pimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">26</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | iimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | limou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | dimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> |  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">36</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | eimou |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-----+-------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>我们发现，我向具有主键的表中插入时，数据会自动进行排序。实际上插入一条记录就是插入某个数据结构，而查找也是在查找某个数据结构，那什么结构比较适用用 <code v-pre>MySQL</code> 这样需要大量查找的数据库呢？</p>\n<p>如果单纯使用链表来链接各种数据结构，就会导致顺序查找，进而降低查找效率。</p>\n<p>那我们能不能引入树状结构呢（树状结构很适合查找）？肯定是可以的，因此我们引入 <strong>页内目录</strong> 的概念，这是一种空间换时间的做法（把本来用于存储记录的空间拿来存储目录），先查找对应的目录，再查找记录，效率会大大提高。</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/29c5dc3ef69feeab2f31a4479263af0.png\" alt=\"29c5dc3ef69feeab2f31a4479263af0\" tabindex=\"0\" loading=\"lazy\"><figcaption>29c5dc3ef69feeab2f31a4479263af0</figcaption></figure>\n<p>因此加上主键变成有序的原因就是为了页内目录做服务（书籍页码的有序，是为了更高效使用书籍目录来查询对应的书页），只有有序了才能方便分类进不同的目录。</p>\n<p>但是 <code v-pre>page</code> 彼此之间还是线性的，一旦数据库的数据变大起来就会自动创建多个 <code v-pre>page</code> 来存储数据，此时要找到跨度比较大的数据，也需要大量的线性遍历（一旦一个数据再数据库的最后一页，那就需要加载所有的页进内存来遍历查找）。</p>\n<p>因此如果将一个原本存储目录和记录的页，用来指向多个页（页本身也有编号），也同样可以使用树来优化查找速度。</p>\n<figure><img src=\"@source/4.业务服务/2.存储服务/assets/b6fd85519d2e3632cab872755cea83d.png\" alt=\"b6fd85519d2e3632cab872755cea83d\" tabindex=\"0\" loading=\"lazy\"><figcaption>b6fd85519d2e3632cab872755cea83d</figcaption></figure>\n<p>而整个结构就是 <code v-pre>B+</code> 树，但是不是所有的索引都会使用 <code v-pre>B+</code> 树，也有使用哈希的。有了 <code v-pre>B+</code> 树就可以提高查找数据：</p>\n<ol>\n<li>一次淘汰更多的数据，线性查找一次只能淘汰一个数据（只需要加载一个根节点，找到局部的 <code v-pre>B+</code> 树，减少了 <code v-pre>IO</code> 次数）</li>\n<li>在这颗树上，只有叶子节点才保有数据，而非叶子节点只有目录项（可以存储更多目录项）</li>\n</ol>\n<blockquote>\n<p>注意：概念里的大部分 <code v-pre>B+</code> 树只有根节点之间才有链式链接。</p>\n</blockquote>\n<p>那如果我们没有主键呢？<code v-pre>MySQL</code> 也会这么组织一个数据表，因为 <code v-pre>MySQL</code> 默认会生成一个隐藏列，这个列默认就是主键，会根据这个隐藏主键来组织数据表。</p>\n<p>所以设置索引之前，只会根据这个默认主键来构造 <code v-pre>B+</code> 树，但是索引后会根据设置的列来构建 <code v-pre>B+</code> 树。前后是两颗 <code v-pre>B+</code> 树，根据不同的列来构建，只有搜索格子对应的列时，才会使用对应的 <code v-pre>B+</code> 来查找，如果对应列没有 <code v-pre>B+</code> 树，那就只能遍历数据表来查找数据。</p>\n<p>在 <code v-pre>MySQl</code> 中，选择这种树状数据结构，对于范围查找会更加快速。</p>\n<p>至此，建立索引，就是建立一个方便查询的树状数据结构。</p>\n<blockquote>\n<p>补充：为什么不选择其他数据结构？</p>\n<ul>\n<li>链表：线性遍历</li>\n<li>二叉搜索树：遇到很多节点时退化为线性结构</li>\n<li><code v-pre>AVL</code> 和 <code v-pre>RB</code>：虽然保证了平衡，但是由于只有左右节点，但是树的整体有可能过高，同层数据量较少</li>\n<li><code v-pre>hash</code>：理论上是可以，搜索时间复杂度是 <code v-pre>O(1)</code>，但是在范围查找的场景下有致命的缺陷，但是不排除有这种实现</li>\n<li><code v-pre>B</code> 树：理论上是可以， <code v-pre>B</code> 的路径节点也会保存数据，叶子节点不会进行线性链接（这意味着路径节点里的数据变多，但是目录变少，导致树的高度可能偏高，最终导致 <code v-pre>IO</code> 的加载次数可能变多，一般 <code v-pre>IO</code> 的成本较高）</li>\n</ul>\n</blockquote>\n<h1 id=\"_4-索引的分类\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-索引的分类\"><span>4.索引的分类</span></a></h1>\n<ul>\n<li>\n<p><strong>聚簇索引</strong>：将所有的数据存储在叶子节点的存储引擎对应的就是 <code v-pre>Inno DB</code> 默认的存储结构（用户数据和索引数据存放再一起）</p>\n</li>\n<li>\n<p><strong>非聚簇索引</strong>：而 <code v-pre>MyISAM</code> 同样也是使用 <code v-pre>B+</code> 树结构，但是叶子节点不再存放数据，而是存储数据的地址（用户数据和索引数据存放在两处）</p>\n</li>\n</ul>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 查看聚簇索引和非聚簇索引的区别</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest( id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ) engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">innodb; # 其实之前建表都是默认使用 InnoDB 的存储引擎，但是我们写明这一点</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">03</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># pwd </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">var</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lib</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">limou_database</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># ls</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">db</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">opt</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">frm</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">ibd</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">drop</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest( id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ) engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM; </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">02</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># pwd </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">var</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">lib</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">limou_database</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># ls</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">db</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">opt</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">frm</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">MYD</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">  mtest</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">MYI</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>对比就可以看到：</p>\n<ul>\n<li>如果使用 <code v-pre>innodb</code> 引擎，就会存在三个文件，其中 <code v-pre>.frm</code> 就是数据表本身的结构，而 <code v-pre>.ibd</code> 就是数据和索引结构</li>\n<li>如果使用 <code v-pre>MyISAM</code> 引擎，就会存在四个文件，其中 <code v-pre>.frm</code> 就是数据表本身的结构，而 <code v-pre>.MYD</code> 就是数据，<code v-pre>.MYI</code> 就是索引结构</li>\n</ul>\n<p>如果我们在主键索引的基础上，又建立了普通索引，也会重新构造一个 <code v-pre>B+</code> 树，但是叶子节点不会存储所有的数据（浪费空间），而是存储对应数据的主键，然后根据这个主键再次回到主索引的 <code v-pre>B+</code> 树中，根据主键来搜寻完整的列记录（也叫“回表查询”）。</p>\n<h1 id=\"_5-索引的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-索引的使用\"><span>5.索引的使用</span></a></h1>\n<h2 id=\"_5-1-主键索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-1-主键索引\"><span>5.1.主键索引</span></a></h2>\n<ol>\n<li>在创建表的同时，设置某一列为 <code v-pre>primary key</code> 即可自动建立主键索引（可以在列定义中，也可以在表创建语法的最后指定某列）</li>\n<li>或者创建表后，使用语法 <code v-pre>ALTER TABLE table_name ADD INDEX(field_name);</code> 即可创建主键索引</li>\n</ol>\n<p>可以使用 <code v-pre>SHOW KEY FROM table_name</code> 或 <code v-pre>SHOW INDEX/KEY FROM table_name</code> 或 <code v-pre>DESC table_name</code> 来查看索引设定</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">       Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CREATE</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> TABLE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">mtest</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">  `</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">name</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOT NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  PRIMARY KEY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">id</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) ENGINE</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">DEFAULT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CHARSET</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">latin1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> SHOW </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INDEX</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest # 表名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 是否非唯一性 </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 索引名称，默认叫“主键”</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id # 索引对应表中的某一列</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE # 索引类型，就是 B</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 树</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>而使用 <code v-pre>ALTER TABLE table_name DROP PRIMARY KEY;</code> 则可以删除索引。</p>\n<h2 id=\"_5-2-普通索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-2-普通索引\"><span>5.2.普通索引</span></a></h2>\n<p>实际上如果在创建表的同时添加 <code v-pre>QUIQUE</code> 属性，或者创建后使用 <code v-pre>ALTER TABLE table_name ADD UNIQUE(field_name);</code> 时，也会创建唯一索引，和主键索引的区别就是可以不可以为空的问题。</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> alter</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">add</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> unique</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Records: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Duplicates: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Warnings: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">index</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> mtest\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: mtest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>而删除唯一索引就是使用 <code v-pre>ALTER TABLE table_name DROP INDEX key_name;</code> 或者 <code v-pre>DROP INDEX index_name ON table_name;</code>，而如果是其他指定的普通索引，也是一样的删除方法（这是因为唯一索引也是一种特殊的普通索引）。</p>\n<p>而普通索引的建立方法在一开始有提到过，就是：</p>\n<ul>\n<li><code v-pre>ALTER TABLE table_name ADD INDEX(field_name);</code></li>\n<li>或者在创建数据表的时候在末尾加上 <code v-pre>INDEX(field_name);</code></li>\n<li>也可以使用 <code v-pre>CREAT INDEX [index_new_name] on table_name(field_name);</code> 并且可以重命名普通索引的索引名称</li>\n</ul>\n<p>最后，普通索引的删除方法和唯一约束是一样的。</p>\n<p>普通索引还可以使用多个列来构成（也就是“复合索引”），这样构建的索引仍旧是一棵 <code v-pre>B+</code> 树，使用 <code v-pre>SHOW INDEX FROM table_name</code> 就会查找到两行信息，但是索引名字都一样，只是对应列不一样。</p>\n<p>复合索引有多个 <code v-pre>key</code> 值，查找一个 <code v-pre>key</code> 时，如果想要查找的数据本身就是另外一个 <code v-pre>key</code> 值，那么其实无需进行回表查询，直接返回 <code v-pre>key</code> 值就行，如果时还有查询其他记录的其他数据，就需要返回主键进行一次回表查询（不过这个过程无需用户操作，<code v-pre>MySQL</code> 会自动进行，这种情况也叫做“索引覆盖问题”，覆盖的是主键）。</p>\n<p>但是查找过程中需要给定最左边的字段，而不能给其他的字段，这是 <code v-pre>MySQL</code> 的索引最做匹配原则（原因是按照从左到右的顺序匹配的）。</p>\n<blockquote>\n<p>补充：一般来说  (1)唯一性太差的 (2)更新过于频繁的 (3)根本不会出现在 <code v-pre>WHERE</code> 子句中用来查询的 字段最好不要作为索引，容易导致索引结构被频繁修改。</p>\n</blockquote>\n<h2 id=\"_5-3-全文索引\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-3-全文索引\"><span>5.3.全文索引</span></a></h2>\n<p>我们之前提到的索引，都是使用比较短的数据来构建 <code v-pre>B+</code> 树的，但是有些时候会存储较长的文本数据，这个时候一般使用全文索引（<code v-pre>FULLTEXT</code>），不过 <code v-pre>MySQL</code> 的全文索引要求搜索引擎必须是 <code v-pre>MyISAM</code>，并且默认的全文索引只支持英文的而不支持中文（但是插件 <code v-pre>sphinx</code> 的中文版支持中文全文索引）。</p>\n<div class=\"language-sql line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"sql\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-sql\"><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># 尝试使用全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)建表的同时设置全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> create</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles (</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    id </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> unsigned auto_increment </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">not null</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> primary key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    title </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">varchar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">200</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    body </span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">text</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">fulltext</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(title,body) # 全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)engine</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">MyISAM;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">01</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles (title,body) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL Tutorial</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">DBMS stands for DataBase ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">How To Use MySQL Well</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">After you went through a ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Optimizing MySQL</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">In this tutorial we will show ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1001 MySQL Tricks</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">1. Never run mysqld as root. 2. ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL vs. YourSQL</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">In the following database comparison ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">    -></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">MySQL Security</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">When configured properly, MySQL ...</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Query OK, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> affected (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Records: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Duplicates: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Warnings: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)查看表的索引信息</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> show </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">index</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">PRIMARY</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: A</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: BTREE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: YES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FULLTEXT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        Table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Non_unique: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Key_name: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> Seq_in_index: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Column_name: body</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">    Collation: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  Cardinality: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     Sub_part: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">       Packed: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         Null</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: YES</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   Index_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FULLTEXT</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      Comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">Index_comment: </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)使用模糊匹配</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> body </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%database%</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">; # 但是这里是普通搜索，实际上没有使用到全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | title             | body                                     |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL Tutorial    | DBMS stands </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DataBase</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ...             |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL vs. YourSQL | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">In</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> the </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">following</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> database</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> comparison ... |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"># (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)查看 MySQL 语句对应的执行计划</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> explain </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> body </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">like</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%database%</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">           id: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  select_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SIMPLE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles # 要操作的数据表</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   partitions: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         type</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: ALL # 这次查询的方式是全部遍历</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">possible_keys: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">          key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 值表示没有应用索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      key_len: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">          ref: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     filtered: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">67</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        Extra: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Using</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> where</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> warning (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> match</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (title,body) against (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">database</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">| id | title             | body                                     |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL vs. YourSQL | </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">In</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> the </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">following</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> database</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> comparison ... |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">|  </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> | MySQL Tutorial    | DBMS stands </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DataBase</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ...             |</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">----+-------------------+------------------------------------------+</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> rows</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">mysql</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> explain </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> articles </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> match</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (title,body) against (</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">database</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)\\G</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">***************************</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">. </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">row</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ***************************</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">           id: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  select_type: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SIMPLE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">        table</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: articles</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">   partitions: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NULL</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         type</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">fulltext</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> # 全文索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">possible_keys: title</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">          key</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: title # 以 title 作为索引</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">      key_len: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">          ref: const</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">         rows</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">     filtered: </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">100</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        Extra: </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">Using</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> where</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> row</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> set</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> warning (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">00</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sec)</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n>   索引可以提高海量数据库的性能（不加内存，不改程序，不调 `sql`），只需要执行正确的 `create index` ，查询速度就可能提高成百上千倍。\n>\n>   但查询速度的提高是以插入、更新、删除的速度作为代价的，这些写操作增加了大量的 `IO`。\n\n上述这段话还有很多是我们体会不到的，继续往下看。\n\n我们先记住，`MySQL` 的服务器进程，所有的 `CURD` 都是在内存中进行的，索引也是这样，在内存中一定存在某种数据结构。\n\n而优化算法的因素主要有两个：\n\n-   组织数据的方法（例如：顺序表改写为二树树表）\n-   算法的设计本身（例如：顺序查找改为二分查找）\n\n而索引就是针对第一个方式对数据做优化，让查询速度变快，我们可以见一见什么叫索引。\n\n1.   先建立一个 `.sql` 文件，该文件可以创建大批量的随机数：\n\n     ```sql\n     # 待补充\n     ```\n\n2.   使用 `ALTER TABLE table_name ADD INDEX(字段);` 添加索引\n\n3.   比较不带索引和带上索引的查询速度差异...\n\n# 2.磁盘和 MySQL\n\n之前在 `Linux` 里学习了文件 `IO`，里面有提到磁盘的结构和抽象，而 `MySQl` 也可以看作是一种特殊的文件系统。\n\n`MySQL` 层下不是直接对接硬盘，而是对接操作系统，通过调用操作系统来进行文件管理。\n\n`MySQL` 的 `IO` 次数更加频繁，因此为了提高基本的 `IO` 效率，`MySQL` 进行 `IO` 的基本单位是 `16KB`（系统文件是用 `4KB` 的逻辑块来查找，而磁盘是 `512byte` 来读取）。\n\n这 `16KB` 的 `IO` 操作实际上是向操作系统提出来的。\n\n这刚好和 `InnoDB` 引擎的大小一样：\n\n```sql\n# 查看大小\nmysql> show global status like 'innodb_page_size';\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| Innodb_page_size | 16384 |\n+------------------+-------+\n1 row in set (0.01 sec)\n```\n\n因此可以衍生出以下思考：\n\n-   对于 `MySQL` 来说，数据文件都是以 `page=16KB` 为单位在磁盘中保存的\n\n-   `MySQL` 的 `CURD` 都需要通过 `CPU` 计算，因此就必须要 `CPU` 参与，进一步就需要内存参与，要通过操作系统接口，把数据从磁盘移动到内存中\n\n-   磁盘和内存的交互就是一种 `IO` 操作，`IO` 的基本单位就是 `page`\n\n-   而为了更好在内存中操作和提高效率（导致效率低下的主要矛盾是 `IO` 次数而不是一次 `IO` 大小），`MySQl` 向内存申请了一个较大的 `Buffer Pool=128M` 内存空间，来进行各种缓存，以便提高命中率，减少大量的系统和磁盘交互的次数\n\n-   `MySQL` 内部会存在大量的 `page`，因此就需要对 `page` 先描述再组织，然后用一定的数据结构连接起来，因此就是 `MySQl` 对 `page` 进行了建模\n\n    ![698589b9e2ce7350e19fa9a9f44ed7f](./assets/698589b9e2ce7350e19fa9a9f44ed7f.png)\n\n# 3.索引的原理\n\n经过前面的对比和铺垫，接下来我们就可以来深入了解索引的原理了，首先创建一个 `user` 表：\n\n```sql\n# 创建 user 表\nmysql> create table if not exists user (\n    ->     id int primary key, -- 一定要添加主键（会默认生成主键索引）\n    ->     age int not null,\n    ->     name varchar(16) not null\n    -> );\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql> show create table user\\G\n*************************** 1. row ***************************\n       Table: user\nCreate Table: CREATE TABLE `user` (\n  `id` int(11) NOT NULL,\n  `age` int(11) NOT NULL,\n  `name` varchar(16) NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n1 row in set (0.00 sec)\n\nmysql> insert into user (id, age, name) values(3, 18, 'limou');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> insert into user (id, age, name) values(4, 16, 'dimou');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> insert into user (id, age, name) values(2, 26, 'iimou');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> insert into user (id, age, name) values(5, 36, 'eimou');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> insert into user (id, age, name) values(1, 56, 'pimou');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> select * from user;\n+----+-----+-------+\n| id | age | name  |\n+----+-----+-------+\n|  1 |  56 | pimou |\n|  2 |  26 | iimou |\n|  3 |  18 | limou |\n|  4 |  16 | dimou |\n|  5 |  36 | eimou |\n+----+-----+-------+\n5 rows in set (0.00 sec)\n```\n\n我们发现，我向具有主键的表中插入时，数据会自动进行排序。实际上插入一条记录就是插入某个数据结构，而查找也是在查找某个数据结构，那什么结构比较适用用 `MySQL` 这样需要大量查找的数据库呢？\n\n如果单纯使用链表来链接各种数据结构，就会导致顺序查找，进而降低查找效率。\n\n那我们能不能引入树状结构呢（树状结构很适合查找）？肯定是可以的，因此我们引入 **页内目录** 的概念，这是一种空间换时间的做法（把本来用于存储记录的空间拿来存储目录），先查找对应的目录，再查找记录，效率会大大提高。\n\n![29c5dc3ef69feeab2f31a4479263af0](./assets/29c5dc3ef69feeab2f31a4479263af0.png)\n\n因此加上主键变成有序的原因就是为了页内目录做服务（书籍页码的有序，是为了更高效使用书籍目录来查询对应的书页），只有有序了才能方便分类进不同的目录。\n\n但是 `page` 彼此之间还是线性的，一旦数据库的数据变大起来就会自动创建多个 `page` 来存储数据，此时要找到跨度比较大的数据，也需要大量的线性遍历（一旦一个数据再数据库的最后一页，那就需要加载所有的页进内存来遍历查找）。\n\n因此如果将一个原本存储目录和记录的页，用来指向多个页（页本身也有编号），也同样可以使用树来优化查找速度。\n\n![b6fd85519d2e3632cab872755cea83d](./assets/b6fd85519d2e3632cab872755cea83d.png)\n\n而整个结构就是 `B+` 树，但是不是所有的索引都会使用 `B+` 树，也有使用哈希的。有了 `B+` 树就可以提高查找数据：\n\n1.   一次淘汰更多的数据，线性查找一次只能淘汰一个数据（只需要加载一个根节点，找到局部的 `B+` 树，减少了 `IO` 次数）\n2.   在这颗树上，只有叶子节点才保有数据，而非叶子节点只有目录项（可以存储更多目录项）\n\n>   注意：概念里的大部分 `B+` 树只有根节点之间才有链式链接。\n\n那如果我们没有主键呢？`MySQL` 也会这么组织一个数据表，因为 `MySQL` 默认会生成一个隐藏列，这个列默认就是主键，会根据这个隐藏主键来组织数据表。\n\n所以设置索引之前，只会根据这个默认主键来构造 `B+` 树，但是索引后会根据设置的列来构建 `B+` 树。前后是两颗 `B+` 树，根据不同的列来构建，只有搜索格子对应的列时，才会使用对应的 `B+` 来查找，如果对应列没有 `B+` 树，那就只能遍历数据表来查找数据。\n\n在 `MySQl` 中，选择这种树状数据结构，对于范围查找会更加快速。\n\n至此，建立索引，就是建立一个方便查询的树状数据结构。\n\n>   补充：为什么不选择其他数据结构？\n>\n>   -   链表：线性遍历\n>   -   二叉搜索树：遇到很多节点时退化为线性结构\n>   -   `AVL` 和 `RB`：虽然保证了平衡，但是由于只有左右节点，但是树的整体有可能过高，同层数据量较少\n>   -   `hash`：理论上是可以，搜索时间复杂度是 `O(1)`，但是在范围查找的场景下有致命的缺陷，但是不排除有这种实现\n>   -   `B` 树：理论上是可以， `B` 的路径节点也会保存数据，叶子节点不会进行线性链接（这意味着路径节点里的数据变多，但是目录变少，导致树的高度可能偏高，最终导致 `IO` 的加载次数可能变多，一般 `IO` 的成本较高）\n\n# 4.索引的分类\n\n-   **聚簇索引**：将所有的数据存储在叶子节点的存储引擎对应的就是 `Inno DB` 默认的存储结构（用户数据和索引数据存放再一起）\n\n-   **非聚簇索引**：而 `MyISAM` 同样也是使用 `B+` 树结构，但是叶子节点不再存放数据，而是存储数据的地址（用户数据和索引数据存放在两处）\n\n```sql\n# 查看聚簇索引和非聚簇索引的区别\n\nmysql> create table mtest( id int primary key, name varchar(11) not null ) engine=innodb; # 其实之前建表都是默认使用 InnoDB 的存储引擎，但是我们写明这一点\nQuery OK, 0 rows affected (0.03 sec)\n\n# pwd \n/var/lib/mysql/limou_database\n# ls\ndb.opt  mtest.frm  mtest.ibd\n\ndrop table mtest\n\nmysql> create table mtest( id int primary key, name varchar(11) not null ) engine=MyISAM; \nQuery OK, 0 rows affected (0.02 sec)\n\n# pwd \n/var/lib/mysql/limou_database\n# ls\ndb.opt  mtest.frm  mtest.MYD  mtest.MYI\n```\n\n对比就可以看到：\n\n-   如果使用 `innodb` 引擎，就会存在三个文件，其中 `.frm` 就是数据表本身的结构，而 `.ibd` 就是数据和索引结构\n-   如果使用 `MyISAM` 引擎，就会存在四个文件，其中 `.frm` 就是数据表本身的结构，而 `.MYD` 就是数据，`.MYI` 就是索引结构\n\n如果我们在主键索引的基础上，又建立了普通索引，也会重新构造一个 `B+` 树，但是叶子节点不会存储所有的数据（浪费空间），而是存储对应数据的主键，然后根据这个主键再次回到主索引的 `B+` 树中，根据主键来搜寻完整的列记录（也叫“回表查询”）。\n\n# 5.索引的使用\n\n## 5.1.主键索引\n\n1.   在创建表的同时，设置某一列为 `primary key` 即可自动建立主键索引（可以在列定义中，也可以在表创建语法的最后指定某列）\n2.   或者创建表后，使用语法 `ALTER TABLE table_name ADD INDEX(field_name);` 即可创建主键索引\n\n可以使用 `SHOW KEY FROM table_name` 或 `SHOW INDEX/KEY FROM table_name` 或 `DESC table_name` 来查看索引设定\n\n```sql\nmysql> show create table mtest\\G\n*************************** 1. row ***************************\n       Table: mtest\nCreate Table: CREATE TABLE `mtest` (\n  `id` int(11) NOT NULL,\n  `name` varchar(11) NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=MyISAM DEFAULT CHARSET=latin1\n1 row in set (0.00 sec)\n\nmysql> SHOW INDEX FROM mtest\\G\n*************************** 1. row ***************************\n        Table: mtest # 表名\n   Non_unique: 0 # 是否非唯一性 \n     Key_name: PRIMARY # 索引名称，默认叫“主键”\n Seq_in_index: 1\n  Column_name: id # 索引对应表中的某一列\n    Collation: A\n  Cardinality: 0\n     Sub_part: NULL\n       Packed: NULL\n         Null: \n   Index_type: BTREE # 索引类型，就是 B+ 树\n      Comment: \nIndex_comment: \n1 row in set (0.00 sec)\n```\n\n而使用 `ALTER TABLE table_name DROP PRIMARY KEY;` 则可以删除索引。\n\n## 5.2.普通索引\n\n实际上如果在创建表的同时添加 `QUIQUE` 属性，或者创建后使用 `ALTER TABLE table_name ADD UNIQUE(field_name);` 时，也会创建唯一索引，和主键索引的区别就是可以不可以为空的问题。\n\n```sql\nmysql> alter table mtest add unique(name);\nQuery OK, 0 rows affected (0.00 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nmysql> show index from mtest\\G\n*************************** 1. row ***************************\n        Table: mtest\n   Non_unique: 0\n     Key_name: PRIMARY\n Seq_in_index: 1\n  Column_name: id\n    Collation: A\n  Cardinality: 0\n     Sub_part: NULL\n       Packed: NULL\n         Null: \n   Index_type: BTREE\n      Comment: \nIndex_comment: \n*************************** 2. row ***************************\n        Table: mtest\n   Non_unique: 0\n     Key_name: name\n Seq_in_index: 1\n  Column_name: name\n    Collation: A\n  Cardinality: 0\n     Sub_part: NULL\n       Packed: NULL\n         Null: \n   Index_type: BTREE\n      Comment: \nIndex_comment: \n2 rows in set (0.00 sec)\n```\n\n而删除唯一索引就是使用 `ALTER TABLE table_name DROP INDEX key_name;` 或者 `DROP INDEX index_name ON table_name;`，而如果是其他指定的普通索引，也是一样的删除方法（这是因为唯一索引也是一种特殊的普通索引）。\n\n而普通索引的建立方法在一开始有提到过，就是：\n\n-   `ALTER TABLE table_name ADD INDEX(field_name);`\n-   或者在创建数据表的时候在末尾加上 `INDEX(field_name);`\n-   也可以使用 `CREAT INDEX [index_new_name] on table_name(field_name);` 并且可以重命名普通索引的索引名称\n\n最后，普通索引的删除方法和唯一约束是一样的。\n\n普通索引还可以使用多个列来构成（也就是“复合索引”），这样构建的索引仍旧是一棵 `B+` 树，使用 `SHOW INDEX FROM table_name` 就会查找到两行信息，但是索引名字都一样，只是对应列不一样。\n\n复合索引有多个 `key` 值，查找一个 `key` 时，如果想要查找的数据本身就是另外一个 `key` 值，那么其实无需进行回表查询，直接返回 `key` 值就行，如果时还有查询其他记录的其他数据，就需要返回主键进行一次回表查询（不过这个过程无需用户操作，`MySQL` 会自动进行，这种情况也叫做“索引覆盖问题”，覆盖的是主键）。\n\n但是查找过程中需要给定最左边的字段，而不能给其他的字段，这是 `MySQL` 的索引最做匹配原则（原因是按照从左到右的顺序匹配的）。\n\n>   补充：一般来说  (1)唯一性太差的 (2)更新过于频繁的 (3)根本不会出现在 `WHERE` 子句中用来查询的 字段最好不要作为索引，容易导致索引结构被频繁修改。\n\n## 5.3.全文索引\n\n我们之前提到的索引，都是使用比较短的数据来构建 `B+` 树的，但是有些时候会存储较长的文本数据，这个时候一般使用全文索引（`FULLTEXT`），不过 `MySQL` 的全文索引要求搜索引擎必须是 `MyISAM`，并且默认的全文索引只支持英文的而不支持中文（但是插件 `sphinx` 的中文版支持中文全文索引）。\n\n```sql\n# 尝试使用全文索引\n# (1)建表的同时设置全文索引\nmysql> create table articles (\n    id int unsigned auto_increment not null primary key,\n    title varchar(200),\n    body text, fulltext(title,body) # 全文索引\n)engine=MyISAM;\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> INSERT INTO articles (title,body) VALUES\n    -> ('MySQL Tutorial','DBMS stands for DataBase ...'),\n    -> ('How To Use MySQL Well','After you went through a ...'),\n    -> ('Optimizing MySQL','In this tutorial we will show ...'),\n    -> ('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),\n    -> ('MySQL vs. YourSQL','In the following database comparison ...'),\n    -> ('MySQL Security','When configured properly, MySQL ...');\nQuery OK, 6 rows affected (0.00 sec)\nRecords: 6  Duplicates: 0  Warnings: 0\n\n# (2)查看表的索引信息\nmysql> show index from articles\\G\n*************************** 1. row ***************************\n        Table: articles\n   Non_unique: 0\n     Key_name: PRIMARY\n Seq_in_index: 1\n  Column_name: id\n    Collation: A\n  Cardinality: 6\n     Sub_part: NULL\n       Packed: NULL\n         Null: \n   Index_type: BTREE\n      Comment: \nIndex_comment: \n*************************** 2. row ***************************\n        Table: articles\n   Non_unique: 1\n     Key_name: title\n Seq_in_index: 1\n  Column_name: title\n    Collation: NULL\n  Cardinality: NULL\n     Sub_part: NULL\n       Packed: NULL\n         Null: YES\n   Index_type: FULLTEXT\n      Comment: \nIndex_comment: \n*************************** 3. row ***************************\n        Table: articles\n   Non_unique: 1\n     Key_name: title\n Seq_in_index: 2\n  Column_name: body\n    Collation: NULL\n  Cardinality: NULL\n     Sub_part: NULL\n       Packed: NULL\n         Null: YES\n   Index_type: FULLTEXT\n      Comment: \nIndex_comment: \n3 rows in set (0.00 sec)\n\n# (3)使用模糊匹配\nmysql> select * from articles where body like '%database%'; # 但是这里是普通搜索，实际上没有使用到全文索引\n+----+-------------------+------------------------------------------+\n| id | title             | body                                     |\n+----+-------------------+------------------------------------------+\n|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |\n|  5 | MySQL vs. YourSQL | In the following database comparison ... |\n+----+-------------------+------------------------------------------+\n2 rows in set (0.00 sec)\n\n# (4)查看 MySQL 语句对应的执行计划\nmysql> explain select * from articles where body like '%database%'\\G\n*************************** 1. row ***************************\n           id: 1\n  select_type: SIMPLE\n        table: articles # 要操作的数据表\n   partitions: NULL\n         type: ALL # 这次查询的方式是全部遍历\npossible_keys: NULL\n          key: NULL # NULL 值表示没有应用索引\n      key_len: NULL\n          ref: NULL\n         rows: 6\n     filtered: 16.67\n        Extra: Using where\n1 row in set, 1 warning (0.00 sec)\n\nmysql> select * from articles where match (title,body) against ('database');\n+----+-------------------+------------------------------------------+\n| id | title             | body                                     |\n+----+-------------------+------------------------------------------+\n|  5 | MySQL vs. YourSQL | In the following database comparison ... |\n|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |\n+----+-------------------+------------------------------------------+\n2 rows in set (0.00 sec)\n\nmysql> explain select * from articles where match (title,body) against ('database')\\G\n*************************** 1. row ***************************\n           id: 1\n  select_type: SIMPLE\n        table: articles\n   partitions: NULL\n         type: fulltext # 全文索引\npossible_keys: title\n          key: title # 以 title 作为索引\n      key_len: 0\n          ref: const\n         rows: 1\n     filtered: 100.00\n        Extra: Using where\n1 row in set, 1 warning (0.00 sec)\n```","excerpt":"","includedFiles":[],"tasklistId":0,"title":"2.磁盘和 MySQL","headers":[{"level":2,"title":"5.1.主键索引","slug":"_5-1-主键索引","link":"#_5-1-主键索引","children":[]},{"level":2,"title":"5.2.普通索引","slug":"_5-2-普通索引","link":"#_5-2-普通索引","children":[]},{"level":2,"title":"5.3.全文索引","slug":"_5-3-全文索引","link":"#_5-3-全文索引","children":[]}]}}
