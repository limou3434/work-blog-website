---
createTime: 2025/12/12 13:13:22
permalink: /4.业务服务/iybhm2ta/
---
# 单机部署服务

## 1.初始操作

购买标准的 `Ubuntu22.04` 轻量级云服务器，并且规定只使用 `root`，这里我们直接在控制台中执行，一般来说一个 `4核8G` 的服务器足够一个项目持续运行了，如果没有人访问就可以作为多个项目的测试环境。

```shell
# 检查磁盘大小
df -h

# 开机自动启动 ssh 服务
sudo systemctl enable ssh

# 手动启动一次 ssh 服务
sudo systemctl start ssh

# 永久修改主机名（重启不失效）
sudo hostnamectl set-hostname edtechhub

# 更新软件源
sudo apt update

# 更新软件（无弹窗）
sudo DEBIAN_FRONTEND=noninteractive apt upgrade -y
```

## 2.基础软件

首先安装一些基础软件，然后再推荐安装 [x-cmd](https://www.x-cmd.com/) 系列工具包（包含各种工具）。

```shell
# 安装常用软件
sudo apt install git curl wget ufw

# 安装 x-cmd 请查阅 https://cn.x-cmd.com/start/#%E4%BD%BF%E7%94%A8-posix-shell-%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC
eval "$(curl https://get.x-cmd.com)"
```

## 3.配置主机

### 3.1.配置端口

```shell
ufw allow 28804 # 运维服务
ufw allow 443 # 网关服务
ufw allow 40031 # 编码服务
ufw allow 8848 && ufw allow 9848 # 配置服务
ufw allow 3306 && ufw allow 5432 && ufw allow 33060 # 存储服务
ufw allow 6379 # 缓存服务
ufw allow 8082 && ufw allow 23333 # 调度服务
ufw allow 8080 && ufw allow 9876 && ufw allow 10909 && ufw allow 10911 && ufw allow 10912 # 队列服务
ufw allow 7091 && ufw allow 8091 # 事务服务
ufw allow 9200 # 搜索服务
ufw allow 8001:8010/tcp && ufw allow 8001:8010/udp # 后端服务
ufw allow 3001:3010/tcp && ufw allow 3001:3010/udp # 前端服务
```

> [!IMPORTANT]
>
> 补充：同时需要同步设置服务器控制台和运维服务的端口。

### 3.2.配置域名

购买一个专属的域名（本人的域名是 `edtechhub.com.cn`），可以使用这个域名来进行远程登陆和项目部署。

## 4.服务部署

### 4.1.基础服务

先安装 [1panel](https://1panel.cn/)，这个安装脚本会安装一个运维面板（端口选择 `28804`），同时自动安装 `Docker` 且配置加速。

```shell
# 安装 1panel 请查阅 https://1panel.cn/
bash -c "$(curl -sSL https://resource.fit2cloud.com/1panel/package/v2/quick_start.sh)"
```

然后通过访问面板来完成我们的所有基础服务的部署操作...

### 4.2.业务服务
